<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="This is Part III of our three-part series on video game physics. For the rest of this series, see: Part I: An Introduction to Rigid Body Dynamics Part II: Collision Detection for Solid Objects Part I of this series showed us how to simulate the movement of rigid bodies when they are not affected by any forces. Part II demonstrated how to make bodies aware of each other through tests that detect collisions and proximity."><title>Learn how to simulate constrained rigid bodies in video games with our physics tutorial. This is Part III of the series</title>
<link rel=canonical href=https://Nexus-Security.github.io/learn-how-to-simulate-constrained-rigid-bodies-in-video-games-with-our-physics-tutorial.-this-is-part-iii-of-the-series/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Learn how to simulate constrained rigid bodies in video games with our physics tutorial. This is Part III of the series"><meta property='og:description' content="This is Part III of our three-part series on video game physics. For the rest of this series, see: Part I: An Introduction to Rigid Body Dynamics Part II: Collision Detection for Solid Objects Part I of this series showed us how to simulate the movement of rigid bodies when they are not affected by any forces. Part II demonstrated how to make bodies aware of each other through tests that detect collisions and proximity."><meta property='og:url' content='https://Nexus-Security.github.io/learn-how-to-simulate-constrained-rigid-bodies-in-video-games-with-our-physics-tutorial.-this-is-part-iii-of-the-series/'><meta property='og:site_name' content='Nexus Security'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-06-05T00:00:00+00:00'><meta property='article:modified_time' content='2024-06-05T00:00:00+00:00'><meta name=twitter:title content="Learn how to simulate constrained rigid bodies in video games with our physics tutorial. This is Part III of the series"><meta name=twitter:description content="This is Part III of our three-part series on video game physics. For the rest of this series, see: Part I: An Introduction to Rigid Body Dynamics Part II: Collision Detection for Solid Objects Part I of this series showed us how to simulate the movement of rigid bodies when they are not affected by any forces. Part II demonstrated how to make bodies aware of each other through tests that detect collisions and proximity."><link rel="shortcut icon" href=/fav.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><ol class=menu-social><li><a href=https://github.com/Nexus-Security target=_blank title=GitHub rel=me><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="150" height="150" viewBox="0 0 150 150"><defs><filter id="alpha" filterUnits="objectBoundingBox" x="0" y="0" width="100%" height="100%"><feColorMatrix type="matrix" in="SourceGraphic" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"/></filter><mask id="mask0"><g filter="url(#alpha)"><rect x="0" y="0" width="150" height="150" style="fill:#000;fill-opacity:.2;stroke:none"/></g></mask><clipPath id="clip1"><rect x="0" y="0" width="150" height="150"/></clipPath><g id="surface5" clip-path="url(#clip1)"><path style="stroke:none;fill-rule:nonzero;fill:#fff;fill-opacity:1" d="M10.9375 83.867188c0-12.109376 3.46875-21.816407 10.925781-30.535157.71875-.875.925781000000001-2.058593.550781000000001-3.125C21.6875 48.125 21.40625 33.070312 26.488281 17.675781c4.78125 1.207031 16.300781 5.050781 31.65625 16.398438C58.9375 34.65625 59.957031 34.84375 60.894531 34.554688 64.824219 33.382812 71.851562 32.6875 79.6875 32.6875S94.550781 33.386719 98.476562 34.554688C99.417969 34.835938 100.433594 34.65625 101.226562 34.074219 113.96875 24.65625 124.011719 20.445312 129.8125 18.582031c-.476562000000001-1.882812-1.019531-3.746093-1.625-5.589843-4.78125 1.207031-16.300781 5.050781-31.648438 16.394531C95.746094 29.96875 94.730469 30.144531 93.789062 29.867188c-3.925781-1.171876-10.953124-1.875-18.789062-1.875-7.832031.0-14.855469.703124000000003-18.792969 1.871093C55.265625 30.144531 54.246094 29.964844 53.457031 29.382812c-15.355469-11.34375-26.875-15.1875-31.65625-16.402343C16.71875 28.382812 17 43.4375 17.726562 45.523438 18.101562 46.589844 17.890625 47.777344 17.175781 48.648438 9.71875 57.367188 6.25 67.070312 6.25 79.179688c0 23.515624 7.175781 37.921874 17.417969 46.550781C16.007812 116.851562 10.9375 103.582031 10.9375 83.867188zm0 0"/></g><mask id="mask1"><g filter="url(#alpha)"><rect x="0" y="0" width="150" height="150" style="fill:#000;fill-opacity:.101961;stroke:none"/></g></mask><clipPath id="clip2"><rect x="0" y="0" width="150" height="150"/></clipPath><g id="surface8" clip-path="url(#clip2)"><path style="stroke:none;fill-rule:nonzero;fill:#000;fill-opacity:1" d="M32.34375 78.5c3.945312-4 9.382812-5.074219 16.039062-5.074219C51.925781 73.425781 55.824219 73.730469 60.023438 74.054688c4.71875.375 9.589843.71875 14.84375.746093000000002C80.335938 74.917969 85.210938 74.425781 89.976562 74.054688 102.070312 73.125 111.605469 72.367188 117.648438 78.492188c4.527343 4.601562 6.890624 10.328124 7.21875 16.945312C124.925781 94.398438 125 93.382812 125 92.261719c0-7.285157-2.476562-13.492188-7.351562-18.449219-6.042969-6.117188-15.578126-5.367188-27.671876-4.4375C85.210938 69.742188 80.34375 70.238281 74.867188 70.117188 69.914062 70.0625 64.960938 69.8125 60.023438 69.375 55.824219 69.050781 51.929688 68.742188 48.382812 68.742188c-6.65625.0-12.09375 1.070312-16.039062 5.078124C27.476562 78.769531 25 84.976562 25 92.261719 25 93.375 25.074219 94.398438 25.132812 95.445312 25.460938 88.820312 27.820312 83.101562 32.34375 78.5zm0 0"/></g><linearGradient id="linear0" gradientUnits="userSpaceOnUse" x1="10.768" y1="13.86" x2="18.633" y2="21.724" gradientTransform="matrix(6.25,0,0,6.25,0,0)"><stop offset="0" style="stop-color:#000;stop-opacity:.101961"/><stop offset="1" style="stop-color:#000;stop-opacity:0"/></linearGradient><linearGradient id="linear1" gradientUnits="userSpaceOnUse" x1="4.004" y1="18.529" x2="4.047" y2="18.573" gradientTransform="matrix(6.25,0,0,6.25,0,0)"><stop offset="0" style="stop-color:#000;stop-opacity:.101961"/><stop offset="1" style="stop-color:#000;stop-opacity:0"/></linearGradient><linearGradient id="linear2" gradientUnits="userSpaceOnUse" x1=".617" y1="5.771" x2="23.69" y2="16.53" gradientTransform="matrix(6.25,0,0,6.25,0,0)"><stop offset="0" style="stop-color:#fff;stop-opacity:.2"/><stop offset="1" style="stop-color:#fff;stop-opacity:0"/></linearGradient></defs><g id="surface1"><path style="stroke:none;fill-rule:nonzero;fill:#303c42;fill-opacity:1" d="M138.570312 45.789062C139.492188 39.613281 138.867188 23.738281 133.167969 8.292969 132.660156 6.945312 131.300781 6.113281 129.867188 6.273438 129.269531 6.34375 115.1875 8.164062 94.039062 23.46875 89.445312 22.363281 82.632812 21.742188 75 21.742188s-14.4375.625-19.042969 1.726562C34.800781 8.15625 20.71875 6.34375 20.117188 6.273438 18.6875 6.117188 17.332031 6.949219 16.820312 8.292969 11.117188 23.738281 10.5 39.613281 11.425781 45.789062 3.742188 55.289062.0 66.230469.0 79.179688c0 41.632812 21.824219 64.558593 61.457031 64.558593L75 143.75 88.539062 143.738281C128.167969 143.738281 150 120.8125 150 79.179688c0-12.949219-3.742188-23.890626-11.429688-33.390626zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#5c6671;fill-opacity:1" d="M88.539062 137.488281 75 137.5 61.457031 137.488281C36.273438 137.488281 6.25 127.367188 6.25 79.179688c0-12.109376 3.46875-21.816407 10.925781-30.535157.71875-.875.925781000000001-2.058593.550781000000001-3.125C17 43.4375 16.71875 28.382812 21.800781 12.988281c4.78125 1.207031 16.300781 5.050781 31.65625 16.398438C54.25 29.96875 55.269531 30.15625 56.207031 29.867188c3.9375-1.171876 10.960938-1.875 18.792969-1.875 7.835938.0 14.863281.703124000000003 18.789062 1.871093C94.730469 30.140625 95.746094 29.964844 96.539062 29.382812c15.347657-11.34375 26.867188-15.1875 31.648438-16.394531 5.082031 15.394531 4.804688 30.449219 4.082031 32.53125C131.867188 46.585938 132.078125 47.785156 132.820312 48.648438 140.273438 57.367188 143.75 67.070312 143.75 79.179688c0 48.1875-30.023438 58.308593-55.210938 58.308593zm0 0"/><use xlink:href="#surface5" mask="url(#mask0)"/><path style="stroke:none;fill-rule:nonzero;fill:#303c42;fill-opacity:1" d="M89.488281 63.144531C84.886719 63.507812 80.125 63.875 75.226562 63.875H74.78125C69.875 63.875 65.117188 63.5 60.519531 63.144531 47.898438 62.164062 35.988281 61.230469 27.894531 69.429688 21.824219 75.59375 18.75 83.28125 18.75 92.261719 18.75 128.238281 46.429688 131.25 75.226562 131.25c28.34375.0 56.023438-3.011719 56.023438-38.988281.0-8.988281-3.074219-16.667969-9.144531-22.835938-8.085938-8.195312-20.003907-7.269531-32.617188-6.28125zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#d9cfcc;fill-opacity:1" d="M74.773438 125C42.492188 125 25 119.78125 25 92.261719c0-7.285157 2.476562-13.492188 7.34375-18.449219 3.945312-4 9.382812-5.074219 16.039062-5.074219C51.925781 68.738281 55.824219 69.042969 60.023438 69.367188c4.71875.375 9.589843.71875 14.84375.746093000000002C80.335938 70.230469 85.210938 69.738281 89.976562 69.367188c12.09375-.929687999999999 21.628907-1.6875 27.671876 4.4375C122.523438 78.769531 125 84.976562 125 92.261719 125 119.78125 107.507812 125 74.773438 125zm0 0"/><use xlink:href="#surface8" mask="url(#mask1)"/><path style="stroke:none;fill-rule:nonzero;fill:#303c42;fill-opacity:1" d="M50 75c-7.125.0-12.5 9.40625-12.5 21.875S42.875 118.75 50 118.75s12.5-9.40625 12.5-21.875S57.125 75 50 75zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#6d4c41;fill-opacity:1" d="M50 112.5c-2.550781.0-6.25-6.085938-6.25-15.625S47.449219 81.25 50 81.25s6.25 6.085938 6.25 15.625S52.550781 112.5 50 112.5zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#303c42;fill-opacity:1" d="M1e2 75c-7.125.0-12.5 9.40625-12.5 21.875S92.875 118.75 1e2 118.75s12.5-9.40625 12.5-21.875S107.125 75 1e2 75zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#6d4c41;fill-opacity:1" d="M1e2 112.5c-2.550781.0-6.25-6.085938-6.25-15.625S97.449219 81.25 1e2 81.25s6.25 6.085938 6.25 15.625S102.550781 112.5 1e2 112.5zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#a1887f;fill-opacity:1" d="M52.21875 90.511719c0 1.539062-1.246094 2.789062-2.789062 2.789062-1.539063.0-2.785157-1.25-2.785157-2.789062.0-1.539063 1.246094-2.785157 2.785157-2.785157 1.542968.0 2.789062 1.246094 2.789062 2.785157zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:#a1887f;fill-opacity:1" d="M102.21875 90.511719c0 1.539062-1.246094 2.789062-2.789062 2.789062-1.539063.0-2.785157-1.25-2.785157-2.789062.0-1.539063 1.246094-2.785157 2.785157-2.785157 1.542968.0 2.789062 1.246094 2.789062 2.785157zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:url(#linear0)" d="M125 72.8125 124.894531 72.855469C129.039062 78.382812 131.25 84.851562 131.25 92.261719c0 35.976562-27.679688 38.988281-56.023438 38.988281-16.664062.0-32.914062-1.054688-43.683593-8.875l13.386719 13.386719c5.507812 1.207031 11.121093 1.71875 16.527343 1.71875L75 137.5 88.539062 137.488281c22.992188.0 49.941407-8.53125 54.472657-46.664062zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:url(#linear1)" d="M25.070312 115.800781 25 115.832031 25.269531 116.101562zm0 0"/><path style="stroke:none;fill-rule:nonzero;fill:url(#linear2)" d="M138.570312 45.789062C139.492188 39.613281 138.867188 23.738281 133.167969 8.292969 132.660156 6.945312 131.300781 6.113281 129.867188 6.273438 129.269531 6.34375 115.1875 8.164062 94.039062 23.46875 89.445312 22.363281 82.632812 21.742188 75 21.742188s-14.4375.625-19.042969 1.726562C34.800781 8.15625 20.71875 6.34375 20.117188 6.273438 18.6875 6.117188 17.332031 6.949219 16.820312 8.292969 11.117188 23.738281 10.5 39.613281 11.425781 45.789062 3.742188 55.289062.0 66.230469.0 79.179688c0 41.632812 21.824219 64.558593 61.457031 64.558593L75 143.75 88.539062 143.738281C128.167969 143.738281 150 120.8125 150 79.179688c0-12.949219-3.742188-23.890626-11.429688-33.390626zm0 0"/></g></svg></a></li><li><a href=mailto:0x000216@gmail.com target=_blank title=Email rel=me><svg width="512" height="512" viewBox="0 0 512 512"><path d="M33.994 73.934C27.135 76.021 21.866 80.426 18.364 87 16.567 90.374 16.5 96.438 16.5 256V421.5l2.158 4C21.184 430.18 25.101 434.027 30 436.636 33.003 438.235 36.304 438.546 53.246 438.825L72.993 439.15l.253-137.978L73.5 163.194 90 175.45C99.075 182.191 140.17 212.762 181.321 243.386l74.821 55.68 21.179-15.752C288.97 274.65 330 244.021 368.5 215.248l70-52.312L438.754 301.043 439.007 439.15 458.754 438.825C476.726 438.529 478.859 438.306 482.5 436.342 487.18 433.816 491.027 429.899 493.636 425 495.433 421.626 495.5 415.562 495.5 256 495.5 96.438 495.433 90.374 493.636 87 488.565 77.48 482.099 73.799 469.397 73.202L460.293 72.774 454.397 77.337C439.883 88.566 256.423 221.935 255.772 221.73 254.976 221.479 78.972 93.309 62.177 80.75L51.812 73 44.156 73.086C39.945 73.133 35.372 73.515 33.994 73.934" stroke="none" fill="#d34c3c" fill-rule="evenodd"/><path d="M54.528 74.911C55.612 75.963 74.953 90.25 97.507 106.661c22.555 16.412 67.228 48.964 99.275 72.339s58.594 42.604 58.993 42.731C256.549 221.978 454.147 78.147 457.472 74.916 459.416 73.028 456.501 73 256 73 55.677 73 52.586 73.029 54.528 74.911M73 300.878V439H256 439V300.941C439 190.749 438.748 163.038 437.75 163.654 437.063 164.078 405.45 187.632 367.5 215.994c-37.95 28.363-78.528 58.655-90.173 67.316l-21.173 15.748-66.827-49.716C152.572 221.999 111.925 191.776 99 182.18s-24.062-17.892-24.75-18.436C73.251 162.954 73 190.519 73 300.878" stroke="none" fill="#e5e5e5" fill-rule="evenodd"/></svg></a></li><li><a href=https://nexus-security.github.io/index.xml target=_blank title=RSS rel=me><svg id="Layer_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#f78c20" d="M78.333 355.334C35.14 355.334.0 390.474.0 433.667S35.14 512 78.333 512s78.333-35.14 78.333-78.333-35.14-78.333-78.333-78.333z"/><g><path style="fill:#ffa929" d="M78.333 381.445c-28.795.0-52.222 23.427-52.222 52.222s23.427 52.222 52.222 52.222 52.222-23.427 52.222-52.222-23.427-52.222-52.222-52.222z"/><path style="fill:#ffa929" d="M477.918 264.861c-21.843-51.641-53.111-98.019-92.936-137.842-39.824-39.824-86.201-71.093-137.843-92.935C193.669 11.468 136.874.0 78.333.0c-4.807.0-8.704 3.897-8.704 8.704v85.519c0 4.807 3.897 8.704 8.704 8.704 182.37.0 330.74 148.369 330.74 330.74.0 4.807 3.897 8.704 8.704 8.704h85.52c4.807.0 8.704-3.897 8.704-8.704C512 375.126 500.533 318.331 477.918 264.861z"/><path style="fill:#ffa929" d="M78.333 163.853c-4.807.0-8.704 3.897-8.704 8.704v95.74c0 4.807 3.897 8.704 8.704 8.704 86.386.0 156.666 70.281 156.666 156.666.0 4.807 3.897 8.704 8.704 8.704h95.74c4.807.0 8.704-3.897 8.704-8.704.0-72.07-28.065-139.826-79.027-190.787-50.961-50.961-118.717-79.027-190.787-79.027z"/></g><g><path style="fill:#f78c20" d="M78.333 242.186c-2.918.0-5.817.076-8.704.206v25.905c0 4.807 3.897 8.704 8.704 8.704 86.386.0 156.666 70.281 156.666 156.666.0 4.807 3.897 8.704 8.704 8.704h25.905c.129-2.886.206-5.786.206-8.704.0-105.752-85.729-191.481-191.481-191.481z"/><path style="fill:#f78c20" d="M78.333 68.113c-2.91.0-5.81.042-8.704.11v26.001c0 4.807 3.897 8.704 8.704 8.704 182.37.0 330.74 148.369 330.74 330.74.0 4.807 3.897 8.704 8.704 8.704h26.001c.067-2.894.11-5.793.11-8.704C443.887 231.777 280.223 68.113 78.333 68.113z"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li><li><a href=https://x.com/0x000216 target=_blank title=Twitter rel=me><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="150" height="150" viewBox="0 0 150 150"><g id="surface1"><path style="stroke:none;fill-rule:nonzero;fill:#03a9f4;fill-opacity:1" d="M150 33.179688c-5.640625 2.460937-11.609375 4.09375-17.71875 4.855468 6.4375-3.820312 11.25-9.867187 13.527344-16.996094-6.027344 3.574219-12.621094 6.089844-19.5 7.441407-8.628906-9.210938-22.007813-12.214844-33.746094-7.574219-11.738281 4.636719-19.449219 15.980469-19.445312 28.601562.0 2.4375.203124000000003 4.78125.710937000000001 7.015626C49.085938 55.308594 26.03125 43.609375 10.445312 24.355469 2.25 38.402344 6.386719 56.398438 19.894531 65.457031 15.027344 65.324219 10.261719 64.027344 6 61.667969V62.007812c.015625 14.636719 10.304688 27.25 24.636719 30.214844-2.628907.691406000000001-5.339844 1.03125-8.0625 1.011719C20.621094 93.269531 18.667969 93.09375 16.753906 92.710938c4.070313 12.507812 15.585938 21.089843 28.734375 21.421874-10.886719 8.511719-24.308593 13.128907-38.128906 13.113282C4.835938 127.246094 2.417969 127.132812.0 126.824219c14.0625 9.0625 30.445312 13.855469 47.175781 13.800781 56.585938.0 87.523438-46.875 87.523438-87.507812.0-1.359376-.046875-2.671876-.113281000000001-3.972657C140.652344 44.804688 145.875 39.394531 150 33.179688zm0 0"/></g></svg></a></li><li><a href=https://www.minds.com/0x000216/ target=_blank title=Minds rel=me><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><g><g><path style="fill:#ffe1b2" d="M256 33.085C245.078 13.38 224.079.0 2e2.0c-23.781.0-45.57 13.293-56.594 34.184C115.711 41.602 96 66.977 96 96c0 .059.0.113.0.172-9.977 7.512-16 19.301-16 31.828.0 1.316.078 2.637.234 3.992C60.211 145.266 48 167.758 48 192c0 14.07 4.039 27.543 11.719 39.262C57.273 236.512 56 242.207 56 248c0 2.738.281 5.445.828 8.098C36.672 267.308 24 288.539 24 312c0 27.973 18.305 52.34 44.109 60.785C65.398 378.828 64 385.324 64 392c0 21.098 13.805 39.508 33.539 45.727C103.891 466.746 129.828 488 160 488c4.617.0 9.227-.512 13.766-1.527C181.992 502 198.141 512 216 512c16.687.0 31.396-8.567 40-21.523V33.085z"/></g><g><g><path style="fill:#ffb980" d="M264 256c-4.422.0-8-3.582-8-8 0-22.055-17.945-40-40-40-8.008.0-15.734 2.355-22.336 6.812-3.023 2.043-7.055 1.781-9.797-.652-3.156-2.809-8.477-6.16-15.867-6.16-4.422.0-8-3.582-8-8s3.578-8 8-8c7.711.0 15.234 2.293 21.719 6.539C197.773 194.246 206.758 192 216 192c30.875.0 56 25.121 56 56C272 252.418 268.422 256 264 256z"/></g></g><g><g><path style="fill:#ffb980" d="M120 120c18.977.0 36.875 7.312 50.414 20.594 3.141 3.09 8.203 3.047 11.312-.109 3.094-3.152 3.047-8.219-.109-11.312C165.07 112.941 143.187 104 120 104c-13.046.0-25.395 2.93-36.542 8.046C81.253 117.019 80 122.423 80 128c0 1.316.078 2.637.234 3.992-.094.062-.173.139-.267.202C91.423 124.501 105.193 120 120 120z"/></g></g><g><g><path style="fill:#ffb980" d="M216 360c0-4.418-3.578-8-8-8s-8 3.582-8 8c0 17.645-14.352 32-32 32-14.211.0-26.82-9.648-30.664-23.465-.703-2.512-2.578-4.523-5.039-5.395-2.453-.871-5.188-.492-7.305 1.02C114.094 371.906 101.305 376 88 376c-6.948.0-13.625-1.149-19.894-3.207-2.214 4.939-3.501 10.19-3.916 15.586C71.714 390.73 79.711 392 88 392c13.297.0 26.187-3.266 37.773-9.52C133.969 397.894 150.141 408 168 408c26.469.0 48-21.531 48-48z"/></g></g><g><path style="fill:#fdc88e" d="M488 312c0-23.461-12.672-44.691-32.828-55.902.547-2.652.828-5.359.828-8.098.0-5.793-1.273-11.488-3.719-16.738C459.961 219.543 464 206.07 464 192c0-24.242-12.211-46.734-32.234-60.008.156-1.355.234-2.676.234-3.992.0-12.527-6.023-24.316-16-31.828.0-.059.0-.113.0-.172.0-29.023-19.711-54.398-47.406-61.816C357.57 13.293 335.781.0 312 0c-24.08.0-45.078 13.38-56 33.085v457.391C264.604 503.433 279.313 512 296 512c17.859.0 34.008-10 42.234-25.527C342.773 487.488 347.383 488 352 488c30.172.0 56.109-21.254 62.461-50.273C434.195 431.508 448 413.097 448 392c0-6.676-1.398-13.172-4.109-19.215C469.695 364.34 488 339.973 488 312z"/></g><g><path style="fill:#f8ab6b" d="M272.008 151.199C272 151.465 272 151.734 272 152c0 26.469 21.531 48 48 48s48-21.531 48-48c0-4.418-3.578-8-8-8s-8 3.582-8 8c0 17.645-14.352 32-32 32s-32-14.355-32-32c0-2.184.219-4.359.656-6.465.492-2.395-.133-4.883-1.703-6.754-1.57-1.871-4.016-3.066-6.352-2.859-.453.012-.891.059-.602.078-13.234.0-24-10.766-24-24v31.813C260.673 147.348 266.061 149.988 272.008 151.199z"/></g><g><path style="fill:#f8ab6b" d="M296 328c9.242.0 18.219-2.246 26.281-6.539C328.765 325.707 336.289 328 344 328c4.422.0 8-3.582 8-8s-3.578-8-8-8c-7.391.0-12.711-3.352-15.867-6.16-2.742-2.434-6.766-2.695-9.797-.656C311.726 309.644 304 312 296 312c-22.055.0-40-17.945-40-40v39.116C266.174 321.517 280.337 328 296 328z"/></g><g><g><path style="fill:#f8ab6b" d="M431.765 131.992c.156-1.355.234-2.676.234-3.992.0-5.577-1.253-10.981-3.458-15.954C417.395 106.93 405.046 104 392 104c-4.422.0-8 3.582-8 8s3.578 8 8 8c14.807.0 28.577 4.501 40.032 12.194C431.939 132.131 431.859 132.054 431.765 131.992z"/></g></g><g><g><path style="fill:#f8ab6b" d="M447.81 388.38c-.415-5.396-1.702-10.647-3.916-15.586C437.624 374.85 430.948 376 424 376c-13.578.0-26.594-4.266-37.641-12.332-2.07-1.5-4.719-1.93-7.133-1.168-2.43.77-4.344 2.648-5.164 5.059C369.101 382.176 355.414 392 340 392c-4.422.0-8 3.582-8 8s3.578 8 8 8c18.875.0 35.961-10.191 45.094-26.156C396.976 388.512 410.258 392 424 392 432.288 392 440.285 390.73 447.81 388.38z"/></g></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li><li><a href=https://www.buymeacoffee.com/0x000216 target=_blank title=Coffee rel=me><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 340 340" style="enable-background:new 0 0 340 340"><g id="XMLID_18_"><polygon id="XMLID_138_" style="fill:#dedde0" points="76.429,290 80,340 170,340 170,290"/><polygon id="XMLID_169_" style="fill:#dedde0" points="170,80 61.429,80 65,130 170,130"/><polygon id="XMLID_197_" style="fill:#acabb1" points="170,290 170,340 260,340 263.571,290"/><polygon id="XMLID_221_" style="fill:#acabb1" points="170,80 170,130 275,130 278.571,80"/><path id="XMLID_222_" style="fill:#ffda44" d="M170 260c-22.091.0-40-22.386-40-50s17.909-50 40-50v-30H65 50l10 160h16.429H170V260z"/><path id="XMLID_33_" style="fill:#ff9811" d="M170 130v30c22.091.0 40 22.386 40 50s-17.909 50-40 50v30h93.571H280l10-160h-15H170z"/><path id="XMLID_223_" style="fill:#50412e" d="M210 210c0-27.614-17.909-50-40-50v1e2c22.091.0 40-22.386 40-50z"/><path id="XMLID_224_" style="fill:#786145" d="M130 210c0 27.614 17.909 50 40 50V160c-22.091.0-40 22.386-40 50z"/><polygon id="XMLID_225_" style="fill:#50412e" points="278.571,80 300,80 300,40 260,40 260,0 80,0 80,40 40,40 40,80 61.429,80 170,80"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About Us</span></a></li><li><a href=/termsofservice/><svg class="icon icon-tabler icon-tabler-pencil" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"/><line x1="13.5" y1="6.5" x2="17.5" y2="10.5"/></svg>
<span>Terms Of Service</span></a></li><li><a href=/privacypolicy/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Privacy Policy</span></a></li><li><a href=/disclaimer/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Disclaimer</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/contact/><svg class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg>
<span>Contact Us</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#what-are-constraints>What are Constraints?</a></li><li><a href=#an-example-equality-constraints>An Example: Equality Constraints</a><ol><li><a href=#computing-constraint-forces>Computing Constraint Forces</a></li><li><a href=#when-to-apply-constraint-forces>When to Apply Constraint Forces</a></li></ol></li><li><a href=#systems-of-constraints>Systems of Constraints</a><ol><li><a href=#setting-up>Setting Up</a></li></ol></li><li><a href=#inequality-constraints>Inequality Constraints</a></li><li><a href=#impulse-based-dynamics>Impulse-Based Dynamics</a><ol><li><a href=#sequential-impulses>Sequential Impulses</a></li><li><a href=#projected-gauss-seidel>Projected Gauss-Seidel</a></li><li><a href=#simulating-friction-using-impulses>Simulating Friction Using Impulses</a></li></ol></li><li><a href=#optimizations>Optimizations</a><ol><li><a href=#islands>Islands</a></li><li><a href=#sleeping>Sleeping</a></li></ol></li><li><a href=#conclusion---video-game-physics-and-constrained-rigid-body-simulation>Conclusion - Video Game Physics and Constrained Rigid Body Simulation</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/learn-how-to-simulate-constrained-rigid-bodies-in-video-games-with-our-physics-tutorial.-this-is-part-iii-of-the-series/>Learn how to simulate constrained rigid bodies in video games with our physics tutorial. This is Part III of the series</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 05, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>26 minute read</time></div></footer></div></header><section class=article-content><p><em><strong>This is Part III of our three-part series on video game physics. For the rest of this series, see:</strong></em></p><p>Part I: An Introduction to Rigid Body Dynamics
Part II: Collision Detection for Solid Objects</p><hr><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg" media="(min-width: 1920.1px)"><img alt="Video Game Physics tutorial - Constrained Rigid Body Simulation" src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91124%2Ftoptal-blog-image-1431660451592-55d803aebe4ef61ce7f29e08f6200595.jpg" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Part I of this series showed us how to simulate the movement of rigid bodies when they are not affected by any forces. Part II demonstrated how to make bodies aware of each other through tests that detect collisions and proximity. However, we still need to understand how to make objects genuinely interact with one another. For instance, although we can detect collisions and get helpful details about them, we haven&rsquo;t figured out what to <em>do</em> with this information.</p><p>To put it differently, we have only addressed <strong>unconstrained simulations</strong>. The final stage in simulating realistic, solid objects is to implement <strong>constraints</strong>, which set limits on how rigid bodies can move. Examples of constraints include <strong>joints</strong> (like ball joints and hinge joints) and <strong>non-penetration constraints</strong>. This last type is used to <em>resolve collisions</em>, ensuring bodies don&rsquo;t pass through each other and instead bounce off realistically.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png" media="(min-width: 1920.1px)"><img alt=Joints src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91125%2Ftoptal-blog-image-1431660570359-e56c2976eb61acbc041e298d54b129c3.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This article will explore equality and inequality constraints in video game physics. We&rsquo;ll first look at them through a force-based lens, where we figure out corrective forces, and then through an impulse-based lens, where we determine corrective velocities. Finally, we&rsquo;ll cover some smart ways to streamline the process and speed up calculations.</p><p>Get ready for some serious math in this installment, more so than in Part I or Part II. If you need a calculus refresher, Khan Academy has you covered](<a class=link href=https://www.khanacademy.org/math/differential-calculus%29 target=_blank rel=noopener>https://www.khanacademy.org/math/differential-calculus)</a>. For a review of linear algebra basics, refer to the [appendix in Part I, and for the more complex linear algebra, such as matrix multiplication, Khan Academy <a class=link href=https://www.khanacademy.org/math/linear-algebra target=_blank rel=noopener>again delivers</a>. Wikipedia also offers comprehensive articles on <a class=link href=https://en.wikipedia.org/wiki/Differential_equation target=_blank rel=noopener>calculus</a> and <a class=link href=https://en.wikipedia.org/wiki/Vector_space target=_blank rel=noopener>linear algebra</a>.</p><h2 id=what-are-constraints>What are Constraints?</h2><p>Constraints are essentially regulations that must be followed throughout the simulation. Some examples are <em>&ldquo;these two points on this pair of rigid bodies must always touch&rdquo;</em> or <em>&ldquo;the space between these two particles should never exceed 2&rdquo;</em>. In simple terms, a constraint takes away <a class=link href=https://en.wikipedia.org/wiki/Degrees_of_freedom_%5c%28physics_and_chemistry%5c%29 target=_blank rel=noopener><strong>degrees of freedom</strong></a> from a rigid body. Every step of the simulation involves calculating corrective forces or impulses. These forces, when applied to the bodies, either pull them together or push them apart. This ensures their movement stays within the boundaries set by the constraints.</p><p>In a practical sense, a constraint is defined by a <strong>behavior function</strong> or <strong>constraint function</strong> <em>C</em>. This function takes the state of two bodies (e.g., their positions and orientations) and produces a single number. The constraint is considered satisfied when the function&rsquo;s output falls within an acceptable range. Therefore, every step of the simulation involves applying forces or impulses to the rigid bodies to try and maintain the value of <em>C</em> within this permitted range.</p><h2 id=an-example-equality-constraints>An Example: Equality Constraints</h2><p>A frequently encountered type of constraint is the <strong>equality constraint</strong>. In an equality constraint, the only valid value for <em>C</em> is zero. As such, we want to keep <em>C</em> as close to zero as possible with every step of the simulation. Put another way, we want to <strong><em>minimize</em></strong> <em>C</em>. Equality constraints are employed when the position of a particle or point must always precisely match a predefined condition. A good example is a ball joint, where two rigid bodies are permanently linked at the joint&rsquo;s location.</p><p>Let&rsquo;s illustrate with a basic example. Consider a particle in a two-dimensional space. Its position, denoted by <em><strong>p</strong></em>(<em>t</em>) = (<em>px</em>(<em>t</em>), <em>py</em>(<em>t</em>)), is a function of time, providing the particle&rsquo;s coordinates at a specific time <em>t</em>. We&rsquo;ll use dot notation to represent time derivatives. This means <em><strong>ṗ</strong></em> is the first time derivative of <em><strong>p</strong></em> concerning time, which represents the particle&rsquo;s velocity <em><strong>v</strong></em>(<em>t</em>), while <em><strong>p̈</strong></em> is its second time derivative, or its acceleration.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png" media="(min-width: 1920.1px)"><img alt=Particle src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91126%2Ftoptal-blog-image-1431660591530-6523314effc978dc1d93d57066db43ab.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Let’s establish a constraint. Let <em>C</em> represent the following behavior function:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png" media="(min-width: 1920.1px)"><img alt=ParticleDistanceConstraint src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91127%2Ftoptal-blog-image-1431660608914-3eed26a7bf4966d088a88d946d78d10a.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This function uses the particle&rsquo;s position as input and outputs its distance from the origin minus <em>l</em>. The output will be zero whenever the distance between the particle and the origin is <em>l</em>. This means the constraint&rsquo;s effect is to keep the particle a constant distance <em>l</em> from the origin, resembling a pendulum fixed at the origin. The values of <em><strong>p</strong></em> that satisfy <em>C</em>(<em><strong>p</strong></em>) = 0 are referred to as the <strong>legal positions</strong> of the particle.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png" media="(min-width: 1920.1px)"><img alt=Pendulum src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91128%2Ftoptal-blog-image-1431660619704-45e0f08fc3feb25e0d46caad053b935d.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>In this scenario, <em>C</em> depends only on two variables and outputs a single number. This makes it easy to plot and analyze some of its characteristics. If we fix the constraint distance at 2 (<em>l</em> = 2), the graph of <em>C</em> looks like this:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png" media="(min-width: 1920.1px)"><img alt=ConstraintPlot src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91129%2Ftoptal-blog-image-1431660631811-5a5df932a56ee9b3b3917306a59206b8.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>It resembles an upside-down cone. The blue ring marks the points where <em>C</em> = 0, which are the roots of <em>C</em>. This set of points is called the <a class=link href=http://mathworld.wolfram.com/Hypersurface.html target=_blank rel=noopener><strong>constraint</strong></a> <a class=link href=https://en.wikipedia.org/wiki/Hypersurface target=_blank rel=noopener><strong>hypersurface</strong></a>, encompassing all the permissible positions for our particle. The constraint hypersurface is an s-dimensional surface, with s being the number of variables in <em>C</em>.</p><p>The green arrows represent the <a class=link href=https://en.wikipedia.org/wiki/Gradient target=_blank rel=noopener>gradients</a> of <em>C</em>, calculated around the hypersurface, and point toward the <em>illegal positions</em> of our particle, where <em>C</em> ≠ 0. If the particle moves along these lines, either positively (away from the origin) or negatively (toward the origin), it will break the constraint. This means the forces we produce to push the particle toward legal positions will act parallel to these lines.</p><p>While this simplified example has only two variables, most constraint functions have more, making them harder to visualize. But the underlying principle remains the same. Each step requires generating constraint forces that are parallel to the gradient of <em>C</em> at the hypersurface.</p><h3 id=computing-constraint-forces>Computing Constraint Forces</h3><p>Ideally, we would just set <em><strong>p</strong></em> in a way that always keeps <em>C</em> exactly at zero. However, in reality, this leads to unrealistic behavior, with our particle erratically jumping and vibrating around the hypersurface. To maintain <em>C</em> as close to zero as possible while ensuring realistic behavior, an intuitive approach is to use <strong>force-based dynamics</strong>. This involves calculating the necessary force to apply to the particle so that it adheres to the constraints without defying Newton&rsquo;s laws of motion.</p><p>To calculate the constraint force, we need to understand the particle&rsquo;s permissible accelerations and velocities. To do this, we must find the derivatives of <em>C</em> concerning time.</p><p>We want to guarantee that the value of <em>C</em> stays at zero, constant throughout the simulation. This means the first time derivative, <em>Ċ</em>, must also be zero.</p><p>Similarly, for <em>Ċ</em> to remain at zero, the second derivative, <em>C̈</em>, must also be zero.</p><p>We don&rsquo;t need to constrain further derivatives of <em>C</em> because our constraint forces will be applied at the second derivative.</p><p>Let&rsquo;s figure out these derivatives. Our current <em>C</em> definition uses a square root, which makes differentiation a bit tricky. However, we can rephrase <em>C</em> using squared distances:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png" media="(min-width: 1920.1px)"><img alt=ParticleDistanceConstraintSimple src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91130%2Ftoptal-blog-image-1431660650594-06b7c340b396aaa3748ca2de93b97e76.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This doesn’t change the fact that <em>C</em> will be zero when the distance between the particle and the origin is <em>l</em>. From this, we can obtain the first derivative of <em>C</em> with respect to <em>t</em>:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png" media="(min-width: 1920.1px)"><img alt=ParticleDistanceConstraintVelocity src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91131%2Ftoptal-blog-image-1431660661719-14f01ff0631dd14549bb179090dca00a.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>For a given legal position of <em><strong>p</strong></em>, all velocities <em><strong>ṗ</strong></em> that satisfy <em>Ċ</em>(<em><strong>p</strong></em>) = 0 are considered legal velocities. In this example, these should be only the velocities tangential to the hypersurface in the previous image.</p><p>The second derivative of <em>C</em> concerning <em>t</em> is:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png" media="(min-width: 1920.1px)"><img alt=ParticleDistanceConstraintAcceleration src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91132%2Ftoptal-blog-image-1431660677030-4e6efdcc50adc6ec22db08c7c30e01b6.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Put differently, given a legal position and velocity, all accelerations <em><strong>p̈</strong></em> that satisfy <em>C̈</em>(<em><strong>p</strong></em>) = 0 are legal accelerations. In our example, these should only be accelerations directed toward or away from the origin.</p><p>We can use Newton&rsquo;s Second Law of motion to express acceleration in terms of force. Let&rsquo;s assume two forces act on the particle: a combination of all external forces _<strong>f</strong>_<em>ext</em> (like gravity, wind, or user-applied forces) and the constraint force _<strong>f</strong>_C (which we&rsquo;re trying to determine). Assuming the particle has mass <em>m</em>, its acceleration can be expressed as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png" media="(min-width: 1920.1px)"><img alt=ParticleAcceleration src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91188%2Ftoptal-blog-image-1431662107002-f2c725b2f27bccd4b95bf0fcdb467a68.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Substituting this into <em>C̈</em> = 0, we get:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png" media="(min-width: 1920.1px)"><img alt=ConstraintForceEquation src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91189%2Ftoptal-blog-image-1431662206772-7ad35f6d1e07cacd2a87697198e85ac8.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This can be rearranged to:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png" media="(min-width: 1920.1px)"><img alt=ConstraintForceEquationIsolated src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91190%2Ftoptal-blog-image-1431662337076-1861810c55c16a9b5180a2680419a997.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>We have one equation and two unknowns (the two coordinates of _<strong>f</strong>_C), making it unsolvable as is. We need another condition.</p><p>Intuitively, we know that the constraint force must act against the direction we want to <em>prevent</em> the particle from moving in. In this example, constraint forces will always point perpendicular to the circle of radius <em>l</em> because the particle can&rsquo;t move outside this circle. These perpendicular forces will push the particle back onto the circular path if it tries to deviate, making the velocity component in those directions zero. Therefore, constraint forces will always be perpendicular to the particle&rsquo;s velocity.</p><p>As a result:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png" media="(min-width: 1920.1px)"><img alt=ForceVelocityOrthogonal src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91136%2Ftoptal-blog-image-1431660719501-9c5200f8d61ecc3aa13a33813b9d1bac.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>The equation for our constraint&rsquo;s first derivative states that <em><strong>p</strong></em> · <em><strong>ṗ</strong></em> = 0. Since _<strong>f</strong>_C · <em><strong>ṗ</strong></em> = 0, we know that both _<strong>f</strong>_C and <em><strong>p</strong></em> are orthogonal to <em><strong>ṗ</strong></em>, meaning _<strong>f</strong>_C and <em><strong>p</strong></em> are parallel. We can then express one as a multiple of the other:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png" media="(min-width: 1920.1px)"><img alt=ConstraintForceLambda src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91137%2Ftoptal-blog-image-1431660729449-f856f1bb0c66d82ba0e1c2b8eb89f013.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Almost there! The scalar <em>λ</em> represents the <em>magnitude of the constraint force required</em> to bring the system to a valid state. The further our system strays from valid states, the larger <em>λ</em> becomes to push it back. Currently, <em>λ</em> is our only unknown. Substituting the above into our previous equation gives:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png" media="(min-width: 1920.1px)"><img alt=Lambda src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91191%2Ftoptal-blog-image-1431662395593-f8c15aee5b8c5c7c5679f592431666b8.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>We can now directly calculate <em>λ</em> and obtain _<strong>f</strong>_C by multiplying it by <em><strong>p</strong></em>. Then, we simply apply _<strong>f</strong>_C to the particle and let the simulation described in Part I handle the rest!</p><p><em>λ</em> is also known as a <a class=link href=https://en.wikipedia.org/wiki/Lagrange_multiplier target=_blank rel=noopener><strong>Lagrange multiplier</strong></a>. For any constraint, the calculation involves determining the direction of the force vector and its magnitude, <em>λ</em>.</p><h3 id=when-to-apply-constraint-forces>When to Apply Constraint Forces</h3><p>This example shows that computing constraint forces requires knowing all other forces (_<strong>f</strong>_<em>ext</em>). Of course, we must apply constraint forces before simulating the resulting motion. Therefore, a generalized sequence for each simulation step looks like this:</p><ol><li>Calculate all external forces _<strong>f</strong>_<em>ext</em>.</li><li>Calculate the constraint forces _<strong>f</strong>_C.</li><li>Apply all forces and simulate the motion, as outlined in Part I.</li></ol><h2 id=systems-of-constraints>Systems of Constraints</h2><p>That was a relatively simple example of a very basic constraint involving a single entity. In reality, we want to be able to have numerous constraints and many objects in our simulation. We can&rsquo;t handle constraints in isolation because the forces applied by one constraint might affect the forces another constraint applies. This is clearly visible in a chain of rigid bodies connected by revolute joints. Consequently, constraints must be solved as a whole system of equations.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png" media="(min-width: 1920.1px)"><img alt=Chain src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91139%2Ftoptal-blog-image-1431660755532-2e981d99a3b35fd8afc842482990bac6.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><h3 id=setting-up>Setting Up</h3><p>We&rsquo;ll now work with vectors and matrices that represent the state of all entities in our simulation. We&rsquo;ll use these to develop our global equations, similar to what we did for the single-particle example. Let&rsquo;s develop these equations for rigid bodies in two dimensions.</p><p><strong>State Vector</strong></p><p>Suppose we&rsquo;re simulating <em>n</em> rigid bodies. Let <em><strong>q</strong></em> be a <strong>state vector</strong> containing the positions and angles of all rigid bodies:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png" media="(min-width: 1920.1px)"><img alt=StateVector src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91140%2Ftoptal-blog-image-1431660767075-37033d7be3f01276c2158b3fa492fdc3.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where _<strong>p</strong>_<em>i</em> is a two-dimensional vector representing the position of the <em>i</em>-th rigid body, and <em>α__i</em> is its angle, a scalar value. Therefore, <em><strong>q</strong></em> has 3n elements.</p><p><strong>Dynamics: Newton’s Second Law</strong></p><p>Let <strong>M</strong> represent the following 3n by 3n diagonal matrix:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png" media="(min-width: 1920.1px)"><img alt=MassMatrix src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91141%2Ftoptal-blog-image-1431660870513-c282342c762a563c9dc49c6d4fc0c7ce.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where <em>m__i</em> is the mass of the <em>i</em>-th rigid body, and <em>I__i</em> is its moment of inertia.</p><p>Let <em><strong>F</strong></em> represent a global force vector containing the forces and torques acting on each body. It’s the sum of external and constraint forces:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png" media="(min-width: 1920.1px)"><img alt=GlobalForce src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91142%2Ftoptal-blog-image-1431660969522-d6ffa0508d75753b7a7ad56c61d17276.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>and:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png" media="(min-width: 1920.1px)"><img alt=GlobalForceVector src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91143%2Ftoptal-blog-image-1431660979478-4485b5b89870c3b1ddd07789675ca7bb.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><em><strong>F</strong></em> also has <em>3n</em> elements, as each _<strong>f</strong>_<em>i</em> is a two-dimensional vector.</p><p>We can now write Newton’s Second Law of motion for the entire set of bodies with a single expression:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png" media="(min-width: 1920.1px)"><img alt=GlobalEquationOfMotion src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91192%2Ftoptal-blog-image-1431662490424-6a3a106de209112f8ecaa18e95ac8736.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><strong>Constraints</strong></p><p>Finally, let&rsquo;s set up our behavior functions. Suppose there are <em>m</em> constraints, each like a link in our chain of rigid bodies. We&rsquo;ll combine all our behavior functions into a single function <em><strong>C</strong></em>(<em><strong>q</strong></em>):</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png" media="(min-width: 1920.1px)"><img alt=GlobalBehaviorFunction src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91145%2Ftoptal-blog-image-1431661010890-0cb9cfc312cf8d4146f678458b4b1752.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><em><strong>C</strong></em>(<em><strong>q</strong></em>) takes the 3n-dimensional vector <em><strong>q</strong></em> as input and outputs an <em>m</em>-dimensional vector. We aim to keep this output as close to the zero vector as possible, similar to our previous approach.</p><p>We won&rsquo;t delve into defining each behavior function here, as it&rsquo;s not necessary for our purposes, but there are excellent online tutorials on <a class=link href=http://www.iforce2d.net/b2dtut/joints-revolute target=_blank rel=noopener>revolute joint constraints</a>.</p><p><strong>Derivatives of <em>C</em> Over Time</strong></p><p>As before, we want the first and second time derivatives of <em><strong>C</strong></em> to be zero vectors. Let&rsquo;s formulate these equations.</p><p>The derivative of <em><strong>C</strong></em> concerning time can be expressed as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png" media="(min-width: 1920.1px)"><img alt=GlobalBehaviorFunctionFirstDerivative src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91146%2Ftoptal-blog-image-1431661036315-8632d9ed20bb260729e41ff3ab25e211.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Note the use of the chain rule. We can further develop this equation by defining <strong>J</strong> as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png" media="(min-width: 1920.1px)"><img alt=JacobianOfC src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91147%2Ftoptal-blog-image-1431661049621-7e1493279e07181884554f0bfb958082.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This is known as the <a class=link href=https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant target=_blank rel=noopener><strong>Jacobian Matrix</strong></a> or the <em>Jacobian of</em> <em><strong>C</strong></em>. The Jacobian generalizes the gradient, which itself generalizes the concept of slope. It’s also worth noting that each row represents the gradient of each behavior function. The Jacobian tells us how each behavior function responds to changes concerning each state variable.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png" media="(min-width: 1920.1px)"><img alt=JacobianMatrix src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91148%2Ftoptal-blog-image-1431661063254-859940ca297520b07b635bbcfac98e54.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>In our chain example, the Jacobian will be a sparse matrix. This is because each constraint only involves the two rigid bodies connected by it. The state of other bodies doesn’t directly affect that specific link.</p><p>We can now express the time derivative of <em><strong>C</strong></em> as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png" media="(min-width: 1920.1px)"><img alt=Cdot src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91149%2Ftoptal-blog-image-1431661116189-1631929bdfbbbb6209052df4b19c517e.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Elegant, isn&rsquo;t it?</p><p>The second derivative of <em><strong>C</strong></em> is:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png" media="(min-width: 1920.1px)"><img alt=GlobalBehaviorFunctionSecondDerivative src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91150%2Ftoptal-blog-image-1431661128675-6064e52aa03cb1d4490bcf6c264e660d.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png" media="(min-width: 1920.1px)"><img alt=JacobianDerivative src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91151%2Ftoptal-blog-image-1431661142736-f94b50ad6b2fe4c3db6eeb8b56750c72.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Substituting our expression of Newton&rsquo;s Second Law gives:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png" media="(min-width: 1920.1px)"><img alt=GlobalBehaviorFunctionSecondDerivativeForce src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91193%2Ftoptal-blog-image-1431662582134-5c7e58d985a4f004d982937bda3bd38b.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><strong>Computing the Constraint Force Vector</strong></p><p>Since we want the second derivative of <em><strong>C</strong></em> to be zero, let&rsquo;s set it to zero and rearrange:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png" media="(min-width: 1920.1px)"><img alt=GlobalConstraintForceEquationIsolated src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91194%2Ftoptal-blog-image-1431662649509-33402e61d8a74e947be1d6875e53a543.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This equation resembles the one we derived earlier for a single constraint:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png" media="(min-width: 1920.1px)"><img alt=ConstraintForceEquationIsolated src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91195%2Ftoptal-blog-image-1431662686520-1861810c55c16a9b5180a2680419a997.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Once more, we have more unknowns than equations. Again, we can leverage the fact that constraint forces are orthogonal to velocities to find a solution:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png" media="(min-width: 1920.1px)"><img alt=ConstraintForcesDoNoWork src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91155%2Ftoptal-blog-image-1431661214830-cc5df7850a6bceb004efb02c4ab7e50e.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>We also want the first derivative of <em><strong>C</strong></em> to be zero. From <em><strong>Ċ</strong></em> = 0, we have:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png" media="(min-width: 1920.1px)"><img alt=VelocityConstraintZero src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91156%2Ftoptal-blog-image-1431661230532-6a6e7a8bd95167ca574cd09961fff4dd.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Therefore, we can express the constraint force vector _<strong>F</strong>_<em>C</em> as a multiple of <strong>J</strong>:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png" media="(min-width: 1920.1px)"><img alt=GlobalForceJacobian src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91157%2Ftoptal-blog-image-1431661248248-326f6033f8abe05e21bba340ffadcb79.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>The vector <em><strong>λ</strong></em> has <em>m</em> scalar components. In this matrix-vector multiplication, each component <em>λ__i</em> multiplies a row of <strong>J</strong> (the gradient of the <em>i</em>-th constraint function) and sums them up. That is:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png" media="(min-width: 1920.1px)"><img alt=JacobianLinearCombination src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91158%2Ftoptal-blog-image-1431661307870-8c96c1efebb205e186a0c8ce3a4c2374.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>So, _<strong>F</strong>_<em>C</em> is a <a class=link href=https://en.wikipedia.org/wiki/Linear_combination target=_blank rel=noopener><strong>linear combination</strong></a> of the rows of <strong>J</strong>, which are the gradients of our constraint functions. Even though visualizing the hypersurface is challenging in this complex system, as we did for the single-particle example, it behaves in the same way. The gradients are orthogonal to the constraints&rsquo; hypersurfaces and represent directions the system cannot move in. This means we have a linear combination of vectors pointing in the forbidden directions. Consequently, the constraint forces are confined to these directions and will push the bodies towards states allowed by the constraints.</p><p>The only remaining task is to solve for the <em><strong>λ</strong></em> vector, which determines the magnitudes of our constraint forces. Let&rsquo;s return to our main equation and substitute the last expression:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png" media="(min-width: 1920.1px)"><img alt=GlobalConstraintLinearSystem src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91196%2Ftoptal-blog-image-1431662767726-d5db17a15791ed222d42490427e5ae03.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This is a <a class=link href=https://en.wikipedia.org/wiki/System_of_linear_equations target=_blank rel=noopener><strong>system of linear equations</strong></a> where only <em><strong>λ</strong></em> is unknown. Fortunately, plenty of well-established <a class=link href=https://en.wikipedia.org/wiki/System_of_linear_equations#Solving_a_linear_system target=_blank rel=noopener>methods</a> can efficiently solve such linear systems. Once we solve for <em><strong>λ</strong></em>, we can calculate _<strong>F</strong>_<em>C</em>, apply the results to the rigid bodies, and simulate the resulting motion, as shown in Part I.</p><p>For a more detailed derivation of these equations, check out Andrew Witkin&rsquo;s <a class=link href=http://www.cs.cmu.edu/~baraff/sigcourse/notesf.pdf target=_blank rel=noopener><em>Constrained Dynamics</em></a>, which is part of the <a class=link href=http://www.cs.cmu.edu/~baraff/sigcourse/ target=_blank rel=noopener><em>Physically Based Modeling: Principles and Practice</em></a> course at Carnegie Mellon University.</p><h2 id=inequality-constraints>Inequality Constraints</h2><p>We&rsquo;ve assumed so far that our behavior functions must always equal zero for constraints to be satisfied. However, some constraint types require more flexibility, where corrective forces aren&rsquo;t applied for a broader range of <em>C</em> values, not just zero. One example is the <strong>non-penetration constraint</strong>, crucial in rigid body simulations. It handles <strong>collision resolution</strong>, preventing unrealistic interpenetration of bodies and giving them a natural solid behavior.</p><p>As discussed in Part II, after the GJK algorithm detects a collision, we know the contact points on both bodies and the surface normal at the contact point. Remember that GJK is both a collision and a proximity test. Two bodies might be considered &ldquo;colliding&rdquo; even without touching if the distance between them is very small. In this case, the contact points are the points on the two bodies closest to each other.</p><p>The non-penetration constraint aims to keep bodies separate by applying corrective forces that push them apart, but <em>only when the bodies are colliding</em>.</p><p>Consider two colliding 2D bodies, <em>A</em> and <em>B</em>. At the moment of contact, <em>A</em> has position _<strong>p</strong>_<em>A</em> and angle <em>α__A</em>, while <em>B</em> has position _<strong>p</strong>_<em>B</em> and angle <em>α__B</em>. Let _<strong>r</strong>_<em>A</em> be a vector from the center of <em>A</em> to the contact point on <em>A</em>, and define _<strong>r</strong>_<em>B</em> similarly. Let <em><strong>n</strong></em> be the contact normal pointing from <em>A</em> to <em>B</em>.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png" media="(min-width: 1920.1px)"><img alt=RigidBodyContactElements src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91160%2Ftoptal-blog-image-1431661352038-c97be6634fac730df68e6b8e48bad65e.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Let&rsquo;s use a standard 2D rotation matrix <strong>R</strong>(<em>θ</em>) that rotates vectors by an angle <em>θ</em>:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png" media="(min-width: 1920.1px)"><img alt=RotationMatrixFunction src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91161%2Ftoptal-blog-image-1431661363330-7f63f9a9c89082fa2de95254cf3f3139.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>We can rotate the vectors _<strong>r</strong>_<em>A</em> and _<strong>r</strong>_<em>B</em> by the angles <em>α__A</em> and <em>α__B</em>, respectively, using this matrix. This allows us to define a behavior function, <em>C</em>, as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png" media="(min-width: 1920.1px)"><img alt=NonPenetrationConstraintFunction src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91162%2Ftoptal-blog-image-1431661375643-a81f8f0b8a8bfa65e294e6e81f985bb4.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This behavior function might look intimidating, but its action is straightforward. It takes a vector between the contact point on <em>A</em> and the contact point on <em>B</em>, projects it onto the normal vector <em><strong>n</strong></em>, and outputs the projected vector&rsquo;s length. In other words, it calculates the penetration depth along the normal. If <em>C</em> is greater than or equal to zero, no force should be applied because the bodies are not penetrating. Therefore, we need to enforce the <em>inequality</em> <em>C</em> ≥ 0.</p><p>Analyzing the equations reveals that we only need to restrict the value of <em>λ</em> for each constraint. In our previous equality constraint examples, <em>λ</em> could be any value, meaning the constraint forces could act in either a positive or negative direction along the behavior gradients. However, in an inequality constraint like the non-penetration constraint, <em>λ</em> must be greater than or equal to zero. This signifies that constraint forces can only push the colliding bodies <em>away</em> from each other.</p><p>This change transforms our linear system of equations into something different (and more complex) called a <a class=link href=http://chrishecker.com/The_Mixed_Linear_Complementarity_Problem target=_blank rel=noopener><strong>Mixed Linear Complementarity Problem</strong></a>, or MLCP. There are efficient algorithms for directly solving this problem, such as <a class=link href=https://en.wikipedia.org/wiki/Lemke%27s_algorithm target=_blank rel=noopener>Lemke’s Algorithm</a>. However, we&rsquo;ll skip the details here and discuss a popular alternative approach to constraints in game physics.</p><h2 id=impulse-based-dynamics>Impulse-Based Dynamics</h2><p>So far, we&rsquo;ve explored the <strong>force-based</strong> method for enforcing constraints. We calculate constraint forces, apply them to the bodies along with external forces, and integrate them using the methods from Part I to simulate the resulting motions. However, another popular technique among game physics engines takes an <strong>impulse-based</strong> approach. This method works with the velocity of the bodies instead of their force or acceleration. In this approach, the constraint solver calculates and applies a direct change to the linear and angular velocities of the bodies, rather than relying on calculating and applying corrective forces and then using integration to modify the velocities.</p><p>With impulse-based dynamics, the goal is to determine the impulses that result in velocities that satisfy the constraints. This is somewhat similar to the force-based goal of finding the forces that produce accelerations satisfying the constraints. However, we&rsquo;re working at a lower order of magnitude, and as a result, the math is less complicated.</p><p>Brian Mirtich popularized the impulse-based approach in <a class=link href=http://www.kuffner.org/james/software/dynamics/mirtich/index.html target=_blank rel=noopener>his PhD thesis from 1996</a>, which remains a key reference on the subject. Jan Bender <em>et. al.</em> have also published a series of significant papers on this topic.</p><p>The typical sequence of a simulation step using impulse-based dynamics differs slightly from the force-based approach:</p><ol><li>Calculate all external forces.</li><li>Apply the forces and determine the resulting velocities, as explained in Part I.</li><li>Calculate the constraint velocities based on the behavior functions.</li><li>Apply the constraint velocities and simulate the resulting motion.</li></ol><p>Perhaps the most significant advantage of impulse-based dynamics over force-based and other methods is its relative algorithmic simplicity. It&rsquo;s also more intuitive to grasp. In most cases, it&rsquo;s computationally more efficient, making it attractive for games where real-time performance is paramount. However, there are drawbacks, including challenges in realistically handling stable contacts (like a stack of boxes at rest) and increased complexity when modeling contact friction. Nevertheless, we can address these issues in several ways, as we&rsquo;ll see later.</p><p>In physics, an <a class=link href=https://en.wikipedia.org/wiki/Impulse_%5c%28physics%5c%29 target=_blank rel=noopener><strong>impulse</strong></a> is the integral of a force over time. That is:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png" media="(min-width: 1920.1px)"><img alt=Impulse src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91163%2Ftoptal-blog-image-1431661401616-2126299cea185953e86c0c86ce0bfcf9.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This is equivalent to the <strong>change in <a class=link href=https://en.wikipedia.org/wiki/Momentum target=_blank rel=noopener>momentum</a></strong> during that time.</p><p>If a constant force <em>F</em> is applied for a time <em>h</em>, the impulse is simply:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png" media="(min-width: 1920.1px)"><img alt=ConstantImpulse src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91164%2Ftoptal-blog-image-1431661418577-5fc978dd59b21ec07584c2031a8f92a3.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>When two rigid objects collide, their contact lasts for a very short time, during which they deform and exert equal and opposite forces on each other. After this brief interaction, their velocities, and consequently their momentums, may change significantly. If the objects were perfectly rigid, their contact time would be infinitesimally small, and their velocities would change instantly upon collision. Perfectly rigid bodies don&rsquo;t exist in the real world, but we can use this simplification to realistically simulate the behavior of very rigid objects.</p><h3 id=sequential-impulses>Sequential Impulses</h3><p>Our objective is to find the impulses that satisfy the constraints for the current simulation step. One technique for achieving this is called <strong>sequential impulses</strong>, popularized by Erin Catto, the creator of the <a class=link href=http://box2d.org/ target=_blank rel=noopener><em>Box2D</em> physics engine</a>. This iterative algorithm aims to zero in on the constraint velocity by applying impulses to the rigid bodies with each iteration, repeating until the resulting velocity error is negligible—in other words, until <em><strong>Ċ</strong></em> is very close to zero.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png" media="(min-width: 1920.1px)"><img alt=SequentialImpulses src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91165%2Ftoptal-blog-image-1431661430040-88309dc4f6fa78b9479f33f3d57d1b0d.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Unlike our previous approach, sequential impulses don&rsquo;t involve creating one large system of equations and inequalities. Instead, we model and solve each constraint individually, much like our first example with a single particle. The algorithm can be summarized in three steps:</p><ol><li><p>Integrate applied forces using semi-implicit Euler, as shown in Part I, to obtain tentative velocities. These velocities might violate the constraints and need correction before application.</p></li><li><p>Apply impulses sequentially to all constraints to correct velocity errors. Repeat this process over several iterations until the impulses become very small or a maximum iteration count is reached.</p></li><li><p>Use the new velocities to simulate motion and update positions, again employing semi-implicit Euler.</p></li></ol><p>Note that these steps correspond to steps 2 through 4 in the general impulse-based time step sequence described earlier.</p><p><strong>Computing the Velocities</strong></p><p>Let&rsquo;s examine the equations. Let _<strong>q̇</strong>_1 = <em><strong>q̇</strong></em>(<em>t__i</em>-1) and _<strong>q̇</strong>_2 = <em><strong>q̇</strong></em>(<em>t__i</em>). In other words, _<strong>q̇</strong>_1 and _<strong>q̇</strong>_2 are the velocities in the previous and current time steps, respectively (we&rsquo;re trying to determine the latter). Using semi-implicit Euler integration, the tentative, <em>unconstrained</em> velocity for the current step (indicated by an asterisk) is:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png" media="(min-width: 1920.1px)"><img alt src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91166%2Ftoptal-blog-image-1431661485199-d1b2b255d94389fcc32289bd4baa8167.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This velocity might violate the constraints, in which case we need to correct it with an impulse.</p><p>Let _<strong>P</strong>_<em>C</em> represent the constraint impulse. Dividing it by mass gives us the change in velocity, which we then apply to the tentative velocity to get the desired velocity that satisfies the constraints:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png" media="(min-width: 1920.1px)"><img alt=ApplyImpulse src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91167%2Ftoptal-blog-image-1431661495445-8ca620bb9f0bd481eae9f757436a03d1.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>So how do we determine _<strong>P</strong>_<em>C</em>? Recognizing that the impulse will act in the same direction as an instantaneous force producing it, we can again use the fact that constraint forces must be parallel to the gradient of the behavior function, just as we did with force-based constraints. This allows us to write:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png" media="(min-width: 1920.1px)"><img alt=ConstraintImpulse src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91169%2Ftoptal-blog-image-1431661522251-37298455da53e8862ec2c5162069866b.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where <em><strong>λ</strong></em> is once again a vector of magnitudes.</p><p>The impulse-based approach bypasses Newton&rsquo;s Second Law, offering a shortcut. By skipping the calculation of forces and their resulting accelerations, it can lead to noticeable, instantaneous velocity changes that might introduce undesirable jitter into a simulation. To mitigate this, it&rsquo;s common to introduce a <strong>bias</strong> factor to the velocity constraints, softening the effect:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png" media="(min-width: 1920.1px)"><img alt=ConstraintBias src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91170%2Ftoptal-blog-image-1431661530920-10698aa12f59571623e649ab0b7c5cf0.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Notice that <strong>J</strong>_<strong>q̇</strong>_2 + <em>b</em> = 0, as _<strong>q̇</strong>_2 must be a valid velocity. Substituting and rearranging the valid velocity equation yields:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png" media="(min-width: 1920.1px)"><img alt=ImpulseLambda src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91171%2Ftoptal-blog-image-1431661543643-eb8a0fd42f91d959a42265ae861d69c1.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>After solving this equation for <em><strong>λ</strong></em>, we can compute the constraint impulse using <em><strong>P</strong><em><em>C</em> = <strong>J</strong><em>T</em></em><strong>λ</strong></em> and finally update the velocity.</p><p>We have to solve each constraint individually, apply the impulses, update the bodies&rsquo; velocities, and repeat this process multiple times until we achieve convergence or hit the maximum iteration count. This means we <em>accumulate</em> the impulses as we iterate. To complete the time step, we simply update the positions using the final velocities:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png" media="(min-width: 1920.1px)"><img alt=PositionUpdateSolved src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91172%2Ftoptal-blog-image-1431661560654-b366ed52c80f3316dbdceb99d985b37f.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><strong>Inequality Constraints</strong></p><p>For inequality constraints, we must bound the impulses and keep them within the permitted values during accumulation. This ensures that the constraints don&rsquo;t apply impulses with inappropriate directions or strengths. This bounding process isn&rsquo;t as simple as applying a <code>min</code>/<code>max</code> function because we only want to bound the final accumulated impulse, <em>not</em> the intermediate impulses generated during accumulation. For details, check out <a class=link href=http://twvideo01.ubm-us.net/o1/vault/gdc09/slides/04-GDC09_Catto_Erin_Solver.pdf target=_blank rel=noopener>Erin Catto’s GDC 2009</a>&rsquo;s presentation.</p><p><strong>Warm Starting</strong></p><p>One effective technique for enhancing the algorithm&rsquo;s accuracy is called <strong>warm starting</strong>. The algorithm starts with an initial guess for <em><strong>λ</strong></em> and works from there. Considering the significant temporal and spatial coherence in physics simulations, it&rsquo;s natural to use the <em><strong>λ</strong></em> from the previous step as a starting point, which is precisely what warm starting does. Since bodies often don&rsquo;t move much between steps, the impulses calculated in the previous step are likely to be very similar in the current step. Starting our algorithm from this point helps it converge to a more accurate solution faster, improving the simulation&rsquo;s stability, particularly for constraints like joints and persistent contact between bodies.</p><h3 id=projected-gauss-seidel>Projected Gauss-Seidel</h3><p>Another technique for solving impulse-based constraints stems from the fact that it can also be modeled as an MLCP. <strong>Projected Gauss-Seidel</strong> (PGS) is an iterative algorithm for solving MLCPs that works well for impulse-based dynamics. It effectively solves a linear system <strong>A</strong><em><strong>x</strong></em> = <em><strong>b</strong></em> with bounds on <em><strong>x</strong></em>. PGS extends the <a class=link href=https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method target=_blank rel=noopener>Gauss-Seidel method</a> by bounding the value of <em><strong>x</strong></em> in each iteration to keep it within the desired range.</p><p>Since we&rsquo;re working with velocity, we can eliminate acceleration by approximating it as the ratio of velocity change to the time step&rsquo;s delta time. Let _<strong>q̇</strong>_1 = <em><strong>q̇</strong></em>(<em>t__i</em>-1) and _<strong>q̇</strong>_2 = <em><strong>q̇</strong></em>(<em>t__i</em>), then:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png" media="(min-width: 1920.1px)"><img alt=AccelerationApproximation src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91173%2Ftoptal-blog-image-1431661577405-0a53aa118a70053833bc01f629893b50.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where, again, _<strong>q̇</strong>_1 represents the velocity calculated in the previous step, and _<strong>q̇</strong>_2 is the velocity we want for the current step. From Newton&rsquo;s Second Law, we have:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png" media="(min-width: 1920.1px)"><img alt src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91174%2Ftoptal-blog-image-1431661615596-9d58124072b2aab25f761692a1080833.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Substituting our approximation and <em><strong>F</strong><em><em>C</em> = <strong>J</strong><em>T</em></em><strong>λ</strong></em> gives us:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png" media="(min-width: 1920.1px)"><img alt src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91175%2Ftoptal-blog-image-1431661649931-9eb9ba332a540fac054caa4f3c3d5b29.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Since <em><strong>Ċ</strong></em> = 0, we know that <strong>J</strong>_<strong>q̇</strong>_2 = <strong>0</strong> because _<strong>q̇</strong>_2 will be a legal velocity after solving this. Rearranging and multiplying both sides by <strong>J</strong> yields:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png" media="(min-width: 1920.1px)"><img alt=ImpulseBasedSystem src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91197%2Ftoptal-blog-image-1431662881142-c2141970afee3033876a339832a40737.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This MLCP differs slightly from the force-based approach because it uses an approximate acceleration. Once we solve it using PGS, we&rsquo;ll have <em><strong>λ</strong></em>, and we can then calculate _<strong>q̇</strong>_2 using the previous equation:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png" media="(min-width: 1920.1px)"><img alt=VelocityUpdate src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91198%2Ftoptal-blog-image-1431662931118-49b9c1c46a592b3c964df26da46eda97.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>We can easily obtain the updated positions and orientations from the semi-implicit Euler scheme:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png" media="(min-width: 1920.1px)"><img alt=PositionUpdate src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91178%2Ftoptal-blog-image-1431661683297-b366ed52c80f3316dbdceb99d985b37f.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Interestingly, closer inspection reveals that PGS is equivalent to sequential impulses! We&rsquo;re essentially doing the same thing. We can again employ warm starting, using the <em><strong>λ</strong></em> computed in the previous step as our starting point. The difference is that the sequential impulses formulation is more intuitive, while the PGS formulation is more general, allowing for more flexible code. For example, we could experiment with different tools for solving the MLCP.</p><p>For a deeper dive into using PGS in an impulse-based simulation, refer to <a class=link href="https://code.google.com/p/box2d/downloads/detail?name=GDC2005_ErinCatto.zip&amp;can=2&amp;q=" target=_blank rel=noopener>Erin Catto’s 2005 GDC presentation and paper</a>.</p><h3 id=simulating-friction-using-impulses>Simulating Friction Using Impulses</h3><p>The <a class=link href=https://en.wikipedia.org/wiki/Friction target=_blank rel=noopener>Coulomb friction model</a> is straightforward and effective. It outlines two scenarios when two solid surfaces are in contact:</p><ul><li><strong>Static friction</strong>: This is the resistance to tangential motion when the surfaces aren&rsquo;t moving relative to each other because the force isn&rsquo;t strong enough to overcome friction. The friction force acts in the opposite direction of the net tangent force and has the same magnitude.</li><li><strong>Kinetic friction</strong>: This is the resistance to tangential motion when the surfaces are sliding against each other. The friction force opposes the direction of motion and has a smaller magnitude than the net tangent force.</li></ul><p>The friction force is proportional to the normal force, which is the net force component acting perpendicular to the contact surface. In simpler terms, the force of friction is proportional to the force pushing the two objects together. It can be expressed as:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png" media="(min-width: 1920.1px)"><img alt=CoulombFriction src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91179%2Ftoptal-blog-image-1431661697558-8805278f1c9eaa1aba6a6f209833c694.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>where <em>F__f</em> is the friction force, <em>F__n</em> is the normal force, and <em>μ</em> is the <a class=link href=https://en.wikipedia.org/wiki/Friction#Coefficient_of_friction target=_blank rel=noopener><strong>coefficient of friction</strong></a> (which can differ for static and kinetic friction).</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png" media="(min-width: 1920.1px)"><img alt=SurfaceFriction src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91180%2Ftoptal-blog-image-1431661708306-f3f177deb797062e5db3621ae5f4512c.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>To simulate friction using a constraint model, we must formulate a velocity constraint directly:</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png" media="(min-width: 1920.1px)"><img alt=FrictionVelocityConstraint src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91181%2Ftoptal-blog-image-1431661732345-1b3eb40f81fb45037ebd0cbf2e1b54f1.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Here, _<strong>v</strong>_<em>p</em> represents the relative velocity vector at the contact point <em>p</em>, and <em><strong>t</strong></em> is a unit vector tangent to the surfaces. The goal is to reduce the tangential velocity to zero.</p><p>According to the friction equation, we must limit the friction impulse to the normal impulse multiplied by the coefficient of friction. This means keeping our <em>λ</em> between -<em>μ</em> _λ_n and <em>μ</em> _λ_n, where _λ_n is the magnitude of the normal impulse.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png" media="(min-width: 1920.1px)"><img alt=FrictionBounds src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91182%2Ftoptal-blog-image-1431661741126-4541bd6ef8909c33095c3b5e071d57aa.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Therefore, friction is another instance of an inequality constraint.</p><p>Things become slightly more complex in three dimensions. In his <a class=link href="https://code.google.com/p/box2d/downloads/detail?name=GDC2005_ErinCatto.zip&amp;can=2&amp;q=" target=_blank rel=noopener>2005 GDC presentation</a>, Erin Catto presents an approach that uses two tangent vectors and two constraints. However, limiting the friction impulse to a multiple of the normal impulse in this case couples the two constraints, making them challenging to solve. To work around this, he limits the friction impulse by a constant value proportional to the body&rsquo;s mass and the acceleration due to gravity.</p><h2 id=optimizations>Optimizations</h2><p>We&rsquo;ve covered several methods for determining the forces or impulses to apply to our rigid bodies to enforce constraints. Each of these methods involves a fair amount of computation. Let&rsquo;s explore some clever optimization strategies to reduce unnecessary work.</p><h3 id=islands>Islands</h3><p>In a constrained physics simulation, some objects influence the motion of others, while others don&rsquo;t.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png" media="(min-width: 1920.1px)"><img alt=Islands src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91183%2Ftoptal-blog-image-1431661753947-56ff783d1d1fa2a69d1c6863edd2cdb9.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>In the image above, box <em>B</em> is a static object, representing the floor. The objects on the left are stacked, making contact with each other. If any of these objects move, the others might move as well due to the contact constraints between them. Any force or impulse applied to these bodies may propagate through the stack. However, the triangle in the middle rests independently on the stationary box <em>B</em>. Forces applied to the stacked objects on the left will never affect the triangle because there&rsquo;s no connection between them. The same applies to the chain of boxes on the right. They are all connected by revolute joints, so the movement of one box can create a reaction along the constraints, influencing the motion of other boxes in the chain. But they will never affect the triangle or the stacked objects on the left unless a new constraint is created between them, such as a contact/non-penetration constraint arising from a collision due to their movement.</p><p>This observation allows us to group objects into <strong>islands</strong>, which are self-contained groups of bodies that can influence each other&rsquo;s motion through constraint forces/impulses but won&rsquo;t affect objects in other islands.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png" media="(min-width: 1920.1px)"><img alt=IslandsIdentified src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91184%2Ftoptal-blog-image-1431661768683-accffc45b8ea208005e61ef6c01d00bb.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>This separation allows us to solve smaller constraint groups, creating smaller systems instead of one large system for the entire physics world. This eliminates a potentially massive amount of unnecessary computation.</p><p>If we view the world as a graph where bodies are nodes and constraints are edges, we can construct the islands using a <a class=link href=https://en.wikipedia.org/wiki/Depth-first_search target=_blank rel=noopener><strong>depth-first search</strong></a> on this graph. In graph theory, our islands are called <a class=link href=https://en.wikipedia.org/wiki/Connected_component_%28graph_theory%29 target=_blank rel=noopener>connected components</a>.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png" media="(min-width: 1920.1px)"><img alt=Graph src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91185%2Ftoptal-blog-image-1431661783741-0420fb0c60957a13ff1561ec08ee9d00.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p><em>Box2D</em> does this in its <a class=link href=https://code.google.com/p/box2d/source/browse/trunk/Box2D/Box2D/Dynamics/b2World.cpp#385 target=_blank rel=noopener><code>b2World::Solve</code></a> method, which is responsible for solving all constraints in each <a class=link href=https://code.google.com/p/box2d/source/browse/trunk/Box2D/Box2D/Dynamics/b2World.cpp#897 target=_blank rel=noopener>step</a>. It constructs the islands and calls <a class=link href=https://code.google.com/p/box2d/source/browse/trunk/Box2D/Box2D/Dynamics/b2Island.cpp#183 target=_blank rel=noopener><code>b2Island::Solve</code></a> on each, which then solves the constraints within that island using sequential impulses.</p><h3 id=sleeping>Sleeping</h3><p>When a body in the simulation comes to rest, its position naturally remains constant in subsequent steps unless an external force causes it to move again. This presents another optimization opportunity: we can stop simulating an island if the linear and angular velocities of all its bodies remain below a certain threshold for a short period. This condition is called <strong>sleeping</strong>.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png" media="(min-width: 1920.1px)"><img alt=Sleeping src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91186%2Ftoptal-blog-image-1431661795697-a12c76d2ccd7043a1d9336ba369e8883.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div><p>Once an island is asleep, its bodies are excluded from all simulation steps except collision detection. If a body outside the island collides with a body in the sleeping island, the island &ldquo;wakes up&rdquo; and rejoins the simulation. Similarly, if an external force or impulse is applied to one of its bodies, the island wakes up.</p><p>This simple technique can dramatically improve the performance of simulations with many objects.</p><h2 id=conclusion---video-game-physics-and-constrained-rigid-body-simulation>Conclusion - Video Game Physics and Constrained Rigid Body Simulation</h2><p>This concludes our three-part series on video game physics. We&rsquo;ve explored how to simulate physics in games, focusing on rigid body simulation, a fundamental aspect of physics simulation that can make games more dynamic and enjoyable. We&rsquo;ve learned how to simulate the motion of rigid bodies, detect and resolve collisions between them, and model other interactions.</p><p>Widely used game physics engines like <a class=link href=http://box2d.org/ target=_blank rel=noopener><em>Box2D</em></a>, <a class=link href=https://chipmunk-physics.net/ target=_blank rel=noopener><em>Chipmunk Physics</em></a>, and <a class=link href=http://www.bulletphysics.org/ target=_blank rel=noopener><em>Bullet Physics</em></a> employ the techniques we&rsquo;ve explored. These approaches enable the creation of games with lifelike, dynamic behavior, allowing objects to move, collide, and connect in various ways using different joint types. Interestingly, these methods also have applications beyond gaming, such as in robotics.</p><p>However, practical implementation often presents challenges not predicted by theory. Achieving a stable and efficient implementation, especially for constrained dynamics, requires numerous ingenious simplifications. While significant advancements have been made in collision detection, time of impact computation, MLCP resolution, and more, there&rsquo;s still room for improvement. The <a class=link href=http://bulletphysics.org/Bullet/phpBB3/ target=_blank rel=noopener>Bullet Physics Forum</a> provides a valuable resource for staying informed about the latest developments in game and rigid body physics simulation, particularly the <a class=link href="http://bulletphysics.org/Bullet/phpBB3/viewforum.php?f=4" target=_blank rel=noopener><em>Research and development discussion about Collision Detection and Physics Simulation</em></a> section where members discuss cutting-edge simulation techniques.</p><div data-testid=image-container class="X3Bg-O9c _1xIzGpI7"><figure class=_1sK7TguO><picture class=!contents data-testid=picture><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=360, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=360&amp;dpr=2 2x" media="(max-width: 360px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=480, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=480&amp;dpr=2 2x" media="(min-width: 360.1px) and (max-width: 480px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=768, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=768&amp;dpr=2 2x" media="(min-width: 480.1px) and (max-width: 768px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1024, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1024&amp;dpr=2 2x" media="(min-width: 768.1px) and (max-width: 1024px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1440, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1440&amp;dpr=2 2x" media="(min-width: 1024.1px) and (max-width: 1440px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1920, https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png&amp;width=1920&amp;dpr=2 2x" media="(min-width: 1440.1px) and (max-width: 1920px)"><source srcset="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png" media="(min-width: 1920.1px)"><img alt=Bridge src="https://assets.toptal.io/images?url=https%3A%2F%2Fuploads.toptal.io%2Fblog%2Fimage%2F91187%2Ftoptal-blog-image-1431661808580-f65a67c6d9653e8ec46d82bf9b25b3af.png" loading=lazy decoding=async class=Djd3YO_2></picture></figure></div></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3987358164777632" crossorigin=anonymous></script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-5X67X4Q4")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5X67X4Q4" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>