<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=robots content="all"><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=bingbot content="index,follow"><link rel=sitemap type=application/xml title=Sitemap href=https://nexus-security.github.io/sitemap.xml><meta property="og:type" content="article"><meta name=author content="0x000216"><meta property="og:locale" content="en"><meta name=language content="English"><base href=https://Nexus-Security.github.io/posts/2016-09-09-be-mobile-theme-v15-mobile-wordpress_25/><link rel=icon href=/fav.ico type=image/x-icon><link rel=alternate type=application/rss+xml title=RSS href=https://nexus-security.github.io/index.xml><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kang Asu
Pyrdp - RDP Man-In-The-Middle And Library For Python3 With The Ability To Watch Connections Live Or After The Fact
PyRDP is a Python 3Â Remote Desktop ProtocolÂ (RDP)Â Man-in-the-MiddleÂ (MITM) and library.
It features a few tools:
RDP Man-in-the-Middle LogsÂ credentialsÂ used when connecting Steals data copied to the clipboard Saves a copy of the files transferred over the network Saves replays of connections so you can look at them later Run console commands orÂ PowerShellÂ payloads automatically on new connections RDP Player: See live RDP connections coming from the MITM View replays of RDP connections Take control of active RDP sessions while hiding your actions List the client&amp;rsquo;s mapped drives and download files from them during active sessions RDP Certificate Cloner: Create a self-signed X509 certificate with the same fields as an RDP server&amp;rsquo;s certificate We have used this tool as part of an RDP honeypot which records sessions and saves a copy of the malware dropped on our target machine."><title>Be Mobile Theme v1.5 â€“ Mobile WordPress Theme</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-be-mobile-theme-v15-mobile-wordpress_25/><link rel=stylesheet href=/scss/style.min.1f3200acb41251d94439982f0ccc8f6599efd31eaa9b4d6412b905bc3d5fa0b8.css><meta property="og:title" content="Be Mobile Theme v1.5 â€“ Mobile WordPress Theme"><meta property="og:description" content="Kang Asu
Pyrdp - RDP Man-In-The-Middle And Library For Python3 With The Ability To Watch Connections Live Or After The Fact
PyRDP is a Python 3Â Remote Desktop ProtocolÂ (RDP)Â Man-in-the-MiddleÂ (MITM) and library.
It features a few tools:
RDP Man-in-the-Middle LogsÂ credentialsÂ used when connecting Steals data copied to the clipboard Saves a copy of the files transferred over the network Saves replays of connections so you can look at them later Run console commands orÂ PowerShellÂ payloads automatically on new connections RDP Player: See live RDP connections coming from the MITM View replays of RDP connections Take control of active RDP sessions while hiding your actions List the client&amp;rsquo;s mapped drives and download files from them during active sessions RDP Certificate Cloner: Create a self-signed X509 certificate with the same fields as an RDP server&amp;rsquo;s certificate We have used this tool as part of an RDP honeypot which records sessions and saves a copy of the malware dropped on our target machine."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-be-mobile-theme-v15-mobile-wordpress_25/"><meta property="og:site_name" content="0x000216"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-09-26T06:49:00+01:00"><meta property="article:modified_time" content="2019-09-26T06:49:00+01:00"><meta name=twitter:title content="Be Mobile Theme v1.5 â€“ Mobile WordPress Theme"><meta name=twitter:description content="Kang Asu
Pyrdp - RDP Man-In-The-Middle And Library For Python3 With The Ability To Watch Connections Live Or After The Fact
PyRDP is a Python 3Â Remote Desktop ProtocolÂ (RDP)Â Man-in-the-MiddleÂ (MITM) and library.
It features a few tools:
RDP Man-in-the-Middle LogsÂ credentialsÂ used when connecting Steals data copied to the clipboard Saves a copy of the files transferred over the network Saves replays of connections so you can look at them later Run console commands orÂ PowerShellÂ payloads automatically on new connections RDP Player: See live RDP connections coming from the MITM View replays of RDP connections Take control of active RDP sessions while hiding your actions List the client&amp;rsquo;s mapped drives and download files from them during active sessions RDP Certificate Cloner: Create a self-signed X509 certificate with the same fields as an RDP server&amp;rsquo;s certificate We have used this tool as part of an RDP honeypot which records sessions and saves a copy of the malware dropped on our target machine."><link rel="shortcut icon" href=/fav.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><center><figure class=site-avatar><a href=/><img src=/img/avatar_hue825486955cd7c56d95e38b4bd2a8e3c_229979_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h2 class=site-name><a href=/>0x000216</a></h1></center><h2 class=site-description>Where Do Russian Hackers Store Their Exploits? ðŸ¤“ /ussr/bin/ ðŸ˜‹</h2></div></header><ol class=social-menu><li><a href=https://github.com/Nexus-Security target=_blank title=GitHub><svg width="72" height="72" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M36 72c19.882251.0 36-16.117749 36-36 0-19.882251-16.117749-36-36-36-19.882251 365231026e-23-36 16.117749-36 36C24348735e-22 55.882251 16.117749 72 36 72z" fill="#3e75c3"/><path d="M35.9985 12C22.746 12 12 22.7870921 12 36.096644c0 10.6440272 6.876 19.6751861 16.4145 22.8617681C29.6145 59.1797862 30.0525 58.4358488 30.0525 57.7973276 30.0525 57.2250681 30.0315 55.7100863 30.0195 53.6996482c-6.6765 1.4562499-8.085-3.2302544-8.085-3.2302544-1.0905-2.7829884-2.664-3.5239139-2.664-3.5239139C17.091 45.4500754 19.4355 45.4801943 19.4355 45.4801943c2.4075.1701719 3.675 2.4833051 3.675 2.4833051 2.142 3.6820383 5.6175 2.6188404 6.9855 2.0014024C30.3135 48.4077535 30.9345 47.3460615 31.62 46.7436831 26.2905 46.1352808 20.688 44.0691228 20.688 34.8361671c0-2.6308879.9345-4.781379 2.4705-6.4665327C22.911 27.7597262 22.0875 25.3110578 23.3925 21.9934585c0 0 2.016-.6475568 6.6 2.4697516C31.908 23.9285993 33.96 23.6620468 36.0015 23.6515052 38.04 23.6620468 40.0935 23.9285993 42.0105 24.4632101c4.581-3.1173084 6.5925-2.4697516 6.5925-2.4697516C49.9125 25.3110578 49.089 27.7597262 48.8415 28.3696344 50.3805 30.0547881 51.309 32.2052792 51.309 34.8361671c0 9.2555448-5.6115 11.29309-10.9575 11.8894446.860999999999997.7439374 1.629 2.2137408 1.629 4.4621184C41.9805 54.4089489 41.9505 57.0067059 41.9505 57.7973276 41.9505 58.4418726 42.3825 59.1918338 43.6005 58.9554002 53.13 55.7627944 60 46.7376593 60 36.096644 60 22.7870921 49.254 12 35.9985 12" fill="#fff"/></g></svg></a></li><li><a href=mailto:0x000216@gmail.com target=_blank title=Email><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#e6f3ff" d="M512 105.739v300.522c0 27.715-22.372 50.087-50.087 50.087H50.087C22.372 456.348.0 433.976.0 406.261V105.739c0-.89.0-1.781.111-2.671 1.336-25.6 21.704-45.969 47.304-47.304.89-.111 1.781-.111 2.671-.111h411.826c.89.0 1.892.0 2.783.111 25.489 1.336 45.857 21.704 47.193 47.193C512 103.847 512 104.849 512 105.739z"/><path style="fill:#cfdbe6" d="M464.696 55.763c-.892-.111-1.891-.111-2.783-.111H256v400.696h205.913c27.715.0 50.087-22.372 50.087-50.087V105.739c0-.89.0-1.892-.111-2.783C510.553 77.468 490.184 57.099 464.696 55.763z"/><path style="fill:#ff4b26" d="M511.889 102.957c-1.336-25.489-21.704-45.857-47.193-47.193C382.89 137.569 336.951 183.509 256 264.459 225.291 233.732 77.61 85.958 47.416 55.763c-25.6 1.336-45.969 21.704-47.304 47.304C0 103.958.0 104.849.0 105.739v300.522c0 27.715 22.372 50.087 50.087 50.087h16.696V169.739l165.621 165.51c6.456 6.567 15.026 9.795 23.597 9.795 8.57.0 17.141-3.228 23.597-9.795l165.621-165.621v286.72h16.696c27.715.0 50.087-22.372 50.087-50.087V105.739C512 104.849 512 103.847 511.889 102.957z"/><path style="fill:#d93f21" d="M279.596 335.249l165.621-165.621v286.72h16.696c27.715.0 50.087-22.372 50.087-50.087V105.739c0-.89.0-1.892-.111-2.783-1.336-25.489-21.704-45.857-47.193-47.193C382.891 137.569 336.951 183.509 256 264.459v80.584C264.57 345.043 273.141 341.816 279.596 335.249z"/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li><li><a href=https://nexus-security.github.io/index.xml target=_blank title=RSS><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#f78c20" d="M78.333 355.334C35.14 355.334.0 390.474.0 433.667S35.14 512 78.333 512s78.333-35.14 78.333-78.333-35.14-78.333-78.333-78.333z"/><g><path style="fill:#ffa929" d="M78.333 381.445c-28.795.0-52.222 23.427-52.222 52.222s23.427 52.222 52.222 52.222 52.222-23.427 52.222-52.222-23.427-52.222-52.222-52.222z"/><path style="fill:#ffa929" d="M477.918 264.861c-21.843-51.641-53.111-98.019-92.936-137.842-39.824-39.824-86.201-71.093-137.843-92.935C193.669 11.468 136.874.0 78.333.0c-4.807.0-8.704 3.897-8.704 8.704v85.519c0 4.807 3.897 8.704 8.704 8.704 182.37.0 330.74 148.369 330.74 330.74.0 4.807 3.897 8.704 8.704 8.704h85.52c4.807.0 8.704-3.897 8.704-8.704C512 375.126 500.533 318.331 477.918 264.861z"/><path style="fill:#ffa929" d="M78.333 163.853c-4.807.0-8.704 3.897-8.704 8.704v95.74c0 4.807 3.897 8.704 8.704 8.704 86.386.0 156.666 70.281 156.666 156.666.0 4.807 3.897 8.704 8.704 8.704h95.74c4.807.0 8.704-3.897 8.704-8.704.0-72.07-28.065-139.826-79.027-190.787-50.961-50.961-118.717-79.027-190.787-79.027z"/></g><g><path style="fill:#f78c20" d="M78.333 242.186c-2.918.0-5.817.076-8.704.206v25.905c0 4.807 3.897 8.704 8.704 8.704 86.386.0 156.666 70.281 156.666 156.666.0 4.807 3.897 8.704 8.704 8.704h25.905c.129-2.886.206-5.786.206-8.704.0-105.752-85.729-191.481-191.481-191.481z"/><path style="fill:#f78c20" d="M78.333 68.113c-2.91.0-5.81.042-8.704.11v26.001c0 4.807 3.897 8.704 8.704 8.704 182.37.0 330.74 148.369 330.74 330.74.0 4.807 3.897 8.704 8.704 8.704h26.001c.067-2.894.11-5.793.11-8.704C443.887 231.777 280.223 68.113 78.333 68.113z"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li><li><a href target=_blank title=Slack><svg width="256" height="256" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M165.964 15.838c-3.89-11.975-16.752-18.528-28.725-14.636-11.975 3.89-18.528 16.752-14.636 28.725l58.947 181.365c4.048 11.187 16.132 17.473 27.732 14.135 12.1-3.483 19.475-16.334 15.614-28.217L165.964 15.838" fill="#dfa22f"/><path d="M74.626 45.516C70.734 33.542 57.873 26.989 45.9 30.879 33.924 34.77 27.37 47.631 31.263 59.606l58.948 181.366c4.047 11.186 16.132 17.473 27.732 14.132 12.099-3.481 19.474-16.332 15.613-28.217L74.626 45.516" fill="#3cb187"/><path d="M240.162 166.045c11.975-3.89 18.526-16.75 14.636-28.726-3.89-11.973-16.752-18.527-28.725-14.636L44.708 181.632c-11.187 4.046-17.473 16.13-14.135 27.73 3.483 12.099 16.334 19.475 28.217 15.614l181.372-58.93" fill="#ce1e5b"/><path d="M82.508 217.27l43.347-14.084-14.086-43.352-43.35 14.09 14.089 43.347" fill="#392538"/><path d="M173.847 187.591c16.388-5.323 31.62-10.273 43.348-14.084l-14.088-43.36-43.35 14.09 14.09 43.354" fill="#bb242a"/><path d="M210.484 74.706c11.974-3.89 18.527-16.751 14.637-28.727-3.89-11.973-16.752-18.526-28.727-14.636L15.028 90.293C3.842 94.337-2.445 106.422.896 118.022c3.481 12.098 16.332 19.474 28.217 15.613l181.371-58.93" fill="#72c5cd"/><path d="M52.822 125.933c11.805-3.836 27.025-8.782 43.354-14.086-5.323-16.39-10.273-31.622-14.084-43.352l-43.36 14.092 14.09 43.346" fill="#248c73"/><path d="M144.16 96.256l43.356-14.088a546179.21 546179.21.0 00-14.089-43.36L130.07 52.9l14.09 43.356" fill="#62803a"/></svg></a></li><li><a href=https://www.minds.com/0x000216/ target=_blank title=Minds><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><g><g><path style="fill:#ffe1b2" d="M256 33.085C245.078 13.38 224.079.0 2e2.0c-23.781.0-45.57 13.293-56.594 34.184C115.711 41.602 96 66.977 96 96c0 .059.0.113.0.172-9.977 7.512-16 19.301-16 31.828.0 1.316.078 2.637.234 3.992C60.211 145.266 48 167.758 48 192c0 14.07 4.039 27.543 11.719 39.262C57.273 236.512 56 242.207 56 248c0 2.738.281 5.445.828 8.098C36.672 267.308 24 288.539 24 312c0 27.973 18.305 52.34 44.109 60.785C65.398 378.828 64 385.324 64 392c0 21.098 13.805 39.508 33.539 45.727C103.891 466.746 129.828 488 160 488c4.617.0 9.227-.512 13.766-1.527C181.992 502 198.141 512 216 512c16.687.0 31.396-8.567 40-21.523V33.085z"/></g><g><g><path style="fill:#ffb980" d="M264 256c-4.422.0-8-3.582-8-8 0-22.055-17.945-40-40-40-8.008.0-15.734 2.355-22.336 6.812-3.023 2.043-7.055 1.781-9.797-.652-3.156-2.809-8.477-6.16-15.867-6.16-4.422.0-8-3.582-8-8s3.578-8 8-8c7.711.0 15.234 2.293 21.719 6.539C197.773 194.246 206.758 192 216 192c30.875.0 56 25.121 56 56C272 252.418 268.422 256 264 256z"/></g></g><g><g><path style="fill:#ffb980" d="M120 120c18.977.0 36.875 7.312 50.414 20.594 3.141 3.09 8.203 3.047 11.312-.109 3.094-3.152 3.047-8.219-.109-11.312C165.07 112.941 143.187 104 120 104c-13.046.0-25.395 2.93-36.542 8.046C81.253 117.019 80 122.423 80 128c0 1.316.078 2.637.234 3.992-.094.062-.173.139-.267.202C91.423 124.501 105.193 120 120 120z"/></g></g><g><g><path style="fill:#ffb980" d="M216 360c0-4.418-3.578-8-8-8s-8 3.582-8 8c0 17.645-14.352 32-32 32-14.211.0-26.82-9.648-30.664-23.465-.703-2.512-2.578-4.523-5.039-5.395-2.453-.871-5.188-.492-7.305 1.02C114.094 371.906 101.305 376 88 376c-6.948.0-13.625-1.149-19.894-3.207-2.214 4.939-3.501 10.19-3.916 15.586C71.714 390.73 79.711 392 88 392c13.297.0 26.187-3.266 37.773-9.52C133.969 397.894 150.141 408 168 408c26.469.0 48-21.531 48-48z"/></g></g><g><path style="fill:#fdc88e" d="M488 312c0-23.461-12.672-44.691-32.828-55.902.547-2.652.828-5.359.828-8.098.0-5.793-1.273-11.488-3.719-16.738C459.961 219.543 464 206.07 464 192c0-24.242-12.211-46.734-32.234-60.008.156-1.355.234-2.676.234-3.992.0-12.527-6.023-24.316-16-31.828.0-.059.0-.113.0-.172.0-29.023-19.711-54.398-47.406-61.816C357.57 13.293 335.781.0 312 0c-24.08.0-45.078 13.38-56 33.085v457.391C264.604 503.433 279.313 512 296 512c17.859.0 34.008-10 42.234-25.527C342.773 487.488 347.383 488 352 488c30.172.0 56.109-21.254 62.461-50.273C434.195 431.508 448 413.097 448 392c0-6.676-1.398-13.172-4.109-19.215C469.695 364.34 488 339.973 488 312z"/></g><g><path style="fill:#f8ab6b" d="M272.008 151.199C272 151.465 272 151.734 272 152c0 26.469 21.531 48 48 48s48-21.531 48-48c0-4.418-3.578-8-8-8s-8 3.582-8 8c0 17.645-14.352 32-32 32s-32-14.355-32-32c0-2.184.219-4.359.656-6.465.492-2.395-.133-4.883-1.703-6.754-1.57-1.871-4.016-3.066-6.352-2.859-.453.012-.891.059-.602.078-13.234.0-24-10.766-24-24v31.813C260.673 147.348 266.061 149.988 272.008 151.199z"/></g><g><path style="fill:#f8ab6b" d="M296 328c9.242.0 18.219-2.246 26.281-6.539C328.765 325.707 336.289 328 344 328c4.422.0 8-3.582 8-8s-3.578-8-8-8c-7.391.0-12.711-3.352-15.867-6.16-2.742-2.434-6.766-2.695-9.797-.656C311.726 309.644 304 312 296 312c-22.055.0-40-17.945-40-40v39.116C266.174 321.517 280.337 328 296 328z"/></g><g><g><path style="fill:#f8ab6b" d="M431.765 131.992c.156-1.355.234-2.676.234-3.992.0-5.577-1.253-10.981-3.458-15.954C417.395 106.93 405.046 104 392 104c-4.422.0-8 3.582-8 8s3.578 8 8 8c14.807.0 28.577 4.501 40.032 12.194C431.939 132.131 431.859 132.054 431.765 131.992z"/></g></g><g><g><path style="fill:#f8ab6b" d="M447.81 388.38c-.415-5.396-1.702-10.647-3.916-15.586C437.624 374.85 430.948 376 424 376c-13.578.0-26.594-4.266-37.641-12.332-2.07-1.5-4.719-1.93-7.133-1.168-2.43.77-4.344 2.648-5.164 5.059C369.101 382.176 355.414 392 340 392c-4.422.0-8 3.582-8 8s3.578 8 8 8c18.875.0 35.961-10.191 45.094-26.156C396.976 388.512 410.258 392 424 392 432.288 392 440.285 390.73 447.81 388.38z"/></g></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li><li><a href=https://www.buymeacoffee.com/0x000216 target=_blank title=Coffee><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 340 340" style="enable-background:new 0 0 340 340"><g id="XMLID_18_"><polygon id="XMLID_138_" style="fill:#dedde0" points="76.429,290 80,340 170,340 170,290"/><polygon id="XMLID_169_" style="fill:#dedde0" points="170,80 61.429,80 65,130 170,130"/><polygon id="XMLID_197_" style="fill:#acabb1" points="170,290 170,340 260,340 263.571,290"/><polygon id="XMLID_221_" style="fill:#acabb1" points="170,80 170,130 275,130 278.571,80"/><path id="XMLID_222_" style="fill:#ffda44" d="M170 260c-22.091.0-40-22.386-40-50s17.909-50 40-50v-30H65 50l10 160h16.429H170V260z"/><path id="XMLID_33_" style="fill:#ff9811" d="M170 130v30c22.091.0 40 22.386 40 50s-17.909 50-40 50v30h93.571H280l10-160h-15H170z"/><path id="XMLID_223_" style="fill:#50412e" d="M210 210c0-27.614-17.909-50-40-50v1e2c22.091.0 40-22.386 40-50z"/><path id="XMLID_224_" style="fill:#786145" d="M130 210c0 27.614 17.909 50 40 50V160c-22.091.0-40 22.386-40 50z"/><polygon id="XMLID_225_" style="fill:#50412e" points="278.571,80 300,80 300,40 260,40 260,0 80,0 80,40 40,40 40,80 61.429,80 170,80"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Us</span></a></li><li><a href=/termsofservice/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"/><line x1="13.5" y1="6.5" x2="17.5" y2="10.5"/></svg><span>Terms Of Service</span></a></li><li><a href=/privacypolicy/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Privacy Policy</span></a></li><li><a href=/disclaimer/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Disclaimer</span></a></li><li><a href=/contact/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg><span>Contact Us</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-be-mobile-theme-v15-mobile-wordpress_25/>Be Mobile Theme v1.5 â€“ Mobile WordPress Theme</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Sep 26, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>10 minute read</time></div></footer></div></header><section class=article-content><p><strong>Kang Asu</strong></p><p><a class=link href=https://1.bp.blogspot.com/-yqVbvEdGolc/XX3R39NA-AI/AAAAAAAABsA/KAcEDbhyHu8hzsr8avONS94eW1GnQS6dgCLcBGAsYHQ/s1600/RDP-MITM-How-it-works.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-yqVbvEdGolc/XX3R39NA-AI/AAAAAAAABsA/KAcEDbhyHu8hzsr8avONS94eW1GnQS6dgCLcBGAsYHQ/s320/RDP-MITM-How-it-works.png loading=lazy></a></p><p><strong>Pyrdp - RDP Man-In-The-Middle And Library For Python3 With The Ability To Watch Connections Live Or After The Fact</strong></p><p>PyRDP is a Python 3Â <a class=link href=https://www.kitploit.com/search/label/Remote%20Desktop%20Protocol title="Remote Desktop Protocol" target=_blank rel=noopener>Remote Desktop Protocol</a>Â (RDP)Â <a class=link href=https://www.kitploit.com/search/label/Man-in-the-Middle title=Man-in-the-Middle target=_blank rel=noopener>Man-in-the-Middle</a>Â (MITM) and library.<br>It features a few tools:</p><ul><li>RDP Man-in-the-Middle<ul><li>LogsÂ <a class=link href=https://www.kitploit.com/search/label/Credentials title=credentials target=_blank rel=noopener>credentials</a>Â used when connecting</li><li>Steals data copied to the clipboard</li><li>Saves a copy of the files transferred over the network</li><li>Saves replays of connections so you can look at them later</li><li>Run console commands orÂ <a class=link href=https://www.kitploit.com/search/label/PowerShell title=PowerShell target=_blank rel=noopener>PowerShell</a>Â payloads automatically on new connections</li></ul></li><li>RDP Player:<ul><li>See live RDP connections coming from the MITM</li><li>View replays of RDP connections</li><li>Take control of active RDP sessions while hiding your actions</li><li>List the client&rsquo;s mapped drives and download files from them during active sessions</li></ul></li><li>RDP Certificate Cloner:<ul><li>Create a self-signed X509 certificate with the same fields as an RDP server&rsquo;s certificate</li></ul></li></ul><p>We have used this tool as part of an RDP honeypot which records sessions and saves a copy of the malware dropped on our target machine.<br>PyRDP wasÂ <a class=link href=https://www.gosecure.net/blog/2018/12/19/rdp-man-in-the-middle-smile-youre-on-camera title="first introduced in a blogpost" target=_blank rel=noopener>first introduced in a blogpost</a>Â in which weÂ <a class=link href="https://www.youtube.com/watch?v=eB7RC9FmL6Q" title="demonstrated that we can catch a real threat actor in action" target=_blank rel=noopener>demonstrated that we can catch a real threat actor in action</a>. In May 2019 aÂ <a class=link href="https://docs.google.com/presentation/d/1avcn8Sh2b3IE7AA0G9l7Cj5F1pxqizUm98IbXUo2cvY/edit#slide=id.g404b70030f_0_581" title="presentation by its authors" target=_blank rel=noopener>presentation by its authors</a>Â was given at NorthSec and two demos were performed.Â <a class=link href=https://youtu.be/5JztJzi-m48 title="The first one covered" target=_blank rel=noopener>The first one covered</a>Â credential logging, clipboard stealing, client-side file browsing and a session take-over.Â <a class=link href=https://youtu.be/bU67tj1RkMA title="The second one covered" target=_blank rel=noopener>The second one covered</a>Â the execution of cmd or powershell payloads when a client successfully authenticates. In August 2019, PyRDP was demo&rsquo;ed at BlackHat Arsenal (<a class=link href="https://docs.google.com/presentation/d/17P_l2n-hgCehQ5eTWilru4IXXHnGIRTj4ftoW4BiX5A/edit?usp=sharing" title=slides target=_blank rel=noopener>slides</a>).<br><a class=link href=https://www.blogger.com/u/1/null target=_blank rel=noopener></a></p><p><strong>Supported Systems</strong><br>PyRDP should work on Python 3.6 and up.<br>This tool has been tested to work on Python 3.6 on Linux (Ubuntu 18.04) and Windows (See sectionÂ <a class=link href=https://github.com/gosecure/pyrdp#installing-on-windows title="Installing on Windows" target=_blank rel=noopener>Installing on Windows</a>). It has not been tested on OSX.</p><p><strong>Installing</strong><br>We recommend installing PyRDP in aÂ <a class=link href=https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/ title="virtual environment" target=_blank rel=noopener>virtual environment</a>Â to avoid dependency issues.<br>First, make sure to install the prerequisite packages (on Ubuntu):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt install libdbus-1-dev libdbus-glib-1-dev
</span></span></code></pre></td></tr></table></div></div><p>On some systems, you may need to install theÂ <code>python3-venv</code>Â package:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt install python3-venv
</span></span></code></pre></td></tr></table></div></div><p>Then, create your virtual environment in PyRDP&rsquo;s directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd pyrdp   
</span></span><span class=line><span class=cl>python3 -m venv venv
</span></span></code></pre></td></tr></table></div></div><p><em>DO NOT</em>Â use the root PyRDP directory for the virtual environment folder (<code>python3 -m venv .</code>). You will make a mess, and using a directory name likeÂ <code>venv</code>Â is more standard anyway.<br>Before installing the dependencies, you need to activate your virtual environment:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>source venv/bin/activate
</span></span></code></pre></td></tr></table></div></div><p>Finally, you can install the project with Pip:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 install -U pip setuptools wheel  
</span></span><span class=line><span class=cl>pip3 install -U -e .
</span></span></code></pre></td></tr></table></div></div><p>This should install all the dependencies required to run PyRDP.<br>If you ever want to leave your virtual environment, you can simply deactivate it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>deactivate
</span></span></code></pre></td></tr></table></div></div><p>Note that you will have to activate your environment every time you want to have the PyRDP scripts available as shell commands.</p><p><strong>Installing on Windows</strong><br>The steps are almost the same. There are two additional prerequisites.</p><ol><li>Any C compiler</li><li><a class=link href=https://wiki.openssl.org/index.php/Binaries title=OpenSSL target=_blank rel=noopener>OpenSSL</a>. Make sure it is reachable from yourÂ <code>$PATH</code>.</li></ol><p>Then, create your virtual environment in PyRDP&rsquo;s directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd pyrdp  
</span></span><span class=line><span class=cl>python3 -m venv venv
</span></span></code></pre></td></tr></table></div></div><p><em>DO NOT</em>Â use the root PyRDP directory for the virtual environment folder (<code>python3 -m venv .</code>). You will make a mess, and using a directory name likeÂ <code>venv</code>Â is more standard anyway.<br>Before installing the dependencies, you need to activate your virtual environment:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>venv\Scripts\activate
</span></span></code></pre></td></tr></table></div></div><p>Finally, you can install the project with Pip:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 install -U pip setuptools wheel  
</span></span><span class=line><span class=cl>pip3 install -U -e .
</span></span></code></pre></td></tr></table></div></div><p>This should install all the dependencies required to run PyRDP.<br>If you ever want to leave your virtual environment, you can simply deactivate it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>deactivate
</span></span></code></pre></td></tr></table></div></div><p>Note that you will have to activate your environment every time you want to have the PyRDP scripts available as shell commands.</p><p><strong>Installing with Docker</strong><br>First of all, build the image by executing this command at the root of PyRDP (where Dockerfile is located):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker build -t pyrdp .
</span></span></code></pre></td></tr></table></div></div><p>Afterwards, you can execute the following command to run the container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker run -it pyrdp pyrdp-mitm.py 192.168.1.10
</span></span></code></pre></td></tr></table></div></div><p>For more information about the various commands and arguments, please refer to these sections:</p><ul><li><a class=link href=https://github.com/gosecure/pyrdp#using-the-pyrdp-man-in-the-middle title="Using the PyRDP MITM" target=_blank rel=noopener>Using the PyRDP MITM</a></li><li><a class=link href=https://github.com/gosecure/pyrdp#using-the-pyrdp-player title="Using the PyRDP Player" target=_blank rel=noopener>Using the PyRDP Player</a></li><li><a class=link href=https://github.com/gosecure/pyrdp#using-the-pyrdp-certificate-cloner title="Using the PyRDP Certificate Cloner" target=_blank rel=noopener>Using the PyRDP Certificate Cloner</a></li></ul><p>To store the PyRDP output permanently (logs, files, etc.), add the -v option to the previous command. For example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker run -v /home/myname/pyrdp_output:/home/pyrdp/pyrdp_output pyrdp pyrdp-mitm.py 192.168.1.10
</span></span></code></pre></td></tr></table></div></div><p>Make sure that your destination directory is owned by a user with a UID of 1000, otherwise you will get a permission denied error. If you&rsquo;re the only user on the system, you should not need to worry about this.</p><p><strong>Using the player in Docker</strong><br>Using the player will require you to export the DISPLAY environment variable from the host to the docker. This redirects the GUI of the player to the host screen. You also need to expose the host&rsquo;s network and stop Qt from using the MIT-SHM X11 Shared Memory Extension. To do so, add the -e and &ndash;net options to the run command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker run -e DISPLAY=$DISPLAY -e QT_X11_NO_MITSHM=1 --net=host pyrdp pyrdp-player.py
</span></span></code></pre></td></tr></table></div></div><p>Keep in mind that exposing the host&rsquo;s network to the docker can compromise the isolation between your container and the host. If you plan on using the player, X11 forwarding using an SSH connection would be a more secure way.</p><p><strong>Migrating away from pycrypto</strong><br>Since pycrypto isn&rsquo;t maintained anymore, we chose to migrate to pycryptodome. If you get this error, it means that you are using the module pycrypto instead of pycryptodome.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[...]  
</span></span><span class=line><span class=cl>  File &#34;[...]/pyrdp/pyrdp/pdu/rdp/connection.py&#34;, line 10, in   
</span></span><span class=line><span class=cl>    from Crypto.PublicKey.RSA import RsaKey  
</span></span><span class=line><span class=cl>ImportError: cannot import name &#39;RsaKey&#39;
</span></span></code></pre></td></tr></table></div></div><p>You will need to remove the module pycrypto and reinstall PyRDP.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 uninstall pycrypto  
</span></span><span class=line><span class=cl>pip3 install -U -e .
</span></span></code></pre></td></tr></table></div></div><p><strong>Using the PyRDP Man-in-the-Middle</strong><br>UseÂ <code>pyrdp-mitm.py</code> Â orÂ <code>pyrdp-mitm.py :</code>Â to run the MITM.<br>Assuming you have an RDP server running onÂ <code>192.168.1.10</code>Â and listening on port 3389, you would run:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-mitm.py 192.168.1.10
</span></span></code></pre></td></tr></table></div></div><p>When running the MITM for the first time on Linux, a private key and certificate should be generated for you inÂ <code>~/.config/pyrdp</code>. These are used when TLS security is used on a connection. You can use them to decrypt PyRDP traffic in Wireshark, for example.</p><p><strong>Specifying the private key and certificate</strong><br>If key generation didn&rsquo;t work or you want to use a custom key and certificate, you can specify them using theÂ <code>-c</code>Â andÂ <code>-k</code>Â arguments:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-mitm.py 192.168.1.10 -k private_key.pem -c certificate.pem
</span></span></code></pre></td></tr></table></div></div><p><strong>Connecting to the PyRDP player</strong><br>If you want to see live RDP connections through the PyRDP player, you will need to specify the ip and port on which the player is listening using theÂ <code>-i</code>Â andÂ <code>-d</code>Â arguments. Note: the port argument is optional, the default port is 3000.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-mitm.py 192.168.1.10 -i 127.0.0.1 -d 3000
</span></span></code></pre></td></tr></table></div></div><p><strong>Connecting to a PyRDP player when the MITM is running on a server</strong><br>If you are running the MITM on a server and still want to see live RDP connections, you should useÂ <a class=link href=https://www.booleanworld.com/guide-ssh-port-forwarding-tunnelling/ title="SSH remote port forwarding" target=_blank rel=noopener>SSH remote port forwarding</a>Â to forward a port on your server to the player&rsquo;s port on your machine. Once this is done, you passÂ <code>127.0.0.1</code>Â and the forwarded port as arguments to the MITM. For example, if port 4000 on the server is forwarded to the player&rsquo;s port on your machine, this would be the command to use:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-mitm.py 192.168.1.10 -i 127.0.0.1 -d 4000
</span></span></code></pre></td></tr></table></div></div><p><strong>Running payloads on new connections</strong><br>PyRDP has support for running console commands or PowerShell payloads automatically when new connections are made. Due to the nature of RDP, the process is a bit hackish and is not always 100% reliable. Here is how it works:</p><ol><li>Wait for the user to be authenticated.</li><li>Block the client&rsquo;s input / output to hide the payload and prevent interference.</li><li>Send a fake Windows+R sequence and runÂ <code>cmd.exe</code>.</li><li>Run the payload as a console command and exit the console. If a PowerShell payload is configured, it is run withÂ <code>powershell -enc</code> .</li><li>Wait a bit to allow the payload to complete.</li><li>Restore the client&rsquo;s input / output.</li></ol><p>For this to work, you need to set 3 arguments:</p><ul><li>the payload</li><li>the delay before the payload starts</li><li>the payload&rsquo;s duration</li></ul><p><strong>Setting the payload</strong><br>You can use one of the following arguments to set the payload to run:</p><ul><li><code>--payload</code>, a string containing console commands</li><li><code>--payload-powershell</code>, a string containing PowerShell commands</li><li><code>--payload-powershell-file</code>, a path to a PowerShell script</li></ul><p><strong>Choosing when to start the payload</strong><br>For the moment, PyRDP does not detect when the user is logged on. You must give it an amount of time to wait for before running the payload. After this amount of time has passed, it will send the fake key sequences and expect the payload to run properly. To do this, you use theÂ <code>--payload-delay</code>Â argument. The delay is in milliseconds. For example, if you expect the user to be logged in within the first 5 seconds, you would use the following arguments:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>--payload-delay 5000
</span></span></code></pre></td></tr></table></div></div><p>This could be made more accurate by leveraging some messages exchanged during RDPDR initialization. SeeÂ <a class=link href=https://github.com/GoSecure/pyrdp/issues/98 title="this issue" target=_blank rel=noopener>this issue</a>Â if you&rsquo;re interested in making this work better.</p><p><strong>Choosing when to resume normal activity</strong><br>Because there is no direct way to know when the console has stopped running, you must tell PyRDP how long you want the client&rsquo;s input / output to be blocked. We recommend you set this to the maximum amount of time you would expect the console that is running your payload to be visible. In other words, the amount of time you would expect your payload to complete. To set the payload duration, you use theÂ <code>--payload-duration</code>Â argument with an amount of time in milliseconds. For example, if you expect your payload to take up to 5 seconds to complete, you would use the following argument:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>--payload-duration 5000
</span></span></code></pre></td></tr></table></div></div><p>This will block the client&rsquo;s input / output for 5 seconds to hide the console and prevent interference. After 5 seconds, input / output is restored back to normal.</p><p><strong>Other MITM arguments</strong><br>RunÂ <code>pyrdp-mitm.py --help</code>Â for a full list of arguments.</p><p><strong>Using the PyRDP Player</strong><br>UseÂ <code>pyrdp-player.py</code>Â to run the player.</p><p><strong>Playing a replay file</strong><br>You can use the menu to open a new replay file: File > Open.<br>You can also open replay files when launching the player:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-player.py   ...
</span></span></code></pre></td></tr></table></div></div><p><strong>Listening for live connections</strong><br>The player always listens for live connections. By default, the listening port is 3000, but it can be changed:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pyrdp-player.py -p 
</span></span></code></pre></td></tr></table></div></div><p><strong>Changing the listening address</strong><br>By default, the player only listens to connections coming from the local machine. We do not recommend opening up the player to other machines. If you still want to change the listening address, you can do it withÂ <code>-b</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>`pyrdp-player.py -b` 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Other player arguments**  
</span></span><span class=line><span class=cl>RunÂ `pyrdp-player.py --help`Â for a full list of arguments.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Using the PyRDP Certificate Cloner**  
</span></span><span class=line><span class=cl>The PyRDP certificate cloner creates a brand new X509 certificate by using the values from an existing RDP server&#39;s certificate. It connects to an RDP server, downloads its certificate, generates a new private key and replaces the public key and signature of the certificate using the new private key. This can be used in a pentest if, for example, you&#39;re trying to trick a legitimate user into going through your MITM. Using a certificate that looks like a legitimate certificate could increase your success rate.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Cloning a certificate**  
</span></span><span class=line><span class=cl>You can clone a certificate by usingÂ `pyrdp-clonecert.py`:
</span></span></code></pre></td></tr></table></div></div><p>pyrdp-clonecert.py 192.168.1.10 cert.pem -o key.pem</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TheÂ `-o`Â parameter defines the path name to use for the generated private key.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Using a custom private key**  
</span></span><span class=line><span class=cl>If you want to use your own private key instead of generating a new one:
</span></span></code></pre></td></tr></table></div></div><p>pyrdp-clonecert.py 192.168.1.10 cert.pem -i input_key.pem</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Other cloner arguments**  
</span></span><span class=line><span class=cl>RunÂ `pyrdp-clonecert.py --help`Â for a full list of arguments.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Using PyRDP as a Library**  
</span></span><span class=line><span class=cl>If you&#39;re interested in experimenting with RDP and making your own tools, head over to ourÂ [documentation section](https://github.com/GoSecure/pyrdp/blob/master/docs/README.md &#34;documentation section&#34;)Â for more information.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Using PyRDP with Bettercap**  
</span></span><span class=line><span class=cl>We developped our own Bettercap module,Â `rdp.proxy`, to man-in-the-middle all RDP connections on a given LAN. Check outÂ [this document](https://github.com/GoSecure/pyrdp/blob/master/docs/bettercap-rdp-mitm.md &#34;this document&#34;)Â for more information.  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**PyRDP Presentations**  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Contributing to PyRDP**  
</span></span><span class=line><span class=cl>See ourÂ [contribution guidelines](https://github.com/GoSecure/pyrdp/blob/master/CONTRIBUTING.md &#34;contribution guidelines&#34;).  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>**Acknowledgements**  
</span></span><span class=line><span class=cl>PyRDP uses code from the following open-source software:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*   [RC4-Python](https://github.com/bozhu/RC4-Python &#34;RC4-Python&#34;)Â for the RC4 implementation.
</span></span><span class=line><span class=cl>*   [rdesktop](https://github.com/rdesktop/rdesktop &#34;rdesktop&#34;)Â for bitmap decompression.
</span></span><span class=line><span class=cl>*   [rdpy](https://github.com/citronneur/rdpy &#34;rdpy&#34;)Â for RC4 keys, the bitmap decompression bindings and the base GUI code for the PyRDP player.
</span></span><span class=line><span class=cl>*   [FreeRDP](https://github.com/FreeRDP/FreeRDP &#34;FreeRDP&#34;)Â for the scan code enumeration.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**[Download Pyrdp](http://eunsetee.com/9kHV &#34;Download Pyrdp&#34;)**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**Regards**
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>**Kang Asu**
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3987358164777632" crossorigin=anonymous></script>
<script data-name=BMC-Widget src=https://cdn.buymeacoffee.com/widget/1.0.0/prod/widget.prod.min.js data-id=0x000216 data-description=coffee! data-message=coffee! data-color=#FF813F data-position=right data-x_margin=28 data-y_margin=18></script></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>