<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kang Asu
B2R2 - Collection Of Useful Algorithms, Functions, And Tools For Binary Analysis
B2R2 is a collection of useful algorithms, functions, and tools for binary analysis, written purely in F# (in .NET lingo, it is purely managed code). B2R2 has been named after R2-D2, a famous fictional robot appeared in the Star Wars. In fact, B2R2&amp;rsquo;s original name was B2-R2, but we decided to use the name B2R2 instead, because ."><title>B2R2</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-b2r2/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="B2R2"><meta property="og:description" content="Kang Asu
B2R2 - Collection Of Useful Algorithms, Functions, And Tools For Binary Analysis
B2R2 is a collection of useful algorithms, functions, and tools for binary analysis, written purely in F# (in .NET lingo, it is purely managed code). B2R2 has been named after R2-D2, a famous fictional robot appeared in the Star Wars. In fact, B2R2&amp;rsquo;s original name was B2-R2, but we decided to use the name B2R2 instead, because ."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-b2r2/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-10-24T06:14:00+01:00"><meta property="article:modified_time" content="2019-10-24T06:14:00+01:00"><meta name=twitter:title content="B2R2"><meta name=twitter:description content="Kang Asu
B2R2 - Collection Of Useful Algorithms, Functions, And Tools For Binary Analysis
B2R2 is a collection of useful algorithms, functions, and tools for binary analysis, written purely in F# (in .NET lingo, it is purely managed code). B2R2 has been named after R2-D2, a famous fictional robot appeared in the Star Wars. In fact, B2R2&amp;rsquo;s original name was B2-R2, but we decided to use the name B2R2 instead, because ."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍇</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-b2r2/>B2R2</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 24, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p><strong>Kang Asu</strong></p><p><a class=link href=https://1.bp.blogspot.com/-kj5-jsEmFnU/XaanabMnhiI/AAAAAAAABvg/YcxZ1WYMsdAaQE8tkeV56OzZfPpoHQ3UACLcBGAsYHQ/s1600/B2R2.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-kj5-jsEmFnU/XaanabMnhiI/AAAAAAAABvg/YcxZ1WYMsdAaQE8tkeV56OzZfPpoHQ3UACLcBGAsYHQ/s320/B2R2.png loading=lazy></a></p><p><strong>B2R2 - Collection Of Useful Algorithms, Functions, And Tools For Binary Analysis</strong></p><p>B2R2 is a collection of useful algorithms, functions, and tools for <strong>binary analysis</strong>, written purely in F# (in .NET lingo, it is purely managed code). B2R2 has been named after <a class=link href=https://en.wikipedia.org/wiki/R2-D2 title=R2-D2 target=_blank rel=noopener>R2-D2</a>, a famous fictional robot appeared in the Star Wars. In fact, B2R2&rsquo;s original name was <em>B2-R2</em>, but we decided to use the name <em>B2R2</em> instead, because .NET does not allow dash (-) characters in identifiers (or namespaces). The name essentially represents &ldquo;binary&rdquo; or &ldquo;two&rdquo;: &ldquo;binary&rdquo; itself means &ldquo;two&rdquo; states anyways. &ldquo;B&rdquo; and &ldquo;2&rdquo; mean &ldquo;binary&rdquo;, and &ldquo;R&rdquo; indicates <em>reversing</em>.</p><p><strong>B2R2?</strong></p><ol><li>B2R2 is <em>analysis-friendly</em>: it is written in F#, which provides all the syntactic goodies for writing program analyzers, such as pattern matching, algebraic data types, and etc.</li><li>B2R2 is <em>fast</em>: it has a fast and efficient front-end engine for binary analysis, which is written purely in a functional way. Therefore, it naturally supports <em>pure parallelism</em> for binary disassembling, lifting and IR optimization.</li><li>B2R2 is <em>easy</em> to play with: there is absolutely no dependency hell for B2R2 because it is a fully-managed library. All you need to do is to install <a class=link href=https://dotnet.microsoft.com/download title=".NET Core SDK" target=_blank rel=noopener>.NET Core SDK</a>, and you are ready to go! Native <a class=link href="https://docs.microsoft.com/en-us/visualstudio/ide/using-intellisense?view=vs-2017" title=IntelliSense target=_blank rel=noopener>IntelliSense</a> support is another plus!</li><li>B2R2 is <em>OS-Independent</em>: it works on Linux, Mac, Windows, and etc. as long as .NET core supports it.</li><li>B2R2 is <em>interoperable</em>: it is not bound to a specific language. Theoretically, you can use B2R2 APIs with any <a class=link href=https://en.wikipedia.org/wiki/List_of_CLI_languages title="CLI supported  languages" target=_blank rel=noopener>CLI supported languages</a>.</li></ol><p><strong>Features?</strong><br>Currently, our focus is on the front-end of binary analysis, which includes binary parser, lifter, and optimizer. B2R2 natively supports parallel lifting, which is a new technique we introduced in 2019 NDSS Bar. Please refer to our <a class=link href=https://github.com/B2R2-org/B2R2#citation title=paper target=_blank rel=noopener>paper</a> for more details about the technique as well as our design decisions. We also have our own back-end tools such as symbolic executor, but we are <em>not</em> planning to open-source them yet. Nevertheless, B2R2 includes several useful middle-end or back-end features such as ROP chain compilation, CFG building, and automatic graph drawing, and etc. B2R2 also comes with a simple command-line utility that we call <a class=link href=https://github.com/B2R2-org/B2R2/blob/master/src/Utilities/BinExplorer title="B2R2 is a collection of useful algorithms, functions, and tools for binary analysis. (11)" target=_blank rel=noopener><code>BinExplorer</code></a>, which can help explore such features using a simple <a class=link href=https://www.kitploit.com/search/label/Command%20Line title="command line" target=_blank rel=noopener>command line</a> interface.</p><p><strong>Dependencies?</strong><br>B2R2 relies on a tiny set of external .NET libraries, and our design principle is to use a minimum number of libraries. Below is a list of libraries that we leverage.</p><ul><li><a class=link href=https://www.nuget.org/packages/System.Reflection.Metadata/ title=System.Reflection.Metadata target=_blank rel=noopener>System.Reflection.Metadata</a></li><li><a class=link href=https://www.nuget.org/packages/Microsoft.FSharpLu.Json/ title=Microsoft.FSharpLu.Json target=_blank rel=noopener>Microsoft.FSharpLu.Json</a></li><li><a class=link href=https://www.nuget.org/packages/FParsec title=FParsec target=_blank rel=noopener>FParsec</a></li></ul><p><strong>API Documentation</strong><br>We currently use docfx to generate our documentation: <a class=link href=https://b2r2.org/APIDoc/ title=https://b2r2.org/APIDoc/ target=_blank rel=noopener>https://b2r2.org/APIDoc/</a></p><p><strong>Example</strong><br>Let&rsquo;s try to use B2R2 APIs.</p><ol><li><p>First we create an empty directory <code>DIRNAME</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mkdir DIRNAME
</span></span></code></pre></td></tr></table></div></div></li><li><p>We then create an empty console project with <code>dotnet</code> command line:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dotnet new console -lang F#
</span></span></code></pre></td></tr></table></div></div></li><li><p>Add our nuget package <em>B2R2.FrontEnd</em> to the project:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>$</span> <span class=nx>dotnet</span> <span class=nx>add</span> <span class=kn>package</span> <span class=nx>B2R2</span><span class=p>.</span><span class=nx>FrontEnd</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Modify the <code>Program.fs</code> file with your favorite editor as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>open B2R2  
</span></span><span class=line><span class=cl>open B2R2.FrontEnd  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[]  
</span></span><span class=line><span class=cl>let main argv =  
</span></span><span class=line><span class=cl>  let isa = ISA.OfString &#34;amd64&#34;  
</span></span><span class=line><span class=cl>  let bytes = [| 0x65uy; 0xffuy; 0x15uy; 0x10uy; 0x00uy; 0x00uy; 0x00uy |]  
</span></span><span class=line><span class=cl>  let handler = BinHandler.Init (isa, bytes)  
</span></span><span class=line><span class=cl>  let ins = BinHandler.ParseInstr handler 0UL  
</span></span><span class=line><span class=cl>  ins.Translate handler.TranslationContext |&gt; printfn &#34;%A&#34;  
</span></span><span class=line><span class=cl>  0
</span></span></code></pre></td></tr></table></div></div></li><li><p>We then just run it by typing: <code>dotnet run</code>. You will be able see lifted IR statements from your console. That&rsquo;s it! You just lifted an Intel instruction with only few lines of F# code!</p></li></ol><p><strong>Build</strong><br>Building B2R2 is fun and easy. All you need to do is to install .NET Core SDK 3.0 or above. Yea, that&rsquo;s it!</p><ul><li> To build B2R2 in release mode, type <code>make release</code> or <code>dotnet build -c Release</code> in the source root.</li><li> To build B2R2 in debug mode, type <code>make</code>, or <code>dotnet build</code> in the source root.</li></ul><p>For your information, please visit the official web site of F# to get more tips about installing the development environment for F#: <a class=link href=https://fsharp.org/ title=http://fsharp.org/ target=_blank rel=noopener>http://fsharp.org/</a>.</p><p><strong>Why Reinventing the Wheel?</strong><br>There are many other great tools available, but we wanted to build a <em>functional-first</em> binary <a class=link href=https://www.kitploit.com/search/label/Analysis title=analysis target=_blank rel=noopener>analysis</a> platform that is painless to install and runs on any platform without any hassle. B2R2 is in its <em>infancy</em> stage, but we believe it provides a rich set of library functions for binary analysis. It also has a strong front-end that is easily adaptable and extendible! Currently it reliably supports x86 and x86-64, meaning that we have heavily tested them; and it partially supports ARMv7 (and Thumb), ARMv8, MIPS32, and MIPS64, meaning that they work, but we haven&rsquo;t tested them thorougly yet.</p><p><strong>Features to be Added?</strong><br>Below is a list of features that we plan to add in the future: the list is totally incomplete. Some of them are work in progress, but we look forward your contributions! Feel free to write a PR (Pull Requst) while making sure that you have read our <a class=link href=https://github.com/B2R2-org/B2R2/blob/master/CONTRIBUTING.md title="contribution guideline" target=_blank rel=noopener>contribution guideline</a>.</p><ul><li>Implement CFG recovery algorithms.</li><li>Implement <a class=link href=https://www.kitploit.com/search/label/Assembler title=assembler target=_blank rel=noopener>assembler</a> for currently supported ISAs using a parser combinator.</li><li>Support for floating point operations.</li><li>Support for more architectures such as PPC.</li></ul><p><strong>Credits</strong><br>Members in <a class=link href=https://softsec.kaist.ac.kr/ title="SoftSec Lab" target=_blank rel=noopener>SoftSec Lab</a>. @ KAIST developed B2R2 in collaboration with <a class=link href=http://csrc.kaist.ac.kr/ title="Cyber Security Research Center" target=_blank rel=noopener>Cyber Security Research Center</a> (CSRC) at KAIST. See <a class=link href=https://github.com/B2R2-org/B2R2/blob/master/AUTHORS.md title=Authors target=_blank rel=noopener>Authors</a> for the full list.</p><p><strong><a class=link href=http://eunsetee.com/VuZD title="Download B2R2" target=_blank rel=noopener>Download B2R2</a></strong></p><p><strong>Regards</strong></p><p><strong>Kang Asu</strong></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>