<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A while back I picked up an old Canon Typestar IV portable typewriter in a junk shop: this is one of a class of electronic typewriter known as the ‚Äòthermal wedgie‚Äô: battery powered, printing via a thermal print head to either heat sensitive paper or with a special ribbon, they‚Äôre light, small and extremely quiet. Mine will run off rechargeable batteries. Unfortunately the ribbons are impossible to find and is it‚Äôs not valuable and I have no need for one anyway, I‚Äôve ripped the guts out and crudely turned it into what‚Äôs turned out to be a really rather nice USB keyboard ‚Äî the keyswitches are excellent."><title>Building a keyboard from an old portable (electronic) typewriter</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-building-keyboard-from-old-portable/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="Building a keyboard from an old portable (electronic) typewriter"><meta property="og:description" content="A while back I picked up an old Canon Typestar IV portable typewriter in a junk shop: this is one of a class of electronic typewriter known as the ‚Äòthermal wedgie‚Äô: battery powered, printing via a thermal print head to either heat sensitive paper or with a special ribbon, they‚Äôre light, small and extremely quiet. Mine will run off rechargeable batteries. Unfortunately the ribbons are impossible to find and is it‚Äôs not valuable and I have no need for one anyway, I‚Äôve ripped the guts out and crudely turned it into what‚Äôs turned out to be a really rather nice USB keyboard ‚Äî the keyswitches are excellent."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-building-keyboard-from-old-portable/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-11-09T07:31:00+01:00"><meta property="article:modified_time" content="2019-11-09T07:31:00+01:00"><meta name=twitter:title content="Building a keyboard from an old portable (electronic) typewriter"><meta name=twitter:description content="A while back I picked up an old Canon Typestar IV portable typewriter in a junk shop: this is one of a class of electronic typewriter known as the ‚Äòthermal wedgie‚Äô: battery powered, printing via a thermal print head to either heat sensitive paper or with a special ribbon, they‚Äôre light, small and extremely quiet. Mine will run off rechargeable batteries. Unfortunately the ribbons are impossible to find and is it‚Äôs not valuable and I have no need for one anyway, I‚Äôve ripped the guts out and crudely turned it into what‚Äôs turned out to be a really rather nice USB keyboard ‚Äî the keyswitches are excellent."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-building-keyboard-from-old-portable/>Building a keyboard from an old portable (electronic) typewriter</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 09, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>A while back I picked up an old Canon Typestar IV portable typewriter in a junk shop: this is one of a class of electronic typewriter known as the ‚Äòthermal wedgie‚Äô: battery powered, printing via a thermal print head to either heat sensitive paper or with a special ribbon, they‚Äôre light, small and extremely quiet. Mine will run off rechargeable batteries. Unfortunately the ribbons are impossible to find and is it‚Äôs not valuable and I have no need for one anyway, I‚Äôve ripped the guts out and crudely turned it into what‚Äôs turned out to be a really rather nice USB keyboard ‚Äî the keyswitches are excellent.</p><p><a class=link href=http://cowlark.com/2019-11-03-keyboard/typewriter.jpg target=_blank rel=noopener><img src=http://cowlark.com/2019-11-03-keyboard/typewriter.jpg loading=lazy></a></p><p>‚Ä¶and if you want to see it in action, here‚Äôs the demo reel.</p><p>VIDEO</p><p>I haven‚Äôt identified the keyswitches yet The keyswitches are <a class=link href=https://deskthority.net/wiki/SMK_spring_over_dome target=_blank rel=noopener>SMK spring over dome</a>: they‚Äôre linear with a very quiet tactile bump near the bottom of the travel, and super smooth. Each switch has a discrete rubberdome in a box housing which pushes a carbon pad against a PCB. For detailed pictures of the inside, there‚Äôs <a class=link href="https://deskthority.net/viewtopic.php?f=62&t=19859&start=" target=_blank rel=noopener>an excellent teardown on Deskthority</a>.</p><p>The very special ribbon lasted for about half an hour before it ran out, but I did manage to do a video demonstrating the typewriter with some light disassembly to see how it worked. The print quality was pretty good, actually.</p><p>VIDEO</p><p>Incidentally, these ribbons record every single keypress for posterity. Mine contained quite a lot of incriminating personal information about the previous owner, including name, address, Swiss medical insurance number, disability information, etc. Be warned.</p><p>(As a special bonus video, those of you into OCD/AMSR stuff might enjoy this video of me <a class=link href=https://www.youtube.com/embed/Wj29_DuSvYU target=_blank rel=noopener>painstakingly reattaching all the keycaps after cleaning them</a>‚Ä¶)</p><p>So, actually replacing the guts with a USB controller was interesting. I used a <a class=link href=https://www.cypress.com/documentation/development-kitsboards/cy8ckit-059-psoc-5lp-prototyping-kit-onboard-programmer-and target=_blank rel=noopener>PSoC5 CY8CKIT-059 development board</a>. This is a 80MHz ARM device with a small amount of RAM and a built-in FPGA, costing about $10-$15 depending on country. It‚Äôs completely overkill for this sort of application but I had one on my desk, and the development tools are great, although very proprietary and closed source. It‚Äôs flexible enough and has enough GPIO pins that I could simply wire every input or output from the keyboard to the board and then worry about the mapping later.</p><p><a class=link href=https://github.com/davidgiven/maxii-keyboard/tree/master/typestar4-keyboard.cydsn target=_blank rel=noopener><img src=http://cowlark.com/css/link.svg loading=lazy>The source code&rsquo;s Github repository</a></p><p>If you&rsquo;re interested in the firmware source code, it&rsquo;s here. It&rsquo;s not in very good shape but might serve as a decent example of how to implement a USB keyboard and USB CDC serial port on a PSoC5 device.</p><p>One interesting thing I discovered, which required me to modify the keyboard PCB to work around, was that the Shift Lock key worked the traditional typewriter way, rather than the modern computer way: you press it and it engages (and the nice little integrated LED comes on), but to disengage shift lock you press the Shift key instead. Pressing Shift Lock again does nothing. This was actually handled in discrete logic on the PCB, which I had to rip out.</p><p>The keyboard also has an integrated 15-character-plus-lots-of-bespoke-symbols LCD display. This is internally driven by a completely standard HD44780 derivative. The PSoC5 is completely capable of driving this, so I wired it up to a USB serial port. The computer‚Äôs now capable of displaying any text it likes on it. Admittedly, fifteen characters isn‚Äôt much, but it‚Äôs perfectly adequate for a word count. There‚Äôs so much spare flash and RAM on the microcontroller, actually, that I did have thoughts about adding a calculator or Forth interpreter, but luckily I got distracted by something else before that happened‚Ä¶</p><p><a class=link href=http://cowlark.com/2019-11-03-keyboard/lcd.jpg target=_blank rel=noopener><img src=http://cowlark.com/2019-11-03-keyboard/lcd.jpg loading=lazy></a></p><p>There were also rather fewer modifier keys than I was hoping for. The keyboard was arranged as a matrix probe affair, so that the microcontroller energies one probe line at a time and then checks the sense lines for a signal. These have problems with rollover. While they typically work fine for typing, modifier keys on such keyboards are typically wired directly to the keyboard controller so that they don‚Äôt count towards the rollover limit.</p><p>I wanted to use this for a PC keyboard, which comes with Control, Shift, Meta and Alt modifier keys as standard; plus, because the keyboard doesn‚Äôt have a navigation cluster, I wanted to add an extra modifier key as a layer switch to allow direct access to these. This required further modification to the PCB to remove these keys from the keyboard matrix and wire them directly to the PSoC5 board.</p><p><a class=link href=http://cowlark.com/2019-11-03-keyboard/closeup.jpg target=_blank rel=noopener><img src=http://cowlark.com/2019-11-03-keyboard/closeup.jpg loading=lazy></a></p><p>The end result is extremely nice, and I even managed to keep most of the paper feed mechanism (although I had to cut off the print head and motor assembly). With the lid closed, it looks just like it originally did, if you disregard the USB cable. Sadly, it‚Äôs not as comfortable to type on as I hoped. The layout‚Äôs not quite standard, missing a few important keys used for programming, which is what I do most; it‚Äôs also raised further than I‚Äôd like. I haven‚Äôt tried it with a wrist rest, though.</p><p>I recorded most of the work for posterity. If you‚Äôre into long, tedious workbench videos, enjoy! Or not, as you wish.</p><p>VIDEO VIDEO VIDEO VIDEO</p><p>from Hacker News <a class=link href=https://ift.tt/36D7NLV target=_blank rel=noopener>https://ift.tt/36D7NLV</a></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>