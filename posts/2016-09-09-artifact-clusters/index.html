<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Very often within the DFIR community, we see information shared (usually via blog posts) regarding a &amp;ldquo;new&amp;rdquo; artifact that has been recently unearthed, or simply being addressed for the first time.Â In some cases, the artifact is new to us, and in others, it may be the result of some new feature added to the Windows operating system or to an application.Â Sometimes when we see this new artifact discussed, a tool is shared to parse and make sense of the data afforded by that artifact."><title>Artifact Clusters</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-artifact-clusters/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="Artifact Clusters"><meta property="og:description" content="Very often within the DFIR community, we see information shared (usually via blog posts) regarding a &amp;ldquo;new&amp;rdquo; artifact that has been recently unearthed, or simply being addressed for the first time.Â In some cases, the artifact is new to us, and in others, it may be the result of some new feature added to the Windows operating system or to an application.Â Sometimes when we see this new artifact discussed, a tool is shared to parse and make sense of the data afforded by that artifact."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-artifact-clusters/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-12-04T02:54:00+01:00"><meta property="article:modified_time" content="2019-12-04T02:54:00+01:00"><meta name=twitter:title content="Artifact Clusters"><meta name=twitter:description content="Very often within the DFIR community, we see information shared (usually via blog posts) regarding a &amp;ldquo;new&amp;rdquo; artifact that has been recently unearthed, or simply being addressed for the first time.Â In some cases, the artifact is new to us, and in others, it may be the result of some new feature added to the Windows operating system or to an application.Â Sometimes when we see this new artifact discussed, a tool is shared to parse and make sense of the data afforded by that artifact."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ‡</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-artifact-clusters/>Artifact Clusters</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Dec 04, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p>Very often within the DFIR community, we see information shared (usually via blog posts) regarding a &ldquo;new&rdquo; artifact that has been recently unearthed, or simply being addressed for the first time.Â  In some cases, the artifact is new to us, and in others, it may be the result of some new feature added to the Windows operating system or to an application.Â  Sometimes when we see this new artifact discussed, a tool is shared to parse and make sense of the data afforded by that artifact.Â  In some cases, we may find that multiple tools are available for parsing the same artifact, which is great, because it shows interest and diversity in the approach to accessing and making use of the data.</p><p>However, what we <em>don&rsquo;t</em>Â often see is how that artifact relates to other artifacts from the same system.Â  Another way to look at it is, we don&rsquo;t often see how the tool, or more importantly, the data available in the source, can serve us to further an investigation. We may be left thinking, &ldquo;Great, there&rsquo;s this data source, and a tool that allows me to extract and make some sense of the data within it, but how do I <em>use</em> it as part of an investigation?&rdquo;</p><p><a class=link href=https://1.bp.blogspot.com/-D-LoDVQBe0E/XeEGE2Gz9bI/AAAAAAAACSA/PsfgvCSVUp8SEdw9vQ2S2QnlKqvqbsAcQCLcBGAsYHQ/s1600/iws.jpg target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-D-LoDVQBe0E/XeEGE2Gz9bI/AAAAAAAACSA/PsfgvCSVUp8SEdw9vQ2S2QnlKqvqbsAcQCLcBGAsYHQ/s200/iws.jpg loading=lazy></a><br>I shared an initial example of what this might look like recently inÂ <a class=link href=http://windowsir.blogspot.com/2019/11/activitescachedb-vs-ntuserdat.html target=_blank rel=noopener>a recent blog post</a>, and this was also the approach I took when I wrote about the investigations inÂ <em><a class=link href=https://www.amazon.com/Investigating-Windows-Systems-Harlan-Carvey/dp/0128114150 target=_blank rel=noopener>Investigating Windows Systems</a>.</em>Â I hadn&rsquo;t seen any books available that covered the topic of digital forensic <em>analysis</em>Â (as opposed to just parsing data) from an investigation-wide perspective, completing an investigation using multiple artifacts to &ldquo;tell the story&rdquo;.Â  The idea was (and still is) that a single artifact, or a single entry derived from a data source, does <em>NOT</em> tell the whole story of the investigation.Â  A single artifact may be a high fidelity indicator that provides a starting point for an investigation, but it does not tell the whole story. Rather than a single artifact, analysts should be looking at artifact clusters to provide the necessary context for an analyst to make a finding as to what happened.</p><p>Artifact clusters provide two things to the investigator; validation and context.Â  Artifact clusters provide validation by reinforcing that an event occurred, or that the user took some action.Â  That validation may be a duplicate event; in <a class=link href=http://windowsir.blogspot.com/2019/11/activitescachedb-vs-ntuserdat.html target=_blank rel=noopener>my previous blog post</a>, we see the following events in our timeline:</p><p>Wed Nov 20 20:09:28 2019 Z<br>Â  TIMELINEÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â - Start Time:Program Files x86\Microsoft Office\Office14\WINWORD.EXEÂ <br>Â  REGÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  - [Program Execution] UserAssist - {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\Microsoft Office\Office14\WINWORD.EXE (5)</p><p>What we see here (above) are duplicate events that provide validation.Â  We see via the UserAssist data that the user launched WinWord.exe, and we also see validation from the user&rsquo;s Activity Timeline database.Â  Not only do we have validation, but we can also see what the artifact cluster should look like, and as such, have an understanding of what to look for in the face of anti-forensics efforts, be they intentional or the result of natural evidence decay.</p><p>In other instances, validation may come in the form of supporting events.Â  For example, again from my previous blog post, we see the following two events side-by-side in the timeline:</p><p>Wed Nov 20 22:50:02 2019 Z<br>Â  REGÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  - RegEdit LastKey value -> Computer\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\TaskFlow<br>Â  TIMELINEÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â - End Time:Windows\regedit.exeÂ </p><p>In this example, we see that the user closed the Registry Editor, and that the user&rsquo;s LastKey value was set, illustrating the key that was in focus when the Registry Editor was closed.Â  Rather than being duplicate events, these two events support each other.</p><p>Looking at different event sources during the same time period also helps us see the context of the events, as we get a better view of the overall artifact cluster.Â  For example, consider the above timeline entries that pertain to the Registry Editor.Â  With just the data from the Registry, we can see when the Registry Editor was closed, and the key that was in focus when it was closed.Â  But that&rsquo;s about all we know.Â </p><p>However, if we add some more of the events from the overall artifact cluster, we can see not just <em>when</em>, but <em>how</em> the Registry Editor was opened, as illustrated below:</p><p>Wed Nov 20 22:49:11 2019 Z<br>Â  TIMELINEÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â - Start Time:Windows\regedit.exeÂ </p><p>Wed Nov 20 22:49:07 2019 Z<br>Â  REGÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  - [Program Execution] UserAssist - {F38BF404-1D43-42F2-9305-67DE0B28FC23}\regedit.exe (1)<br>Â  REGÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  - [Program Execution] UserAssist - {0139D44E-6AFE-49F2-8690-3DAFCAE6FFB8}\Administrative Tools\Registry Editor.lnk (1)</p><p>From a more complete artifact cluster, we can see that the user had the Registry Editor open for approximately 51 seconds.Â  Information such as this can provide a great deal of context to an investigation.</p><p><em>Evidence Oxidation</em><br>Artifact clusters give us a view into the data in the face of anti-forensics, either as dedicated, intentional, targeted efforts to remove artifacts, or as natural evidence decay or oxidation.</p><p>Wait&mldr;what?Â  &ldquo;Evidence oxidation&rdquo;?Â  What is that?Â  IÂ <a class=link href=https://twitter.com/keydet89/status/1198232826585288705 target=_blank rel=noopener>shared some DFIR thoughts on Twitter</a>Â not long ago on this topic, and in short, what this refers to is the natural disappearance of items from artifact clusters due to the passage of time, as some of those artifacts are removed or overwritten as the system continues to function. This is markedly different from the purposeful removal of artifacts, such as Registry keys being specifically and intentionally modified or deleted.</p><p>This idea of &ldquo;evidence decay&rdquo; or &ldquo;evidence oxidation&rdquo; begins with theÂ <em>Order of Volatility</em>, which lists different artifacts based on their &ldquo;lifetime&rdquo;; that is to say that different artifactsÂ <em>age out</em>Â orÂ <em>expire</em>Â at different rates.Â  For example, a process executed in memory will complete (often with seconds, or sooner) and the memory used by that process will be freed for use by another process in fairly short order.Â  That process may result in the operating system or application generating an entry into a log file, which itself mayÂ roll overÂ or be overwritten at various rates (i.e., the entry itself is overwritten as newer entries are added), depending upon the logging mechanism.Â  Or, a file may be created within the file system that exists until someone&mldr;a person&mldr;purposefully deletes it.Â  Even then, the contents of the file may exist (NTFS resident file, etc.) for a time after the file is marked as &ldquo;not in use&rdquo;, something that may be dependent upon the file system in use, the level of activity on the system, whether a backup mechanism (backup, Volume Shadow Copy, etc.) occurred between the file creation and deletion times, etc.</p><p>In short, some artifacts may have the life span of a snowflake, or a fruit fly, or a tortoise.Â  The life span of an artifact can depend upon a great deal; the operating system (and version) employed, the file system structure, the auditing infrastructure, the volume of usage of the system, etc.Â  Consider this&mldr;I was once looking at a USN Change Journal from an image acquired from a Windows 7 system, and the time span of the available data was maybe a day and a half.Â  Right around that time, a friend of mine contacted me about a Windows 2003 system he was examining, for which the USN Change Journal contained 90 days worth of data.</p><p>Windows systems can be very active, even when they appear to be sitting idle with no one actively typing at the keyboard.Â  The operating system itself may reach out for updates, during which files are downloaded, processes are executed, and files are deleted.Â  The same is true for a number of applications. Once a user becomes active on the system, the volume of activity and changes may increase dramatically.Â  I use several applications (Notepad++, UltraEdit, VirtualBox, etc.) that all reach out to the Internet to look for updates when they&rsquo;re launched.Â  Just surfing the web causes browser history to be generated and cached.</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>