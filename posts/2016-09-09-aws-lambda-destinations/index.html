<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Today we‚Äôre announcing AWS Lambda Destinations for asynchronous invocations. This is a feature that provides visibility into Lambda function invocations and routes the execution results to AWS services, simplifying event-driven applications and reducing code complexity.
Asynchronous invocations When a function is invoked asynchronously, Lambda sends the event to an internal queue. A separate process reads events from the queue and executes your Lambda function. When the event is added to the queue, Lambda previously only returned a 2xx status code to confirm that the queue has received this event."><title>AWS Lambda Destinations</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-aws-lambda-destinations/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="AWS Lambda Destinations"><meta property="og:description" content="Today we‚Äôre announcing AWS Lambda Destinations for asynchronous invocations. This is a feature that provides visibility into Lambda function invocations and routes the execution results to AWS services, simplifying event-driven applications and reducing code complexity.
Asynchronous invocations When a function is invoked asynchronously, Lambda sends the event to an internal queue. A separate process reads events from the queue and executes your Lambda function. When the event is added to the queue, Lambda previously only returned a 2xx status code to confirm that the queue has received this event."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-aws-lambda-destinations/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-11-26T03:04:00+01:00"><meta property="article:modified_time" content="2019-11-26T03:04:00+01:00"><meta name=twitter:title content="AWS Lambda Destinations"><meta name=twitter:description content="Today we‚Äôre announcing AWS Lambda Destinations for asynchronous invocations. This is a feature that provides visibility into Lambda function invocations and routes the execution results to AWS services, simplifying event-driven applications and reducing code complexity.
Asynchronous invocations When a function is invoked asynchronously, Lambda sends the event to an internal queue. A separate process reads events from the queue and executes your Lambda function. When the event is added to the queue, Lambda previously only returned a 2xx status code to confirm that the queue has received this event."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-aws-lambda-destinations/>AWS Lambda Destinations</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 26, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p>Today we‚Äôre announcing <a class=link href=https://aws.amazon.com/lambda/ target=_blank rel=noopener>AWS Lambda</a> Destinations for asynchronous invocations. This is a feature that provides visibility into Lambda function invocations and routes the execution results to AWS services, simplifying event-driven applications and reducing code complexity.</p><h2 id=asynchronous-invocations>Asynchronous invocations</h2><p>When a function is invoked asynchronously, Lambda sends the event to an <a class=link href=https://docs.aws.amazon.com/lambda/latest/dg/invocation-async.html target=_blank rel=noopener>internal queue</a>. A separate process reads events from the queue and executes your Lambda function. When the event is added to the queue, Lambda previously only returned a 2xx status code to confirm that the queue has received this event. There was no additional information to confirm whether the event had been processed successfully.</p><p>A common event-driven microservices architectural pattern is to use a queue or message bus for communication. This helps with resilience and scalability. Lambda asynchronous invocations can put an event or message on <a class=link href=https://aws.amazon.com/sns/ target=_blank rel=noopener>Amazon Simple Notification Service</a> (SNS), <a class=link href=https://aws.amazon.com/sqs/ target=_blank rel=noopener>Amazon Simple Queue Service</a> (SQS), or <a class=link href=https://aws.amazon.com/eventbridge/ target=_blank rel=noopener>Amazon EventBridge</a> for further processing. Previously, you needed to write the SQS/SNS/EventBridge handling code within your Lambda function and manage retries and failures yourself.</p><p>With Destinations, you can route asynchronous function results as an execution record to a destination resource without writing additional code. An execution record contains details about the request and response in JSON format including version, timestamp, request context, request payload, response context, and response payload. For each execution status such as <em>Success</em> or <em>Failure</em> you can choose one of four destinations: another Lambda function, SNS, SQS, or EventBridge. Lambda can also be configured to route different execution results to different destinations.</p><p><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations1.png loading=lazy alt="Asynchronous Function Execution Result"></p><h2 id=success>Success</h2><p>When a function is invoked successfully, Lambda routes the record to the destination resource for every successful invocation. You can use this to monitor the health of your serverless applications via execution status or build workflows based on the invocation result.</p><p>You no longer need to chain long-running Lambda functions together synchronously. Previously you needed to complete the entire workflow within the Lambda 15-minute function timeout, pay for idle time, and wait for a response. Destinations allows you to return a Success response to the calling function and then handle the remaining chaining functions asynchronously.</p><h2 id=failure>Failure</h2><p>Alongside today‚Äôs announcement of <a class=link href=https://aws.amazon.com/about-aws/whats-new/2019/11/aws-lambda-supports-max-retry-attempts-event-age-asynchronous-invocations/ target=_blank rel=noopener>Maximum Event Age and Maximum Retry Attempt for asynchronous invocations</a>, Destinations gives you the ability to handle the Failure of function invocations along with their Success. When a function invocation fails, such as when retries are exhausted or the event age has been exceeded (hitting its TTL), Destinations routes the record to the destination resource for every failed invocation for further investigation or processing.</p><p>Dead Letter Queues (DLQ) have been <a class=link href=https://aws.amazon.com/about-aws/whats-new/2016/12/aws-lambda-supports-dead-letter-queues/ target=_blank rel=noopener>available since 2016</a> and are a great way to handle asynchronous failure situations. Destinations provide more useful capabilities by passing additional function execution information, including code exception stack traces, to more destination services.</p><p>Destinations and DLQs can be used together and at the same time although Destinations should be considered a more preferred solution. If you already have DLQs set up, existing functionality does not change and Destinations does not replace existing DLQ configurations. If both Destinations and DLQ are used for Failure notifications, function invoke errors are sent to both DLQ and Destinations targets.</p><h2 id=how-to-configure-destinations>How to configure Destinations</h2><p>Adding Destinations is a straightforward process. This walkthrough uses the AWS Management Console but you can also use the <a class=link href=https://aws.amazon.com/cli/ target=_blank rel=noopener>AWS CLI</a>, <a class=link href=https://aws.amazon.com/serverless/sam/ target=_blank rel=noopener>AWS SAM</a>, <a class=link href=https://aws.amazon.com/cloudformation/ target=_blank rel=noopener>AWS CloudFormation</a>, or language-specific SDKs for Lambda.</p><ol><li><p>Open the Lambda console <a class=link href=https://console.aws.amazon.com/lambda/home#/functions target=_blank rel=noopener>Functions page</a>. Choose an existing Lambda function, or create a new one. In this example, I create a new Lambda function. Choose <strong>Create Function</strong>.</p></li><li><p>Enter a <em>Function name</em>, select¬†<strong>Node.js 12.x</strong> for¬†<em>Runtime</em>, and <em>Choose or create an execution role</em>. Ensure that your Lambda function execution role includes access to the destination resource.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations2.png loading=lazy alt="Basic information"></p></li><li><p>Choose <strong>Create function</strong>.</p></li><li><p>Within the <em>Function code</em> pane, paste the following Lambda function code. The code generates a function execution result of either <em>Success</em> or <em>Failure</em> depending on a JSON input (<code>"Success": true</code> or <code>"Success": false</code>).```
// Lambda Destinations tester, Success returns a json blob, Failure throws an error</p><p>exports.handler = function(event, context, callback) {<br>var event_received_at = new Date().toISOString();<br>console.log(&lsquo;Event received at: &rsquo; + event_received_at);<br>console.log(&lsquo;Received event:&rsquo;, JSON.stringify(event, null, 2));</p><p>if (event.Success) {<br>console.log(&ldquo;Success&rdquo;);<br>context.callbackWaitsForEmptyEventLoop = false;<br>callback(null);<br>} else {<br>console.log(&ldquo;Failure&rdquo;);<br>context.callbackWaitsForEmptyEventLoop = false;<br>callback(new Error(&ldquo;Failure from event, Success = false, I am failing!&rdquo;), &lsquo;Destination Function Error Thrown&rsquo;);<br>}<br>};</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback></code></pre></td></tr></table></div></div></li><li><p>Choose <strong>Save</strong>.</p></li><li><p>To configure Destinations, within the <em>Designer pane</em>, choose <strong>Add destination</strong>.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations3.png loading=lazy alt="Designer pane"></p></li><li><p>Select the <em>Source</em> as <strong>Asynchronous invocation</strong>. Select the <em>Condition</em> as <strong>On failure</strong> or <strong>On success</strong>, depending on your use case. In this example, I select¬†<strong>On Success</strong>.</p></li><li><p>Enter the <em>Amazon Resource Name (ARN)</em> for the <em>Destination SQS</em> queue, SNS topic, Lambda function, or EventBridge event bus. In this example, I use the ARN of an SNS topic I have already configured.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations4.png loading=lazy alt="Add destination"></p></li><li><p>Choose <strong>Save</strong>. The Destination is added to SNS for <strong>On Success</strong>.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations5.png loading=lazy alt=Designer></p></li><li><p>Add another Destination for <strong>Failure</strong> to Lambda. Within the Designer pane, choose <strong>Add destination</strong>.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations6.png loading=lazy alt="Add destination"></p></li><li><p>Select the <em>Source</em> as <strong>Asynchronous invocation</strong>, the <em>Condition</em> as <strong>On failure</strong> and Enter a <em>Destination</em> Lambda function ARN, then choose <strong>Save</strong>.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations7.png loading=lazy alt="Enter a Destination Lambda function ARN, and choose Save"></p></li><li><p>The Destination is added to Lambda for <strong>On Failure</strong>.<br><img src=https://d2908q01vomqb2.cloudfront.net/1b6453892473a467d07372d45eb05abc2031647a/2019/11/25/lambda-destinations8.png loading=lazy alt="7. The Destination has been added to Lambda for On Failure."></p></li></ol><h3 id=success-testing>Success testing</h3><p>To test invoking the asynchronous Lambda function to generate a Success result, use the AWS CLI:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>aws lambda invoke --function-name event-destinations --invocation-type Event --payload &#39;{ &#34;Success&#34;: true }&#39; response.json
</span></span></code></pre></td></tr></table></div></div><p>The Lambda function is invoked successfully with a response¬†<code>"StatusCode": 202</code>.</p><p>And an SNS notification email is received, showing the invocation details with <code>"condition":"Success"</code> and the <code>requestPayload</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{  
</span></span><span class=line><span class=cl> &#34;version&#34;: &#34;1.0&#34;,  
</span></span><span class=line><span class=cl> &#34;timestamp&#34;: &#34;2019-11-24T23:08:25.651Z&#34;,  
</span></span><span class=line><span class=cl> &#34;requestContext&#34;: {  
</span></span><span class=line><span class=cl> &#34;requestId&#34;: &#34;c2a6f2ae-7dbb-4d22-8782-d0485c9877e2&#34;,  
</span></span><span class=line><span class=cl> &#34;functionArn&#34;: &#34;arn:aws:lambda:sa-east-1:123456789123:function:event-destinations:$LATEST&#34;,  
</span></span><span class=line><span class=cl> &#34;condition&#34;: &#34;Success&#34;,  
</span></span><span class=line><span class=cl> &#34;approximateInvokeCount&#34;: 1  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;requestPayload&#34;: {  
</span></span><span class=line><span class=cl> &#34;Success&#34;: true  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;responseContext&#34;: {  
</span></span><span class=line><span class=cl> &#34;statusCode&#34;: 200,  
</span></span><span class=line><span class=cl> &#34;executedVersion&#34;: &#34;$LATEST&#34;  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;responsePayload&#34;: null  
</span></span><span class=line><span class=cl> }
</span></span></code></pre></td></tr></table></div></div><h3 id=failure-testing>Failure testing</h3><p>The Lambda function can be set to <em>Failure</em> by throwing an exception within the code. To test invoking the asynchronous Lambda function to generate a Failure result, use the AWS CLI:</p><p><code>aws lambda invoke --function-name event-destinations --invocation-type Event --payload '{ "Success": false }' response.json</code></p><p>The Lambda function is executed and reports a successful invoke on the Lambda processing queue. If Lambda is not able to add the event to the queue, the error message appears in the command output.</p><p>However, due to the exception error within the code, the function invocation will fail. Destinations then routes the invoke failure to the configured destination Lambda function. You can see the failed function invocation information in the <a class=link href=https://aws.amazon.com/cloudwatch/ target=_blank rel=noopener>Amazon CloudWatch Logs</a> for the Destination function including <code>"condition": "RetriesExhausted"</code>, along with the <code>requestPayload</code>, <code>errorMessage</code>, and <code>stackTrace</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2019-11-24T21:52:47.855Z d123456-c0dd-4871-a123-a356cb1b3ba6 EVENT  
</span></span><span class=line><span class=cl> {  
</span></span><span class=line><span class=cl> &#34;version&#34;: &#34;1.0&#34;,  
</span></span><span class=line><span class=cl> &#34;timestamp&#34;: &#34;2019-11-24T21:52:47.333Z&#34;,  
</span></span><span class=line><span class=cl> &#34;requestContext&#34;: {  
</span></span><span class=line><span class=cl> &#34;requestId&#34;: &#34;8ea123e4-1db7-4aca-ad10-d9ca1234c1fd&#34;,  
</span></span><span class=line><span class=cl> &#34;functionArn&#34;: &#34;arn:aws:lambda:sa-east-1:123456678912:function:event-destinations:$LATEST&#34;,  
</span></span><span class=line><span class=cl> &#34;condition&#34;: &#34;RetriesExhausted&#34;,  
</span></span><span class=line><span class=cl> &#34;approximateInvokeCount&#34;: 3  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;requestPayload&#34;: {  
</span></span><span class=line><span class=cl> &#34;Success&#34;: false  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;responseContext&#34;: {  
</span></span><span class=line><span class=cl> &#34;statusCode&#34;: 200,  
</span></span><span class=line><span class=cl> &#34;executedVersion&#34;: &#34;$LATEST&#34;,  
</span></span><span class=line><span class=cl> &#34;functionError&#34;: &#34;Handled&#34;  
</span></span><span class=line><span class=cl> },  
</span></span><span class=line><span class=cl> &#34;responsePayload&#34;: {  
</span></span><span class=line><span class=cl> &#34;errorMessage&#34;: &#34;Failure from event, Success = false, I am failing!&#34;,  
</span></span><span class=line><span class=cl> &#34;errorType&#34;: &#34;Error&#34;,  
</span></span><span class=line><span class=cl> &#34;stackTrace&#34;: [ &#34;exports.handler (/var/task/index.js:18:18)&#34; ]  
</span></span><span class=line><span class=cl> }  
</span></span><span class=line><span class=cl> } 
</span></span></code></pre></td></tr></table></div></div><h3 id=destination-specific-json-format>Destination-specific JSON format</h3><ul><li>For SNS/SQS, the JSON object is passed as the <code>Message</code> to the destination.</li><li>For Lambda, the JSON is passed as the payload to the function. The destination function cannot be the same as the source function. For example, if LambdaA has a Destination configuration attached for Success, LambdaA is not a valid destination ARN. This prevents recursive functions.</li><li>For EventBridge, the JSON is passed as the <code>Detail</code> in the PutEvents call. The source is <code>lambda</code>, and detail type is either <code>Lambda Function Invocation Result - Success</code> or <code>Lambda Function Invocation Result ‚Äì Failure</code>. The resource fields contain the function and destination ARNs.</li></ul><h3 id=aws-cloudformation-configuration>AWS CloudFormation configuration</h3><p>Destinations CloudFormation configuration is created via the following YAML.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Resources:   
</span></span><span class=line><span class=cl> EventInvokeConfig:  
</span></span><span class=line><span class=cl> Type: AWS::Lambda::EventInvokeConfig  
</span></span><span class=line><span class=cl> Properties:  
</span></span><span class=line><span class=cl> FunctionName: ‚ÄúYourLambdaFunctionWithEventInvokeConfig‚Äù  
</span></span><span class=line><span class=cl> Qualifier: &#34;$LATEST&#34;  
</span></span><span class=line><span class=cl> MaximumEventAgeInSeconds: 600  
</span></span><span class=line><span class=cl> MaximumRetryAttempts: 0  
</span></span><span class=line><span class=cl> DestinationConfig:  
</span></span><span class=line><span class=cl> OnSuccess:  
</span></span><span class=line><span class=cl> Destination: ‚Äúarn:aws:sns:us-east-1:123456789012:YourSNSTopicOnSuccess‚Äù  
</span></span><span class=line><span class=cl> OnFailure:  
</span></span><span class=line><span class=cl> Destination: ‚Äúarn:aws:lambda:us-east-1:123456789012:function:YourLambdaFunctionOnFailure‚Äù 
</span></span></code></pre></td></tr></table></div></div><h2 id=conclusion>Conclusion</h2><p>AWS Lambda Destinations gives you more visibility and control of function execution results. This helps you build better event-driven applications, reducing code, and using Lambda‚Äôs native failure handling controls.</p><p>There are no additional costs for enabling Lambda Destinations. However, calls made to destination target services may be charged.</p><p>To learn more, see <a class=link href=https://docs.aws.amazon.com/lambda/latest/dg/invocation-async.html target=_blank rel=noopener>Lambda Destinations</a> in the <a class=link href=https://docs.aws.amazon.com/en_pv/lambda/latest/dg/welcome.html target=_blank rel=noopener>AWS Lambda Developer Guide</a>.</p><p>from Hacker News <a class=link href=https://ift.tt/2ONjI1i target=_blank rel=noopener>https://ift.tt/2ONjI1i</a></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#asynchronous-invocations>Asynchronous invocations</a></li><li><a href=#success>Success</a></li><li><a href=#failure>Failure</a></li><li><a href=#how-to-configure-destinations>How to configure Destinations</a><ol><li><a href=#success-testing>Success testing</a></li><li><a href=#failure-testing>Failure testing</a></li><li><a href=#destination-specific-json-format>Destination-specific JSON format</a></li><li><a href=#aws-cloudformation-configuration>AWS CloudFormation configuration</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>