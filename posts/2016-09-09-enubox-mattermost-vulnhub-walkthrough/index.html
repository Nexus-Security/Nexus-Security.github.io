<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this article, we are going to crack the EnuBox: Mattermost Boot to Root Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to Avraham Cohen. Download this lab by clicking here.
Penetration Testing Methodology Network Scanning Netdiscover Scan Nmap Scan Enumeration Browsing HTTP Service Enumerating TFTP Service Enumerating Zoom Plugin in CMS Enumerating FTP Service Exploitation Connection via SSH Enumerating secret binary Post Exploitation Downloading the secret binary Privilege Escalation Decompiling using Ghidra Extracting the secret key Getting the root session Reading Root Flag Walkthrough Network Scanning We downloaded, imported and ran the virtual machine (."><title>EnuBox: Mattermost: Vulnhub Walkthrough</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-enubox-mattermost-vulnhub-walkthrough/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="EnuBox: Mattermost: Vulnhub Walkthrough"><meta property="og:description" content="In this article, we are going to crack the EnuBox: Mattermost Boot to Root Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to Avraham Cohen. Download this lab by clicking here.
Penetration Testing Methodology Network Scanning Netdiscover Scan Nmap Scan Enumeration Browsing HTTP Service Enumerating TFTP Service Enumerating Zoom Plugin in CMS Enumerating FTP Service Exploitation Connection via SSH Enumerating secret binary Post Exploitation Downloading the secret binary Privilege Escalation Decompiling using Ghidra Extracting the secret key Getting the root session Reading Root Flag Walkthrough Network Scanning We downloaded, imported and ran the virtual machine (."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-enubox-mattermost-vulnhub-walkthrough/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2020-02-01T17:46:00+01:00"><meta property="article:modified_time" content="2020-02-01T17:46:00+01:00"><meta name=twitter:title content="EnuBox: Mattermost: Vulnhub Walkthrough"><meta name=twitter:description content="In this article, we are going to crack the EnuBox: Mattermost Boot to Root Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to Avraham Cohen. Download this lab by clicking here.
Penetration Testing Methodology Network Scanning Netdiscover Scan Nmap Scan Enumeration Browsing HTTP Service Enumerating TFTP Service Enumerating Zoom Plugin in CMS Enumerating FTP Service Exploitation Connection via SSH Enumerating secret binary Post Exploitation Downloading the secret binary Privilege Escalation Decompiling using Ghidra Extracting the secret key Getting the root session Reading Root Flag Walkthrough Network Scanning We downloaded, imported and ran the virtual machine (."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-enubox-mattermost-vulnhub-walkthrough/>EnuBox: Mattermost: Vulnhub Walkthrough</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Feb 01, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p>In this article, we are going to crack the EnuBox: Mattermost Boot to Root Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to Avraham Cohen. Download this lab by clicking <a class=link href=https://www.vulnhub.com/entry/enubox-mattermost,414/ target=_blank rel=noopener>here</a>.</p><h3 id=penetration-testing-methodology><strong>Penetration Testing Methodology</strong></h3><ul><li><strong>Network Scanning</strong><ul><li>Netdiscover Scan</li><li>Nmap Scan</li></ul></li><li><strong>Enumeration</strong><ul><li>Browsing HTTP Service</li><li>Enumerating TFTP Service</li><li>Enumerating Zoom Plugin in CMS</li><li>Enumerating FTP Service</li></ul></li><li><strong>Exploitation</strong><ul><li>Connection via SSH</li><li>Enumerating secret binary</li></ul></li><li><strong>Post Exploitation</strong><ul><li>Downloading the secret binary</li></ul></li><li><strong>Privilege Escalation</strong><ul><li>Decompiling using Ghidra</li><li>Extracting the secret key</li><li>Getting the root session</li></ul></li><li><strong>Reading Root Flag</strong></li></ul><h3 id=walkthrough><strong>Walkthrough</strong></h3><h3 id=network-scanning><strong>Network Scanning</strong></h3><p>We downloaded, imported and ran the virtual machine (.ova file) on the VMWare Workstation, the machine will automatically be assigned an IP address from the network DHCP. To begin we will find the IP address of our target machine, for that use the following command as it helps to see all the IP‚Äôs in an internal network:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>netdiscover
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i1.wp.com/1.bp.blogspot.com/-W7LF_yPCuew/XjWjwSvP6FI/AAAAAAAAik4/Z2ZqsK3uuZUOuwFXnmGVaBxMiUXiwdN2wCLcBGAsYHQ/s1600/1.png?w=687&ssl=1" loading=lazy></p><p>We found the target‚Äôs IP Address 192.168.1.8. The next step is to scan the target machine by using the Nmap tool. This is to find the open ports and services on the target machine and will help us to proceed further</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmap -sT -sU -A 192.168.0.110
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i0.wp.com/1.bp.blogspot.com/-FCrIUWk54e0/XjWjzqNxy1I/AAAAAAAAilg/h0eE8bW4_UQ5fk6q3PO8cnWwuIXysGdggCLcBGAsYHQ/s1600/2.png?w=687&ssl=1" loading=lazy></p><p>Here, we performed a nmap scan with TCP and UDP parameters. After the scan, we saw that port 22,80, 3389, 68, 69, 631, 5353. From the scan we have the FTP (21) service, SSH (22) Service, HTTP (80), DHCPC (68) service, TFTP (69) service, and some other services. This was the lay of the land. Now let‚Äôs get to enumeration.</p><h3 id=enumeration><strong>Enumeration</strong></h3><p>We started from port 80 and tried to browse the webpage on our browser. We have the classic Access Forbidden Banner. Although this is a custom error page but some sensitive information disclosure is active here. We see that through the error, there is the Server OS Version Disclosure. We also have the name of a probably sensitive file named README.md. Let‚Äôs take a note these might be useful down the lane.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://192.168.0.110
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i2.wp.com/1.bp.blogspot.com/-vAn88LOTcHY/XjWjz3_wm3I/AAAAAAAAilk/vJc3N-vNfx0VkA7408MnQ3jWMYEi4ROXgCLcBGAsYHQ/s1600/3.png?w=687&ssl=1" loading=lazy></p><p>Now moving on, we also got another page hosted on the port 8065. Let‚Äôs take a look at that. We see that we have a login panel. So, this is probably our way in to the CMS.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://192.168.0.110:8065/login
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i1.wp.com/1.bp.blogspot.com/-vU4SvHP-AE0/XjWjz4A-e6I/AAAAAAAAilo/x6KqpP1YpiAmK2XjvX9N7VjYccRiVhh8QCLcBGAsYHQ/s1600/4.png?w=687&ssl=1" loading=lazy></p><p>From the Nmap scan we see that we have the TFTP service running on the Target Machine. Let‚Äôs take a look onto that. As Anonymous Login was enabled, no credentials were asked. In the earlier stage we know that there is a sensitive file named ‚ÄúREADME.md‚Äù. We tried to download this file from this TFTP Server. Our download was successful. After downloading the file, we read the file contents to find the Username and Password.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>tftp 192.168.0.110  
</span></span><span class=line><span class=cl>get README.md  
</span></span><span class=line><span class=cl>quit  
</span></span><span class=line><span class=cl>cat README.md
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i0.wp.com/1.bp.blogspot.com/-MK9fH5OUfpU/XjWj0T9N9uI/AAAAAAAAils/-p56cDIdXGU_2Y2tX4NhBRdSIyji1mMPwCLcBGAsYHQ/s1600/5.png?w=687&ssl=1" loading=lazy></p><p>We went back to the Login Panel that we found earlier and entered the following credentials.</p><p><strong>Username: admin</strong></p><p><strong>Password: ComplexPassword0!</strong></p><p><img src="https://i2.wp.com/1.bp.blogspot.com/-236IwDtczmk/XjWj1ChNDgI/AAAAAAAAil0/YxCkxAoGpHQTvsNyboTNLZYjfagE4LVeACLcBGAsYHQ/s1600/6.png?w=687&ssl=1" loading=lazy></p><p>After logging in the application, we see that there are bunch of posts on the main page. On reading those posts we see that there was different version of the word ‚Äúzoom‚Äù word used. It was quite peculiar the way it was used. Like ‚ÄúLet‚Äôs zoom‚Äù, ‚ÄúZoom me‚Äù. It was very similar to the terminology that we commonly use with the word ‚Äútext/chat‚Äù. Like ‚ÄúLet‚Äôs Text‚Äù, ‚ÄúText me‚Äù. This gave us some idea that this was some kind of messaging module. Now from the look of the CMS, it was clear that the CMS uses the plugin methods to add or remove functionalities. So we set on the mission to find the plugin by the name ‚Äúzoom‚Äù.</p><p><img src="https://i2.wp.com/1.bp.blogspot.com/-UmmffM61XS4/XjWj1FjqTeI/AAAAAAAAilw/xY-JdwIK9hULWvN7RfhNrBBaxhAwSTkBQCLcBGAsYHQ/s1600/7.png?w=687&ssl=1" loading=lazy></p><p>To edit some plugins, we move to the panel with the Username on the left side. We click on the Menu button; it gave us the dropdown menu. Among a bunch of other options, we have the ‚ÄúSystem Console‚Äù Option. It‚Äôs worth checking out.</p><p><img src="https://i0.wp.com/1.bp.blogspot.com/-XK1qk8PcSDU/XjWj1Tf3LfI/AAAAAAAAil4/hNU4O3hXdJojLfAP4pxYHZpK5GxcRhyBwCLcBGAsYHQ/s1600/8.png?w=687&ssl=1" loading=lazy></p><p>Now we have the System Console, we found of bunch of option, but my search was focused on finding the Plugins panel. Here under the System Console Panel we have the Plugin Option in the System Console Panel. In the plugin panel we have the Zoom Plugin. ¬†</p><p><img src="https://i1.wp.com/1.bp.blogspot.com/-2hg3wlaA4nc/XjWj14aSv7I/AAAAAAAAil8/n7_fkO7AEZwj05yidYR81gm2OIjSeBcegCLcBGAsYHQ/s1600/9.png?w=687&ssl=1" loading=lazy></p><p>Clicking on the Zoom Plugin button which will open a plugin config page. The plugin was disabled by default. As we are the admin, so we have the authority for to enable to the plugin. After enabling, we see that we have ourselves an URL for the plugin. As it says localhost because the application is configured server-side. We change the localhost to the IP Address of the Machine.</p><p><img src="https://i2.wp.com/1.bp.blogspot.com/--WupXK8PQ2M/XjWjwhz7h_I/AAAAAAAAilA/XI2pwGzAYaUG3_f6EVJ5zXjQVitUFuzsgCLcBGAsYHQ/s1600/10.png?w=687&ssl=1" loading=lazy></p><p>After making appropriate changes in the URL, we browse that link to see that we have a message. It says that FTP credentials help the admin, edit and manage the files. This gives us the FTP Credentials:</p><p><strong>Username: ftpuser</strong></p><p><strong>Password: ftppassword</strong></p><p><img src="https://i1.wp.com/1.bp.blogspot.com/-A26lAh3-PLo/XjWjwq3peXI/AAAAAAAAik8/ZKg4e3GcuoYmJtDkQpyKA5BTd3np67CrwCLcBGAsYHQ/s1600/11.png?w=687&ssl=1" loading=lazy></p><p>Let‚Äôs login in the machine using these FTP Credentials. We use the dir command to list all the files inside the machine. We do some enumeration to find a file named message.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ftp 192.168.0.110  
</span></span><span class=line><span class=cl>ftpuser  
</span></span><span class=line><span class=cl>ftppassword  
</span></span><span class=line><span class=cl>dir  
</span></span><span class=line><span class=cl>cd users  
</span></span><span class=line><span class=cl>dir  
</span></span><span class=line><span class=cl>cd mattermost  
</span></span><span class=line><span class=cl>dir  
</span></span><span class=line><span class=cl>get message  
</span></span><span class=line><span class=cl>bye
</span></span></code></pre></td></tr></table></div></div><h3 id=httpsi2wpcom1bpblogspotcom-vc1l0m5ckvexjwjxiisxbiaaaaaaaailextgweiz6v3s2ucm6ewdgdehwrtpqxkapqclcbgasyhqs160012pngw687ssl1><img src="https://i2.wp.com/1.bp.blogspot.com/-vc1l0M5CKvE/XjWjxiISXbI/AAAAAAAAilE/XtgwEIz6V3s2UCm6ewDgDehWRTpQXkapQCLcBGAsYHQ/s1600/12.png?w=687&ssl=1" loading=lazy></h3><h3 id=exploitation><strong>Exploitation</strong></h3><p>Let‚Äôs take a look at the message file from the FTP server. It says <strong>‚ÄúWelcome!!‚Äù.</strong></p><p>After thinking and tinkering with the application we figured out that the password for the SSH user is the text that was inside the message file. We SSHed¬† in to the machine using the following credentials. After successful login, we start enumeration process by listing the directories. We see that we have a README.md file and a binary named secret. We view the README file to find that the there is a secret key which is used to traverse further. We ran the secret binary, it asked for the secret key. We entered the key which we found inside the README file. But we are shown an error that the key is expired.</p><p><strong>Username: mattermost</strong></p><p><strong>Password: Welcome!!</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cat message  
</span></span><span class=line><span class=cl>ssh mattermost@192.168.0.110  
</span></span><span class=line><span class=cl>ls  
</span></span><span class=line><span class=cl>cd Desktop/  
</span></span><span class=line><span class=cl>ls  
</span></span><span class=line><span class=cl>cat README.md  
</span></span><span class=line><span class=cl>./secret
</span></span></code></pre></td></tr></table></div></div><h3 id=httpsi0wpcom1bpblogspotcom-coag9nu6pikxjwjx5hijwiaaaaaaaailmbmf6kb8g6e0cf7y2hg0w_pr_feuq1ggbgclcbgasyhqs160013pngw687ssl1><img src="https://i0.wp.com/1.bp.blogspot.com/-cOAg9NU6PIk/XjWjx5HijWI/AAAAAAAAilM/BMf6KB8g6e0CF7y2HG0W_PR_feuq1ggbgCLcBGAsYHQ/s1600/13.png?w=687&ssl=1" loading=lazy></h3><h3 id=post-exploitation><strong>Post Exploitation</strong></h3><p>¬†We thought we have to reverse engineer the secret script to get ourselves a key. To do that we download the file to our system using the PHP server script.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pwd  
</span></span><span class=line><span class=cl>php -S 0.0.0.0:8080
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i0.wp.com/1.bp.blogspot.com/-AJSJNUEseoU/XjWjxxIfJeI/AAAAAAAAilI/Rq2jWPfZj64tVmVjE0iAj5uJNBn7C-M5QCLcBGAsYHQ/s1600/14.png?w=687&ssl=1" loading=lazy></p><p>After hosting the file on the server, we download it onto out attacker machine using the wget command.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>wget http://192.168.0.110:8080/secret  
</span></span><span class=line><span class=cl>ls
</span></span></code></pre></td></tr></table></div></div><h3 id=httpsi1wpcom1bpblogspotcom-3aqme9y61loxjwjycua4wiaaaaaaaailqostek_-62ywumlrtlz68x64wsxdfujgdaclcbgasyhqs160015pngw687ssl1><img src="https://i1.wp.com/1.bp.blogspot.com/-3aqmE9y61Lo/XjWjycuA4WI/AAAAAAAAilQ/osteK_-62ywUmLRtlZ68x64WSxDFUJgdACLcBGAsYHQ/s1600/15.png?w=687&ssl=1" loading=lazy></h3><h3 id=privilege-escalation><strong>Privilege Escalation</strong></h3><p>Now we used the Ghidra to Decompile the code and see the value of the variable that is compared the value of the secret key. We see that whatever the value we enter for the secret key is compared to 0xf447. Now all we need is to find the decimal equivalent of the number.</p><p><img src="https://i2.wp.com/1.bp.blogspot.com/-jAl2bRklvJI/XjWjyl9BXaI/AAAAAAAAilU/ueynqhi8gt0O7P-PhiSZsw2QpSly9XiogCLcBGAsYHQ/s1600/16.png?w=687&ssl=1" loading=lazy></p><p>We used the echo command to convert the value we found inside the secret binary into a decimal value. We have the value of the secret key: ‚Äú<strong>62535</strong>‚Äù</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>echo $((0xf447))
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i2.wp.com/1.bp.blogspot.com/-yWGbf80vHT0/XjWjyk5jzPI/AAAAAAAAilY/3vv22l6adEY9Wt3AFvYL4kSYDgvyZ_GXACLcBGAsYHQ/s1600/17.png?w=687&ssl=1" loading=lazy></p><p>Now that we have the value of the secret key, we went back to our SSH Session and ran the secret binary. We entered the value and the shell gets elevated to root privileges.</p><h3 id=reading-the-flag><strong>Reading the Flag</strong></h3><p>We enumerated the Desktop of the root user and found a text file named local.txt. Upon opening we see that it is the final flag of this machine.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./secret  
</span></span><span class=line><span class=cl>62535  
</span></span><span class=line><span class=cl>whoami  
</span></span><span class=line><span class=cl>cd /root/Desktop  
</span></span><span class=line><span class=cl>cat local.txt
</span></span></code></pre></td></tr></table></div></div><p><img src="https://i2.wp.com/1.bp.blogspot.com/-Q983mzy_3Hs/XjWjy3kfuXI/AAAAAAAAilc/p2v0EUQYcKkkC5aYxmUzhkiwF-v14i9iQCLcBGAsYHQ/s1600/18.png?w=687&ssl=1" loading=lazy></p><p>This concludes the lab. A huge shout out to the lab author for creating this lab. From the look of it, the lab must have taken some effort and time. I would like to thank the author for investing his/her resources for my learning.</p><p><strong>Author: Pavandeep Singh</strong>¬†is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on¬†<a class=link href=https://twitter.com/pavan2318 target=_blank rel=noopener>Twitter</a>¬†and¬†<a class=link href=https://www.linkedin.com/in/pavandeep-singh-6b1074132 target=_blank rel=noopener>LinkedIn</a></p><p>The post <a class=link href=https://www.hackingarticles.in/enubox-mattermost-vulnhub-walkthrough/ target=_blank rel=noopener>EnuBox: Mattermost: Vulnhub Walkthrough</a> appeared first on <a class=link href=https://www.hackingarticles.in target=_blank rel=noopener>Hacking Articles</a>.</p><p>from Hacking Articles <a class=link href=https://ift.tt/2GOaazq target=_blank rel=noopener>https://ift.tt/2GOaazq</a></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#penetration-testing-methodology><strong>Penetration Testing Methodology</strong></a></li><li><a href=#walkthrough><strong>Walkthrough</strong></a></li><li><a href=#network-scanning><strong>Network Scanning</strong></a></li><li><a href=#enumeration><strong>Enumeration</strong></a></li><li><a href=#httpsi2wpcom1bpblogspotcom-vc1l0m5ckvexjwjxiisxbiaaaaaaaailextgweiz6v3s2ucm6ewdgdehwrtpqxkapqclcbgasyhqs160012pngw687ssl1><img src="https://i2.wp.com/1.bp.blogspot.com/-vc1l0M5CKvE/XjWjxiISXbI/AAAAAAAAilE/XtgwEIz6V3s2UCm6ewDgDehWRTpQXkapQCLcBGAsYHQ/s1600/12.png?w=687&ssl=1" alt></a></li><li><a href=#exploitation><strong>Exploitation</strong></a></li><li><a href=#httpsi0wpcom1bpblogspotcom-coag9nu6pikxjwjx5hijwiaaaaaaaailmbmf6kb8g6e0cf7y2hg0w_pr_feuq1ggbgclcbgasyhqs160013pngw687ssl1><img src="https://i0.wp.com/1.bp.blogspot.com/-cOAg9NU6PIk/XjWjx5HijWI/AAAAAAAAilM/BMf6KB8g6e0CF7y2HG0W_PR_feuq1ggbgCLcBGAsYHQ/s1600/13.png?w=687&ssl=1" alt></a></li><li><a href=#post-exploitation><strong>Post Exploitation</strong></a></li><li><a href=#httpsi1wpcom1bpblogspotcom-3aqme9y61loxjwjycua4wiaaaaaaaailqostek_-62ywumlrtlz68x64wsxdfujgdaclcbgasyhqs160015pngw687ssl1><img src="https://i1.wp.com/1.bp.blogspot.com/-3aqmE9y61Lo/XjWjycuA4WI/AAAAAAAAilQ/osteK_-62ywUmLRtlZ68x64WSxDFUJgdACLcBGAsYHQ/s1600/15.png?w=687&ssl=1" alt></a></li><li><a href=#privilege-escalation><strong>Privilege Escalation</strong></a></li><li><a href=#reading-the-flag><strong>Reading the Flag</strong></a></li></ol></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>