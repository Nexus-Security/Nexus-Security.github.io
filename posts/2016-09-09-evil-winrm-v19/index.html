<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kang Asu
Evil-Winrm v1.9 - The Ultimate WinRM Shell For Hacking/Pentestin****g
This shell is the ultimate WinRM shell for hacking/pentesting.
WinRM (Windows Remote Management) is the Microsoft implementation of WS-Management Protocol. A standard SOAP based protocol that allows hardware and operating systems from different vendors to interoperate. Microsoft included it in their Operating Systems in order to make life easier to system administrators.
This program can be used on any Microsoft Windows Servers with this feature enabled (usually at port 5985), of course only if you havecredentialsand permissions to use it."><title>Evil-Winrm v1.9</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-evil-winrm-v19/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="Evil-Winrm v1.9"><meta property="og:description" content="Kang Asu
Evil-Winrm v1.9 - The Ultimate WinRM Shell For Hacking/Pentestin****g
This shell is the ultimate WinRM shell for hacking/pentesting.
WinRM (Windows Remote Management) is the Microsoft implementation of WS-Management Protocol. A standard SOAP based protocol that allows hardware and operating systems from different vendors to interoperate. Microsoft included it in their Operating Systems in order to make life easier to system administrators.
This program can be used on any Microsoft Windows Servers with this feature enabled (usually at port 5985), of course only if you havecredentialsand permissions to use it."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-evil-winrm-v19/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-11-28T22:45:00+01:00"><meta property="article:modified_time" content="2019-11-28T22:45:00+01:00"><meta name=twitter:title content="Evil-Winrm v1.9"><meta name=twitter:description content="Kang Asu
Evil-Winrm v1.9 - The Ultimate WinRM Shell For Hacking/Pentestin****g
This shell is the ultimate WinRM shell for hacking/pentesting.
WinRM (Windows Remote Management) is the Microsoft implementation of WS-Management Protocol. A standard SOAP based protocol that allows hardware and operating systems from different vendors to interoperate. Microsoft included it in their Operating Systems in order to make life easier to system administrators.
This program can be used on any Microsoft Windows Servers with this feature enabled (usually at port 5985), of course only if you havecredentialsand permissions to use it."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-evil-winrm-v19/>Evil-Winrm v1.9</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 28, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p><strong>Kang Asu</strong></p><p><a class=link href=https://1.bp.blogspot.com/-sqwGtmbtQH4/XcysUtlD8OI/AAAAAAAAQ0Y/TnHZ1VADETAt84s5YKS0PF3mJJOh4KC7gCNcBGAsYHQ/s1600/evil-winrm_5_evil-winrm_logo.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-sqwGtmbtQH4/XcysUtlD8OI/AAAAAAAAQ0Y/TnHZ1VADETAt84s5YKS0PF3mJJOh4KC7gCNcBGAsYHQ/s640/evil-winrm_5_evil-winrm_logo.png loading=lazy></a></p><p><strong>Evil-Winrm v1.9 - The Ultimate WinRM Shell For Hacking/Pentestin****g</strong></p><p>This shell is the ultimate WinRM shell for hacking/pentesting.</p><p>WinRM (Windows Remote Management) is the Microsoft implementation of WS-Management Protocol. A standard SOAP based protocol that allows hardware and operating systems from different vendors to interoperate. Microsoft included it in their Operating Systems in order to make life easier to system administrators.</p><p>This program can be used on any Microsoft Windows Servers with this feature enabled (usually at port 5985), of course only if you have<a class=link href=https://www.kitploit.com/search/label/Credentials title=credentials target=_blank rel=noopener>credentials</a>and permissions to use it. So we can say that it could be used in a<a class=link href=https://www.kitploit.com/search/label/Post-Exploitation title=post-exploitation target=_blank rel=noopener>post-exploitation</a>hacking/pentesting phase. The purpose of this program is to provide nice and easy-to-use features for hacking. It can be used with legitimate purposes by system administrators as well but the most of its features are focused on hacking/pentesting stuff.</p><p>[</p><p>](<a class=link href=https://www.blogger.com/u/1/null target=_blank rel=noopener>https://www.blogger.com/u/1/null</a>)<br><strong>Features</strong></p><ul><li>Load in memory Powershell scripts</li><li>Load in memory dll files bypassing some AVs</li><li>Load in memory C# (C Sharp) assemblies bypassing some AVs</li><li>Load x64 payloads generated with awesome<a class=link href=https://github.com/TheWover/donut title=donut target=_blank rel=noopener>donut</a>technique</li><li>AMSI Bypass</li><li>Pass-the-hash support</li><li>Kerberos auth support</li><li>SSL and<a class=link href=https://www.kitploit.com/search/label/Certificates title=certificates target=_blank rel=noopener>certificates</a>support</li><li>Upload and download files</li><li>List remote machine services without privileges</li><li>Command History</li><li>WinRM command completion</li><li>Local files completion</li><li>Colorization on output messages (can be disabled optionally)</li></ul><p><strong>Help</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Usage: evil-winrm -i IP -u USER [-s SCRIPTS_PATH] [-e EXES_PATH] [-P PORT] [-p PASS] [-H HASH] [-U URL] [-S] [-c PUBLIC_KEY_PATH ] [-k PRIVATE_KEY_PATH ] [-r REALM]  
</span></span><span class=line><span class=cl>    -S, --ssl                        Enable ssl  
</span></span><span class=line><span class=cl>    -c, --pub-key PUBLIC_KEY_PATH    Local path to public key certificate  
</span></span><span class=line><span class=cl>    -k, --priv-key PRIVATE_KEY_PATH  Local path to private key certificate  
</span></span><span class=line><span class=cl>    -r, --realm DOMAIN               Kerberos auth, it has to be set also in /etc/krb5.conf file using this format -&gt; CONTOSO.COM = { kdc = fooserver.contoso.com }  
</span></span><span class=line><span class=cl>    -s, --scripts PS_SCRIPTS_PATH    Powershell scripts local path  
</span></span><span class=line><span class=cl>    -e, --executables EXES_PATH      C# executables local path  
</span></span><span class=line><span class=cl>    -i, --ip IP                      Remote host IP or hostname (required)  
</span></span><span class=line><span class=cl>    -U, --url URL                    Remote url endpoint (default wsman)  
</span></span><span class=line><span class=cl>    -u, --user USER                  Username    (required if not using kerberos)  
</span></span><span class=line><span class=cl>    -p, --password PASS              Password  
</span></span><span class=line><span class=cl>    -H, --hash NTHash                NTHash   
</span></span><span class=line><span class=cl>    -P, --port PORT                  Remote host port (default 5985)  
</span></span><span class=line><span class=cl>    -V, --version                    Show version  
</span></span><span class=line><span class=cl>    -h, --help                       Display this help message
</span></span></code></pre></td></tr></table></div></div><p><strong>Requirements</strong><br>Ruby 2.3 or higher is needed. Some ruby gems are needed as well:<code>winrm >=2.3.2</code>,<code>winrm-fs >=1.3.2</code>,<code>stringio >=0.0.2</code>and<code>colorize >=0.8.1</code>. Depending of your installation method (3 availables) the installation of them could be required to be done manually.</p><p><strong>Installation & Quick Start (3 methods)</strong></p><p><strong>Method 1. Installation directly as ruby gem (dependencies will be installed automatically on your system)</strong></p><ul><li>Step 1. Install it (it will install automatically dependencies):<code>gem install evil-winrm</code></li><li>Step 2. Ready. Just launch it!<code>~$ evil-winrm -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'</code></li></ul><p><strong>Method 2. Git clone and install dependencies on your system manually</strong></p><ul><li>Step 1. Install dependencies manually:<code>~$ sudo gem install winrm winrm-fs colorize stringio</code></li><li>Step 2. Clone the repo:<code>git clone https://github.com/Hackplayers/evil-winrm.git</code></li><li>Step 3. Ready. Just launch it!<code>~$ cd evil-winrm && ruby evil-winrm.rb -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'</code></li></ul><p><strong>Method 3. Using bundler (dependencies will not be installed on your system, just to use evil-winrm)</strong></p><ul><li>Step 1. Install bundler:<code>gem install bundler:2.0.2</code></li><li>Step 2. Install dependencies with bundler:<code>cd evil-winrm && bundle install --path vendor/bundle</code></li><li>Step 3. Launch it with bundler:<code>bundle exec evil-winrm.rb -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'</code></li></ul><p><strong>Documentation</strong></p><p><strong>Clear text password</strong><br>If you don&rsquo;t want to put the password in clear text, you can optionally avoid to set<code>-p</code>argument and the password will be prompted preventing to be shown.</p><p><strong>Ipv6</strong><br>To use IPv6, the address must be added to /etc/hosts. Just put the already set name of the host after<code>-i</code>argument instead of an IP address.</p><p><strong>Basic commands</strong></p><ul><li><strong>upload</strong>: local files can be auto-completed using tab key.<ul><li>usage:<code>upload local_filename</code>or<code>upload local_filename destination_filename</code></li></ul></li><li><strong>download</strong>:<ul><li>usage:<code>download remote_filename</code>or<code>download remote_filename destination_filename</code></li></ul></li></ul><p><strong>Note about paths (upload/download)</strong>: Relative paths are not allowed to use on download/upload. Use filenames on current directory or absolute path.</p><ul><li><strong>services</strong>: list all services. No administrator permissions needed.</li><li><strong>menu</strong>: load the<code>Invoke-Binary</code>,<code>l04d3r-LoadDll</code>,<code>Donut-Loader</code>and<code>Bypass-4MSI</code>functions that we will explain below. When a ps1 is loaded all its functions will be shown up.</li></ul><p><a class=link href=https://1.bp.blogspot.com/-mvCcAQqENOU/Xcysb-FrRXI/AAAAAAAAQ0c/aZK7Ff1wQbsnFIOKT9tw9E6m2oK13YWPgCNcBGAsYHQ/s1600/evil-winrm_6_image2.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-mvCcAQqENOU/Xcysb-FrRXI/AAAAAAAAQ0c/aZK7Ff1wQbsnFIOKT9tw9E6m2oK13YWPgCNcBGAsYHQ/s1600/evil-winrm_6_image2.png loading=lazy></a></p><p><strong>Load powershell scripts</strong></p><ul><li>To load a ps1 file you just have to type the name (auto-completion usnig tab allowed). The scripts must be in the path set at<code>-s</code>argument. Type menu again and see the loaded functions. Very large files can take a long time to be loaded.</li></ul><p><a class=link href=https://1.bp.blogspot.com/-lOei4akLniQ/Xcysg1iMPgI/AAAAAAAAQ0g/2d03z7dvVYAw4DGMhqY4c5Q3HjKOhXuxQCNcBGAsYHQ/s1600/evil-winrm_7_image7.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-lOei4akLniQ/Xcysg1iMPgI/AAAAAAAAQ0g/2d03z7dvVYAw4DGMhqY4c5Q3HjKOhXuxQCNcBGAsYHQ/s1600/evil-winrm_7_image7.png loading=lazy></a></p><p><strong>Advanced commands</strong></p><ul><li>Invoke-Binary: allows exes compiled from c# to be executed in memory. The name can be auto-completed using tab key and allows up to 3 parameters. The executables must be in the path set at<code>-e</code>argument.</li></ul><p><a class=link href=https://1.bp.blogspot.com/-EnFbb_lbgBI/XcyslxAjcEI/AAAAAAAAQ0o/DGX2KZoEE0YJFH_F6ytGpuz6BzT7vZ-VgCNcBGAsYHQ/s1600/evil-winrm_8_image3.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-EnFbb_lbgBI/XcyslxAjcEI/AAAAAAAAQ0o/DGX2KZoEE0YJFH_F6ytGpuz6BzT7vZ-VgCNcBGAsYHQ/s640/evil-winrm_8_image3.png loading=lazy></a></p><ul><li>l04d3r-LoadDll: allows loading dll libraries in memory, it is equivalent to:<code>[Reflection.Assembly]::Load([IO.File]::ReadAllBytes("pwn.dll"))</code><br>The dll file can be hosted by smb, http or locally. Once it is loaded type<code>menu</code>, then it is possible to autocomplete all functions.</li></ul><p><a class=link href=https://1.bp.blogspot.com/-g4Xfvs782Ug/XcysuxEnvdI/AAAAAAAAQ0w/j8OWj01kTwoBFEhRI2kgnBIYQClrRXzLwCNcBGAsYHQ/s1600/evil-winrm_9_image4.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-g4Xfvs782Ug/XcysuxEnvdI/AAAAAAAAQ0w/j8OWj01kTwoBFEhRI2kgnBIYQClrRXzLwCNcBGAsYHQ/s640/evil-winrm_9_image4.png loading=lazy></a></p><p><a class=link href=https://1.bp.blogspot.com/-tA0t6hyyEWI/Xcysu_N3sVI/AAAAAAAAQ0s/9AcyAGcUdTQlNbyp3leS2s7-If7U_1uVgCNcBGAsYHQ/s1600/evil-winrm_10_image5.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-tA0t6hyyEWI/Xcysu_N3sVI/AAAAAAAAQ0s/9AcyAGcUdTQlNbyp3leS2s7-If7U_1uVgCNcBGAsYHQ/s640/evil-winrm_10_image5.png loading=lazy></a></p><ul><li>¬†Donut-Loader: allows to inject x64 payloads generated with awesome<a class=link href=https://github.com/TheWover/donut title=donut target=_blank rel=noopener>donut</a>technique. No need to encode the payload.bin, just generate and inject!</li></ul><p><a class=link href=https://1.bp.blogspot.com/-YRlN9w-hM1U/Xcys4sFBAgI/AAAAAAAAQ08/eGjfCcI9wFI1Vt3aztKgcbefwkrD5SvlwCNcBGAsYHQ/s1600/evil-winrm_11_image8.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-YRlN9w-hM1U/Xcys4sFBAgI/AAAAAAAAQ08/eGjfCcI9wFI1Vt3aztKgcbefwkrD5SvlwCNcBGAsYHQ/s640/evil-winrm_11_image8.png loading=lazy></a></p><ul><li>You can use this<a class=link href=https://github.com/Hackplayers/Salsa-tools/blob/master/Donut-Maker/donut-maker.py title=donut-maker target=_blank rel=noopener>donut-maker</a>to generate the payload.bin if you don&rsquo;t use Windows. This script use a python module written by Marcello Salvati (<a class=link href=https://twitter.com/byt3bl33d3r title=byt3bl33d3r target=_blank rel=noopener>byt3bl33d3r</a>). It could be installed using pip:</li><li><code>pip3 install donut-shellcode</code></li></ul><p><a class=link href=https://1.bp.blogspot.com/-yKF7hBN5eZA/Xcys9hhynDI/AAAAAAAAQ1A/1A0j3du1gRM2TEiB03atpjDf1gAapc0KwCNcBGAsYHQ/s1600/evil-winrm_12_image10.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-yKF7hBN5eZA/Xcys9hhynDI/AAAAAAAAQ1A/1A0j3du1gRM2TEiB03atpjDf1gAapc0KwCNcBGAsYHQ/s1600/evil-winrm_12_image10.png loading=lazy></a></p><ul><li>Bypass-4MSI: patchs AMSI protection.</li></ul><p><a class=link href=https://1.bp.blogspot.com/-oEUlAFKAwrU/XcytC9vi3rI/AAAAAAAAQ1I/-e25XXB2rtg1U0LZRP11zJyMB1aFXjDAgCNcBGAsYHQ/s1600/evil-winrm_13_image11.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-oEUlAFKAwrU/XcytC9vi3rI/AAAAAAAAQ1I/-e25XXB2rtg1U0LZRP11zJyMB1aFXjDAgCNcBGAsYHQ/s640/evil-winrm_13_image11.png loading=lazy></a></p><p><strong>Kerberos</strong></p><ul><li>First you have to sync date with the DC:<code>rdate -n</code></li><li>To generate ticket there are many ways:<ul><li>Using<a class=link href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/ticketer.py title=ticketer.py target=_blank rel=noopener>ticketer.py</a>from impacket:<br><code>ticketer.py -dc-ip -nthash -domain-sid -domain</code></li><li>If you get a kirbi ticket using<a class=link href=https://github.com/GhostPack/Rubeus title=Rubeus target=_blank rel=noopener>Rubeus</a>or<a class=link href=https://github.com/gentilkiwi/mimikatz title=Mimikatz target=_blank rel=noopener>Mimikatz</a>you have to convert to ccache using<a class=link href=https://github.com/Zer1t0/ticket_converter title=ticket_converter.py target=_blank rel=noopener>ticket_converter.py</a>:<br><code>python ticket_converter.py ticket.kirbi ticket.ccache</code></li></ul></li><li>Add ccache ticket. There are 2 ways:<br><code>export KRB5CCNAME=/foo/var/ticket.ccache</code><br><code>cp ticket.ccache /tmp/krb5cc_0</code></li><li>Add realm to<code>/etc/krb5.conf</code>(for linux). Use of this format is important:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> CONTOSO.COM = {  
</span></span><span class=line><span class=cl>             kdc = fooserver.contoso.con  
</span></span><span class=line><span class=cl> }
</span></span></code></pre></td></tr></table></div></div></li><li>Check Kerberos tickets with<code>klist</code></li><li>To remove ticket use:<code>kdestroy</code></li><li>For more information about Kerberos check this<a class=link href=https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a title=cheatsheet target=_blank rel=noopener>cheatsheet</a></li></ul><p><strong>Extra features</strong></p><ul><li>To disable colors just modify on code this variable<code>$colors_enabled</code>. Set it to false:<code>$colors_enabled = false</code></li></ul><p><strong>Credits:</strong><br>Main author:</p><ul><li><a class=link href=https://github.com/cybervaca title=cybervaca target=_blank rel=noopener>cybervaca</a></li></ul><p>Collaborators, developers, documenters, testers and supporters:</p><ul><li><a class=link href=https://github.com/OscarAkaElvis title=OscarAkaElvis target=_blank rel=noopener>OscarAkaElvis</a></li><li><a class=link href=https://github.com/jarilaos title=jarilaos target=_blank rel=noopener>jarilaos</a></li><li><a class=link href=https://github.com/vmotos title=vis0r target=_blank rel=noopener>vis0r</a></li></ul><p>Hat tip to:</p><ul><li><a class=link href=https://github.com/Alamot title=Alamot target=_blank rel=noopener>Alamot</a>for his original code.</li><li><a class=link href=https://github.com/3v4Si0N title=3v4Si0N target=_blank rel=noopener>3v4Si0N</a>for his awesome dll loader.</li><li><a class=link href=https://github.com/WinRb/WinRM/graphs/contributors title=WinRb target=_blank rel=noopener>WinRb</a>All contributors of ruby library.</li><li><a class=link href=https://github.com/TheWover title=TheWover target=_blank rel=noopener>TheWover</a>for his awesome donut tool.</li><li><a class=link href=https://twitter.com/byt3bl33d3r title=byt3bl33d3r target=_blank rel=noopener>byt3bl33d3r</a>for his python library to create donut payloads.</li><li><a class=link href=https://github.com/Sh11td0wn title=Sh11td0wn target=_blank rel=noopener>Sh11td0wn</a>for inspiration about new features.</li></ul><p><strong><a class=link href=http://hopigrarn.com/3lqq title="Download Evil-Winrm" target=_blank rel=noopener>Download Evil-Winrm</a></strong></p><p><strong>Regards</strong></p><p><strong>Kang Asu</strong></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>