<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="About discover: discover is a custom bash scripts used to automate various penetration testing tasks including recon, scanning, parsing, and creating malicious payloads and listeners with Metasploit Framework. For use with Kali Linux, Parrot Security OS and the Penetration Testers Framework (PTF).
About authors:
Lee Baird: @discoverscripts Jay &amp;ldquo;L1ghtn1ng&amp;rdquo; Townsend: @jay_townsend1 Jason Ashton: @ninewires discover Installation and Updating
About RECON in discover
Domain
RECON
`
Passive 2. Active 3. Import names into an existing recon-ng workspace 4."><title>discover: A Custom Bash Scripts Used To Perform Pentesting Tasks With Metasploit</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-discover-custom-bash-scripts-used-to/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="discover: A Custom Bash Scripts Used To Perform Pentesting Tasks With Metasploit"><meta property="og:description" content="About discover: discover is a custom bash scripts used to automate various penetration testing tasks including recon, scanning, parsing, and creating malicious payloads and listeners with Metasploit Framework. For use with Kali Linux, Parrot Security OS and the Penetration Testers Framework (PTF).
About authors:
Lee Baird: @discoverscripts Jay &amp;ldquo;L1ghtn1ng&amp;rdquo; Townsend: @jay_townsend1 Jason Ashton: @ninewires discover Installation and Updating
About RECON in discover
Domain
RECON
`
Passive 2. Active 3. Import names into an existing recon-ng workspace 4."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-discover-custom-bash-scripts-used-to/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-09-26T10:28:00+01:00"><meta property="article:modified_time" content="2019-09-26T10:28:00+01:00"><meta name=twitter:title content="discover: A Custom Bash Scripts Used To Perform Pentesting Tasks With Metasploit"><meta name=twitter:description content="About discover: discover is a custom bash scripts used to automate various penetration testing tasks including recon, scanning, parsing, and creating malicious payloads and listeners with Metasploit Framework. For use with Kali Linux, Parrot Security OS and the Penetration Testers Framework (PTF).
About authors:
Lee Baird: @discoverscripts Jay &amp;ldquo;L1ghtn1ng&amp;rdquo; Townsend: @jay_townsend1 Jason Ashton: @ninewires discover Installation and Updating
About RECON in discover
Domain
RECON
`
Passive 2. Active 3. Import names into an existing recon-ng workspace 4."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍇</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-discover-custom-bash-scripts-used-to/>discover: A Custom Bash Scripts Used To Perform Pentesting Tasks With Metasploit</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Sep 26, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><p><a class=link href=https://1.bp.blogspot.com/-hjLsH1N-tQw/XYx6N_8rghI/AAAAAAAAOyw/QiOkTHMxAEE7HREJ-_k2aqRTwdhkrUrvQCLcBGAsYHQ/s1600/Discover.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-hjLsH1N-tQw/XYx6N_8rghI/AAAAAAAAOyw/QiOkTHMxAEE7HREJ-_k2aqRTwdhkrUrvQCLcBGAsYHQ/s1600/Discover.png loading=lazy></a></p><p><strong>About discover:</strong> discover is a custom bash scripts used to automate various penetration testing tasks including recon, scanning, parsing, and creating malicious payloads and listeners with <a class=link href=http://bit.ly/2JkoOl9 target=_blank rel=noopener>Metasploit Framework</a>. For use with Kali Linux, Parrot Security OS and the <a class=link href=http://bit.ly/2K3rsYS target=_blank rel=noopener>Penetration Testers Framework (PTF)</a>.</p><p><strong>About authors:</strong></p><ul><li>Lee Baird: <a class=link href=https://twitter.com/discoverscripts target=_blank rel=noopener>@discoverscripts</a></li><li>Jay &ldquo;L1ghtn1ng&rdquo; Townsend: <a class=link href=https://twitter.com/jay_townsend1 target=_blank rel=noopener>@jay_townsend1</a></li><li>Jason Ashton: <a class=link href=https://twitter.com/ninewires target=_blank rel=noopener>@ninewires</a></li></ul><p><strong>discover Installation and Updating</strong></p><p><strong>About RECON in discover</strong><br><strong><em>Domain</em></strong></p><p><code>RECON</code><br>`</p><ol><li>Passive<code> </code>2. Active<code> </code>3. Import names into an existing recon-ng workspace<code> </code>4. Previous menu`</li></ol><p>   Passive uses ARIN, dnsrecon, goofile, goog-mail, goohost, theHarvester, <a class=link href=http://bit.ly/2JkoOl9 target=_blank rel=noopener>Metasploit Framework</a>, URLCrazy, Whois, multiple websites, and recon-ng.</p><p>   Active uses dnsrecon, WAF00W, traceroute, <a class=link href=http://bit.ly/2H8IvZK target=_blank rel=noopener>Whatweb</a>, and recon-ng.<br>   <em>[*]</em> Acquire API keys for Bing, Builtwith, Fullcontact, GitHub, Google, Hashes, Hunter, SecurityTrails, and Shodan for maximum results with recon-ng and theHarvester.</p><p><code>API key locations:</code><br><code>recon-ng</code><br><code>   show keys</code><br><code>   keys add bing_api</code><br><code>theHarvester</code><br><code>   /opt/theHarvester/api-keys.yaml</code></p><p>   <strong><em>Person:</em></strong> Combines info from multiple websites.</p><p><code>RECON</code><br><code>First name:</code><br><code>Last name:</code><br><strong>_   Parse salesforce:_</strong> Gather names and positions into a clean list.</p><p><code>Create a free account at salesforce (https://connect.data.com/login).</code><br><code>Perform a search on your target company > select the company name > see all.</code><br><code>Copy the results into a new file.</code><br><code>Enter the location of your list:</code></p><p><strong>About SCANNING in discover</strong><br><em><strong>Generate target list:</strong></em> Use different tools to create a target list including Angry IP Scanner, arp-scan, netdiscover and nmap pingsweep.</p><p><code>SCANNING</code><br><code>1. Local area network</code><br><code>2. NetBIOS</code><br><code>3. netdiscover</code><br><code>4. Ping sweep</code><br><code>5. Previous menu</code></p><p><em>**   CIDR, List, IP, Range, or URL**</em></p><p><code>Type of scan:</code><br>`</p><ol><li>External<code> </code>2. Internal<code> </code>3. Previous menu`</li></ol><ul><li>External scan will set the nmap source port to 53 and the max-rrt-timeout to 1500ms.</li><li>Internal scan will set the nmap source port to 88 and the max-rrt-timeout to 500ms.</li><li>Nmap is used to perform host discovery, port scanning, service enumeration and OS identification.</li><li>Matching nmap scripts are used for additional enumeration.</li><li>Addition tools: enum4linux, smbclient, and ike-scan.</li><li>Matching Metasploit auxiliary modules are also leveraged.</li></ul><p><strong>About WEB in discover</strong><br>   <strong><em>Insecure direct object reference</em></strong></p><p><code>Using Burp, authenticate to a site, map & Spider, then log out. Target > Site map > select the URL > right click > Copy URLs in this host.</code><br>`Paste the results into a new file.</p><p><code></code>Enter the location of your file:`</p><p>   <strong>Open multiple tabs in Firefox</strong></p><p><code>Open multiple tabs in Firefox with:</code><br>`</p><ol><li>List<code> </code>2. Directories from robots.txt.<code> </code>3. Previous menu`</li></ol><ul><li>Use a list containing IPs and/or URLs.</li><li>Use wget to pull a domain&rsquo;s robot.txt file, then open all of the directories.</li></ul><p><strong><em>Nikto</em></strong></p><p><code>Run multiple instances of Nikto in parallel.</code><br><code>1. List of IPs.</code><br><code>2. List of IP:port.</code><br><code>3. Previous menu</code><br>**_   SSL: _**Use sslscan and sslyze to check for SSL/TLS certificate issues.</p><p><code>Check for SSL certificate issues.</code><br><code>Enter the location of your list:</code></p><p><strong>About MISC in discover</strong><br>   <strong><em>Parse XML</em></strong></p><p><code>Parse XML to CSV.</code><br>`</p><ol><li>Burp (Base64)<code> </code>2. Nessus (.nessus)<code> </code>3. Nexpose (XML 2.0)<code> </code>4. Nmap<code> </code>5. Qualys<code> </code>6. revious menu`</li></ol><p>   <strong><em>Generate a malicious payload</em></strong></p><p><code>Malicious Payloads</code><br><code>1. android/meterpreter/reverse_tcp</code><br><code>2. cmd/windows/reverse_powershell</code><br><code>3. java/jsp_shell_reverse_tcp (Linux)</code><br><code>4. java/jsp_shell_reverse_tcp (Windows)</code><br><code>5. linux/x64/meterpreter_reverse_https</code><br><code>6. linux/x64/meterpreter_reverse_tcp</code><br><code>7. linux/x64/shell/reverse_tcp</code><br><code>8. osx/x64/meterpreter_reverse_https</code><br><code>9. osx/x64/meterpreter_reverse_tcp</code><br><code>10. php/meterpreter/reverse_tcp</code><br><code>11. python/meterpreter_reverse_https 12. python/meterpreter_reverse_tcp</code><br><code>13. windows/x64/meterpreter_reverse_https</code><br><code>14. windows/x64/meterpreter_reverse_tcp</code><br><code>15. Previous menu</code></p><p>   <strong><em>Start a Metasploit listener</em></strong></p><p><code>Metasploit Listeners</code><br><code>1. android/meterpreter/reverse_tcp</code><br><code>2. cmd/windows/reverse_powershell</code><br><code>3. java/jsp_shell_reverse_tcp</code><br><code>4. linux/x64/meterpreter_reverse_https</code><br><code>5. linux/x64/meterpreter_reverse_tcp</code><br><code>6. linux/x64/shell/reverse_tcp</code><br><code>7. osx/x64/meterpreter_reverse_https</code><br><code>8. osx/x64/meterpreter_reverse_tcp</code><br><code>9. php/meterpreter/reverse_tcp</code><br><code>10. python/meterpreter_reverse_https</code><br><code>11. python/meterpreter_reverse_tcp</code><br><code>12. windows/x64/meterpreter_reverse_https</code><br><code>13. windows/x64/meterpreter_reverse_tcp</code><br><code>14. Previous menu</code></p><p><strong><a class=link href=https://github.com/leebaird/discover target=_blank rel=noopener>Download discover</a></strong></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>