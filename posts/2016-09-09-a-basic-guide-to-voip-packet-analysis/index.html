<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Wireshark is a packet analysis tool used for analysing services, protocols , data transmission. It is an open source software available freely online.Wireshark is¬†cross platform which uses pcap to capture packets. It is majorly a GUI based tool which is implemented with the help Qt widget toolkit ( Used for creating GUI¬†as well as cross-platform applications that run on various software and hardware platforms such as Linux, Windows, macOS, Android or embedded systems )."><title>A Basic Guide to VOIP Packet analysis through Wireshark</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-a-basic-guide-to-voip-packet-analysis/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="A Basic Guide to VOIP Packet analysis through Wireshark"><meta property="og:description" content="Wireshark is a packet analysis tool used for analysing services, protocols , data transmission. It is an open source software available freely online.Wireshark is¬†cross platform which uses pcap to capture packets. It is majorly a GUI based tool which is implemented with the help Qt widget toolkit ( Used for creating GUI¬†as well as cross-platform applications that run on various software and hardware platforms such as Linux, Windows, macOS, Android or embedded systems )."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-a-basic-guide-to-voip-packet-analysis/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-11-08T15:58:00+01:00"><meta property="article:modified_time" content="2019-11-08T15:58:00+01:00"><meta name=twitter:title content="A Basic Guide to VOIP Packet analysis through Wireshark"><meta name=twitter:description content="Wireshark is a packet analysis tool used for analysing services, protocols , data transmission. It is an open source software available freely online.Wireshark is¬†cross platform which uses pcap to capture packets. It is majorly a GUI based tool which is implemented with the help Qt widget toolkit ( Used for creating GUI¬†as well as cross-platform applications that run on various software and hardware platforms such as Linux, Windows, macOS, Android or embedded systems )."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-a-basic-guide-to-voip-packet-analysis/>A Basic Guide to VOIP Packet analysis through Wireshark</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 08, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><p><a class=link href=https://1.bp.blogspot.com/-SG0ohpWu_FM/XcWCbrUJqPI/AAAAAAAAD6g/i3HjZQpRxgIN0QpeVxgbpkwtLcb8VqpOgCLcBGAsYHQ/s1600/wireshark.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-SG0ohpWu_FM/XcWCbrUJqPI/AAAAAAAAD6g/i3HjZQpRxgIN0QpeVxgbpkwtLcb8VqpOgCLcBGAsYHQ/s640/wireshark.png loading=lazy></a></p><p>Wireshark is a packet analysis tool used for analysing services, protocols , data transmission. It is an open source software available freely online.Wireshark is¬† cross platform which uses pcap to capture packets. It is majorly a GUI based tool which is implemented with the help Qt widget toolkit ( Used for creating GUI¬† as well as cross-platform applications that run on various software and hardware platforms such as Linux, Windows, macOS, Android or embedded systems ).There is also a terminal-based (non-GUI) version called TShark.</p><p>One can download Wireshark from its official website. i.e. <a class=link href=https://www.wireshark.org/download.html target=_blank rel=noopener>https://www.wireshark.org/download.html</a></p><p>Wireshark makes it very easy to analyse packet with the help of filters in order to work efficiently.</p><p>It Stands for &ldquo;Voice Over Internet Protocol,&rdquo; and is often pronounced &ldquo;voip.&rdquo; VoIP is basically a telephone connection over the Internet. The data is sent¬†digitally, using the Internet Protocol (IP) instead of analog telephone lines.¬†Switching to VoIP might also help you save money on communications services. Long-distance and international calls are generally free with VoIP service. The only charge is for your internet access. This is also one of the major reason corporates are shifting to VOIP services very fast.</p><p><strong>How VOIP data packets are transmitted ?</strong></p><p>Voice over Internet Protocol, is a method for taking analog audio signals, like the kind you hear when you talk on the phone, and turning them into digital data that can be transmitted over the Internet.For the transmission of VOIP Packets they use several protocols which are SIP, RTP .</p><p>SIP : Session Initiation protocol is a protocol which setup an IP communication session.Its is done with the help of 3-way handshake which includes following steps :¬†</p><ul><li>The caller sends an INVITE</li><li>The callee sends an 200 OK to accept the call</li><li>The caller sends an ACK to indicate that the handshake is done and a call is going to be setup.</li></ul><p><img src=https://www.voipmechanic.com/images/sip_pics/sip_call_basic.gif loading=lazy alt="Image result for sip handshake"></p><p>When SIP executes and is implemented it mainly requires a SIP Account/Services which can be availed online, second it requires SIP Client which can be a soft-phone or software which provides connection through SIP services.</p><p>After the establishment done between the clients comes up another protocol i.e. RTP (Real-time Transport Protocol) which is responsible in exchanging data packets.¬†</p><p>You can think of SIP as a stage manager. SIP prepares the stage for RTP by setting up its connection. Once RTP is finished with its stage (call), then SIP comes back to the stage to clean up after it.¬†</p><p>Now let&rsquo;s start the Wireshark and start capturing packets.¬†Here the VOIP application used is Zoiper whose packets we will be going to capture including the connection establishment , data transmission and connection termination.</p><p><strong>Step 1</strong> : Open Wireshark and select the interface whose packets you want to capture.Here I am going to select Local Area connection.</p><p><a class=link href=https://1.bp.blogspot.com/-B1b92qNvHok/XZS3FQxq45I/AAAAAAAAASA/JX8RPB5Tg_E1q79vwldhNWAFlbBsLvtnACLcBGAsYHQ/s1600/w1.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-B1b92qNvHok/XZS3FQxq45I/AAAAAAAAASA/JX8RPB5Tg_E1q79vwldhNWAFlbBsLvtnACLcBGAsYHQ/s640/w1.png loading=lazy></a></p><p>You will observe hundreds of packets getting captured.</p><p><strong>Step 2:</strong> Now we will open a VOIP application whose packets we need to capture.( In my case it is Zoiper5 ) .It might seem tough to analyse specific packets as it is going with the collection of many protools so we use filters in which we go for majorly to filters i.e. RTP and SIP .</p><p><a class=link href=https://1.bp.blogspot.com/-n7G_zD1-E6U/XZS5lPdc3vI/AAAAAAAAASY/ctTdjX0JkFwRd6LsAkvoZT40GC2sY1G2gCLcBGAsYHQ/s1600/w2.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-n7G_zD1-E6U/XZS5lPdc3vI/AAAAAAAAASY/ctTdjX0JkFwRd6LsAkvoZT40GC2sY1G2gCLcBGAsYHQ/s640/w2.png loading=lazy></a></p><p>¬†<strong>Step 3</strong>: After applying the SIP filter, in the Info column you will see handshake for connection establishment with the services is being made. Let&rsquo;s make a call and start capturing packets.</p><p><a class=link href=https://1.bp.blogspot.com/-BIy0WB-I7Ak/XZS7JKfns2I/AAAAAAAAASk/RbHAHKKv29kCxFhzVd1CQLtNHnvDS1OPQCLcBGAsYHQ/s1600/w3.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-BIy0WB-I7Ak/XZS7JKfns2I/AAAAAAAAASk/RbHAHKKv29kCxFhzVd1CQLtNHnvDS1OPQCLcBGAsYHQ/s640/w3.png loading=lazy></a></p><p>In this image notice in the Info. columns the SIP handshake and you will notice a proper connection was established and ended up with Bye with some status codes.This hows up the work of SIP very well which was of connection establishment now lets move on to check for the data packets transferred in between.</p><p><strong>Step 4:</strong> Change the filter from sip to RTP¬† and you will notice a lot of packets listed in the analysis frame. You will see a whole lot of packets transmitted in the data stream.</p><p><a class=link href=https://1.bp.blogspot.com/-ZWlm_MTAiT8/XZS82HJrWqI/AAAAAAAAASw/B_vQ5dySnDINCrCCtpKhj8pHlOzT8KpRgCLcBGAsYHQ/s1600/w4.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-ZWlm_MTAiT8/XZS82HJrWqI/AAAAAAAAASw/B_vQ5dySnDINCrCCtpKhj8pHlOzT8KpRgCLcBGAsYHQ/s640/w4.png loading=lazy></a></p><p><strong>Step 5</strong>: Go to Telephone tab in the¬† title bar and click on VOIP .</p><p><a class=link href=https://1.bp.blogspot.com/-vCMeD78ny9Q/XZS9PW7eN5I/AAAAAAAAAS4/p5VqXCQZbdQGJbBmcEoiTsN9jHJmchygwCLcBGAsYHQ/s1600/w5.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-vCMeD78ny9Q/XZS9PW7eN5I/AAAAAAAAAS4/p5VqXCQZbdQGJbBmcEoiTsN9jHJmchygwCLcBGAsYHQ/s640/w5.png loading=lazy></a></p><p>You will land up to a new window where you can listen up to the entire conversation been made through VOIP.¬†</p><p><a class=link href=https://1.bp.blogspot.com/-OtNaF4odOf4/XZS-B7a7fXI/AAAAAAAAATE/iftFK5Dnrcg0CBDT8-Va1N99xBuBCFnhQCLcBGAsYHQ/s1600/w6.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-OtNaF4odOf4/XZS-B7a7fXI/AAAAAAAAATE/iftFK5Dnrcg0CBDT8-Va1N99xBuBCFnhQCLcBGAsYHQ/s640/w6.png loading=lazy></a></p><p><strong>Step 6</strong> : Click on Play Stream and it will open up a RTP player in which two colour codes are used the blue and black one the blue coloured column is the one in which data was transferred from system itself and the black one is which has been received from the VOIP user whom you have called.<br>NOTE : You can go for the better understanding of colour encoding by going to <strong>View Tab -> Coloring Rules.</strong></p><p><a class=link href=https://1.bp.blogspot.com/-OgedxQaXc6Q/XZS_R9cEjGI/AAAAAAAAATQ/ld-Y2dSb2BcyT8002XXtQMHTYfPaZ-qxgCLcBGAsYHQ/s1600/W8.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-OgedxQaXc6Q/XZS_R9cEjGI/AAAAAAAAATQ/ld-Y2dSb2BcyT8002XXtQMHTYfPaZ-qxgCLcBGAsYHQ/s640/W8.png loading=lazy></a></p><p>Select any one whose side you want to listen and go for sniffing the VOIP packets.</p><p>You can work on such packets and download some for practice purpose from here :<br><a class=link href=https://wiki.wireshark.org/SampleCaptures#Sample_Captures target=_blank rel=noopener>https://wiki.wireshark.org/SampleCaptures#Sample_Captures</a></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>