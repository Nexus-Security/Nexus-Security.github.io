<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I wanted to take a minute to write about some critical red team theory. Hopefully you can think back to these theories if you get stuck in a difficult engagement. In this post I&amp;rsquo;m going to cover the principle of economy, the principle of access, and the principle of humanity. These are concepts I often cover with new red teamers so I wanted to blog these principals to get more community feedback and record the advice."><title>3 Principles of Red Teaming</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-3-principles-of-red-teaming/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="3 Principles of Red Teaming"><meta property="og:description" content="I wanted to take a minute to write about some critical red team theory. Hopefully you can think back to these theories if you get stuck in a difficult engagement. In this post I&amp;rsquo;m going to cover the principle of economy, the principle of access, and the principle of humanity. These are concepts I often cover with new red teamers so I wanted to blog these principals to get more community feedback and record the advice."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-3-principles-of-red-teaming/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2020-01-07T06:38:00+01:00"><meta property="article:modified_time" content="2020-01-07T06:38:00+01:00"><meta name=twitter:title content="3 Principles of Red Teaming"><meta name=twitter:description content="I wanted to take a minute to write about some critical red team theory. Hopefully you can think back to these theories if you get stuck in a difficult engagement. In this post I&amp;rsquo;m going to cover the principle of economy, the principle of access, and the principle of humanity. These are concepts I often cover with new red teamers so I wanted to blog these principals to get more community feedback and record the advice."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üçá</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-3-principles-of-red-teaming/>3 Principles of Red Teaming</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jan 07, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p><a class=link href=https://1.bp.blogspot.com/-JqvPehlkVK4/XhJkBstjDXI/AAAAAAAALIs/ELOgzBo6IwYq4_6sOx69BIrdQ266i3kOACLcBGAsYHQ/s1600/red_team.jpg target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-JqvPehlkVK4/XhJkBstjDXI/AAAAAAAALIs/ELOgzBo6IwYq4_6sOx69BIrdQ266i3kOACLcBGAsYHQ/s640/red_team.jpg loading=lazy></a></p><p>I wanted to take a minute to write about some critical red team theory. Hopefully you can think back to these theories if you get stuck in a difficult engagement. In this post I&rsquo;m going to cover the principle of economy, the principle of access, and the principle of humanity. These are concepts I often cover with new red teamers so I wanted to blog these principals to get more community feedback and record the advice. I&rsquo;m also a big believer in learning theory to help guide one&rsquo;s practice. These offensive principles should help you plan your attack in many situations, with a few caveats I will add, and these can generally be applied to most scenarios where you need to gain access to a target&rsquo;s network or data. I think there are many principles to red teaming (drop your favorites in the comments) but these are three that have always served me well in the past.</p><p><strong><strong>Principle</strong> of Economy</strong><br>As we&rsquo;ve talked about <a class=link href=http://lockboxx.blogspot.com/2019/01/understanding-infosec-as-cost-center.html target=_blank rel=noopener>on this blog before</a>, security operations are a cost center. That means, you shouldn&rsquo;t be paying more for security than the thing you are trying to protect. From a red team perspective, this means the target has a limited budget or amount of resources they are willing to devote to protecting the asset. Further, they normally will have to continue business operations during the incident as this is their primary means of operation. This can help you gauge what their response to an incident may be, when it will become an intolerable issue for them, and how much money they may allocate to solve the issue. While it&rsquo;s also easier now to boot strap a CNA program using open source tools, it&rsquo;s also much easier to get caught using modern intrusion detection solutions. This means the red team should invest equally in their CNA program as the defense has invested in their CND program, otherwise their tools may be easily exploited. Organizations that make little to no effort on either the offensive or defensive side are in a default vulnerable state and can easily be taken advantage of by organizations that make the minimum investment to protect their assets. This means organizations that have no security program can easily be compromised by the bare minimum investment with open source tooling, where as an organization that has made the some investments in CND could counter that same CNA program using the bare minimum for tools. The hidden constraint in the budgets here is actually operator skill, and this will have a massive impact on the outcome of an operation. Talent can stretch a budget incredibly far or waste it on the wrong investments based on their expertise and ability to innovate. The principle of economy is an important one because it helps dictate what resources an organization has to play with, which can help you understand the investment it may take to breach the target organization.</p><p><strong>Principle of Access</strong><br>There is always a system with legitimate access to the target and a means to use it so long as the data is valuable to the organization. That means there is a legitimate path to the data if it is being used, which means the attacker can find and abuse that path. One should assume access to the data exists in some way if the data is being used. This is why it&rsquo;s so important to understand <a class=link href="https://www.youtube.com/watch?v=yhuXbkY3s0E" target=_blank rel=noopener>network admin hunting techniques</a>, such as using tools like <a class=link href=https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon target=_blank rel=noopener>powerview</a> or <a class=link href=https://www.ernw.de/download/BloodHoundWorkshop/ERNW_DogWhispererHandbook.pdf target=_blank rel=noopener>bloodhound</a>. Often red teams will go for domain admin or administrator accounts of the IT network, however this is a means to the end and not their true objective. By first obtaining this level of access they can easily access whatever resource they are truly targeting. Gaining levels of access can be broad in the case of hunting domain admins or it can be targeted, but understanding how to access your resource is a critical red team skill. There is room to get creative with your access, for example you can leverage credential reuse and move laterally or you could wait for your target to authenticate to a bastion then steal their access token. Blue teams can also apply many restrictive tricks here, such as inbound and outbound access controls, to limit how people interact with data. Egress access controls for example can greatly hamper a red team from establishing command and control channels, aka an alternate access channel or a backdoor. Setting up bastion hosts is a good idea for gating access to more secure environments, i.e. forcing identity checks or re-authentication at multiple points. Similarly airgapped systems can force attackers to move from purely network based access to other means. Thinking about how you will access the target and exfiltrate the data is critical in red team planning.</p><p><strong><strong>Principle</strong> of Humanity</strong><br>This is one of the most abusable principles in red teaming. Computer systems are made for human use and humans make mistakes. The majority of computer systems are designed for humans to use in multipurpose ways and these versatile user systems are often the best place to target for an attacker. Find the people you know have the access, exploit the human element of their interactions with the systems (passwords, tools, applications, chat, network comms), and pivot through their access. Attackers have known this for a long time and thus have targeted the users or employees of an organization when they want access to corporate networks or corporate data; this is why spear phishing is such a popular technique for breaching corporations. This is why so many APT organizations rely on phishing, computers are multipurpose and users need to communicate as well as accomplish business functions. It&rsquo;s the path of least resistance when it&rsquo;s easier to trick a human than exploit a computer service for access to a system. It&rsquo;s also harder to detect when humans have been tricked vs when computers have been exploited. It is long said that users are the weak point in any security design and when red teaming I find abusing legitimate users the best way to access target systems. Many large security conscious organizations, such as Google and Apple, are beginning to separate their people from direct customer data access. Other places have implemented &ldquo;break glass&rdquo; solutions, such that an alarm is triggered when any human user escalates to these levels of access or permissions. There can be exceptions to these principles too, for example trying to exploit security conscious individuals may have the exact opposite of the desired effect and the target may sound alarms if they suspect a person of doing something nefarious. Targeting or choosing your mark is a big aspect of the principle of humanity. Targeting is a heavily studied topic in both <a class=link href=https://www.reputationdefender.com/blog/executives/corporate-social-engineering-what-makes-for-an-appealing-mark target=_blank rel=noopener>social engineering</a> and <a class=link href=https://blog.hootsuite.com/target-market/ target=_blank rel=noopener>marketing</a>, and could be several blog posts on its own.</p><p>I find these principles can help you gauge an organization and determine the best course for intrusion. It breaks down to how does an organization protect its target assets, how does the organization use its assets, and what are the human elements or exploitable points in that chain. Sometimes organizations have unreasonable resources, often if the asset they are protecting is human life or defense based. Try to remember these lessons if you&rsquo;re in a pinch, they may help you innovate your way into a high security environment. If you want to read more red team theory I highly suggest the book &ldquo;<a class=link href=http://lockboxx.blogspot.com/2019/01/book-review-network-attacks-and.html target=_blank rel=noopener>Network Attacks and Exploitation</a>&rdquo;. I hope these principles help you in your red teaming as I&rsquo;ve found them to be ubiquitously applicable but let me know your thoughts and feedback in the comments section! The following is a much more in-depth presentation on red team tradecraft and methodology by Jason Lang, but you may recognize the same principles above highlighted throughout his talk and his methodology.</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>