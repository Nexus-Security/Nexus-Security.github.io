<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kang Asu
Dsiem - Security Event Correlation Engine For ELK Stack
Dsiem is a security event correlation engine for ELK stack, allowing the platform to be used as a dedicated and full-featured SIEM system.
Dsiem provides OSSIM-style correlation for normalized logs/events, perform lookup/query to threat intelligence and vulnerability information sources, and produces risk-adjusted alarms.
Features
Runs in standalone or clustered mode with NATS as messaging bus between frontend and backend nodes."><title>Dsiem</title><link rel=canonical href=https://Nexus-Security.github.io/posts/2016-09-09-dsiem/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="Dsiem"><meta property="og:description" content="Kang Asu
Dsiem - Security Event Correlation Engine For ELK Stack
Dsiem is a security event correlation engine for ELK stack, allowing the platform to be used as a dedicated and full-featured SIEM system.
Dsiem provides OSSIM-style correlation for normalized logs/events, perform lookup/query to threat intelligence and vulnerability information sources, and produces risk-adjusted alarms.
Features
Runs in standalone or clustered mode with NATS as messaging bus between frontend and backend nodes."><meta property="og:url" content="https://Nexus-Security.github.io/posts/2016-09-09-dsiem/"><meta property="og:site_name" content="ZYChimne"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2019-12-18T11:45:00+01:00"><meta property="article:modified_time" content="2019-12-18T11:45:00+01:00"><meta name=twitter:title content="Dsiem"><meta name=twitter:description content="Kang Asu
Dsiem - Security Event Correlation Engine For ELK Stack
Dsiem is a security event correlation engine for ELK stack, allowing the platform to be used as a dedicated and full-featured SIEM system.
Dsiem provides OSSIM-style correlation for normalized logs/events, perform lookup/query to threat intelligence and vulnerability information sources, and produces risk-adjusted alarms.
Features
Runs in standalone or clustered mode with NATS as messaging bus between frontend and backend nodes."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8b78332b6420dc9affabe23720d11e63_1937019_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍇</span></figure><div class=site-meta><h1 class=site-name><a href=/>ZYChimne</a></h1><h2 class=site-description>Computer Science, Wuhan University</h2></div></header><ol class=social-menu><li><a href=https://github.com/ZYChimne target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/ZChimne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About Me</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2016-09-09-dsiem/>Dsiem</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Dec 18, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><p><strong>Kang Asu</strong></p><p><a class=link href=https://1.bp.blogspot.com/-oMPwndZDYcc/XfL3HkDxzVI/AAAAAAAARE0/ERzUSDLoFvUV6eUvZnS4OKaGQYZO8Fa0QCNcBGAsYHQ/s1600/dsiem_5_kbn-dashboard.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-oMPwndZDYcc/XfL3HkDxzVI/AAAAAAAARE0/ERzUSDLoFvUV6eUvZnS4OKaGQYZO8Fa0QCNcBGAsYHQ/s640/dsiem_5_kbn-dashboard.png loading=lazy></a></p><p><strong>Dsiem - Security Event Correlation Engine For ELK Stack</strong></p><p>Dsiem is a security event correlation engine for <a class=link href=https://www.elastic.co/elk-stack title="ELK stack" target=_blank rel=noopener>ELK stack</a>, allowing the platform to be used as a dedicated and full-featured <a class=link href=https://en.wikipedia.org/wiki/Security_information_and_event_management title=SIEM target=_blank rel=noopener>SIEM</a> system.<br>Dsiem provides <a class=link href=https://www.alienvault.com/products/ossim title=OSSIM target=_blank rel=noopener>OSSIM</a>-style correlation for normalized logs/events, perform lookup/query to <a class=link href=https://www.kitploit.com/search/label/Threat%20Intelligence title="threat intelligence" target=_blank rel=noopener>threat intelligence</a> and <a class=link href=https://www.kitploit.com/search/label/Vulnerability title=vulnerability target=_blank rel=noopener>vulnerability</a> information sources, and produces risk-adjusted alarms.</p><p><strong>Features</strong></p><ul><li>Runs in standalone or clustered mode with <a class=link href=https://nats.io/ title=NATS target=_blank rel=noopener>NATS</a> as messaging bus between frontend and backend nodes. Along with ELK, this made the entire SIEM platform horizontally scalable.</li><li>OSSIM-style correlation and directive rules, bridging easier transition from OSSIM.</li><li>Alarms enrichment with data from threat intel and vulnerability information sources. Builtin support for <a class=link href=https://github.com/aol/moloch/wiki/WISE title="Moloch Wise" target=_blank rel=noopener>Moloch Wise</a> (which supports Alienvault OTX and others) and Nessus CSV exports. Support for other sources can easily be implemented as <a class=link href=https://github.com/defenxor/dsiem/blob/master/docs/plugins.md#about-threat-intel-lookup-plugin title=plugins target=_blank rel=noopener>plugins</a>.</li><li>Instrumentation supported through Metricbeat and/or Elastic APM server. No need extra stack for this purpose.</li><li>Builtin rate and back-pressure control, set the minimum and maximum events/second (EPS) received from Logstash depending on your hardware capacity and acceptable delays in event processing.</li><li>Loosely coupled, designed to be composable with other infrastructure platform, and doesn&rsquo;t try to do everything. Loose coupling also means that it&rsquo;s possible to use Dsiem as an OSSIM-style correlation engine with non ELK stack if needed.</li><li>Batteries included:<ul><li>A directive conversion tool that reads OSSIM XML directive file and translate it to Dsiem JSON-style config.</li><li>A SIEM plugin creator tool that will read off an existing index pattern from Elasticsearch, and creates the necessary Logstash configuration to clone the relevant fields&rsquo; content to Dsiem. The tool can also generate basic directive required by Dsiem to correlate received events and generate alarm.</li><li>A helper tool to serve Nessus CSV files over the network to Dsiem.</li><li>A light weight Angular web UI just for basic alarms <a class=link href=https://www.kitploit.com/search/label/Management title=management target=_blank rel=noopener>management</a> (closing, tagging), and easy pivoting to the relevant indices in Kibana to perform the actual analysis.</li></ul></li><li>Obviously a cloud-native, twelve-factor app, and all that jazz.</li></ul><p><strong>How It Works</strong></p><p><a class=link href=https://1.bp.blogspot.com/-fselKoqmoLg/XfL3N1BgogI/AAAAAAAARE4/JGf9DAIq45cSYAmJO9AMUPrQvaFbWszFgCNcBGAsYHQ/s1600/dsiem_6_simple-arch.png target=_blank rel=noopener><img src=https://1.bp.blogspot.com/-fselKoqmoLg/XfL3N1BgogI/AAAAAAAARE4/JGf9DAIq45cSYAmJO9AMUPrQvaFbWszFgCNcBGAsYHQ/s640/dsiem_6_simple-arch.png loading=lazy></a></p><p>On the diagram above:</p><ol><li>Log sources send their logs to Syslog/Filebeat, which then sends them to Logstash with a unique identifying field. Logstash then parses the logs using different filters based on the log sources type, and sends the results to Elasticsearch, typically creating a single index pattern for each log type (e.g. <code>suricata-*</code> for logs received from Suricata IDS, <code>ssh-*</code> for SSH logs, etc.).</li><li>Dsiem uses a special purpose logstash config file to clone incoming event from log sources, right after logstash has done parsing it. Through the same config file, the new cloned event is used (independently from the original event) to collect Dsiem required fields like Title, Source IP, Destination IP, and so on.</li><li>The output of the above step is called <em>Normalized Event</em> because it represent logs from multiple different sources in a single format that has a set of common fields. Those events are then sent to Dsiem through Logstash HTTP output plugin, and to <a class=link href=https://www.kitploit.com/search/label/Elasticsearch title=Elasticsearch target=_blank rel=noopener>Elasticsearch</a> under index name pattern <code>siem_events-*</code>.</li><li>Dsiem correlates incoming normalized events based on the configured directive rules, perform threat intel and vulnerability lookups, and then generates an alarm if the rules conditions are met. The alarm is then written to a local log file, that is harvested by a local Filebeat configured to send its content to Logstash.</li><li>At the logstash end, there&rsquo;s another Dsiem <a class=link href=https://github.com/defenxor/dsiem/blob/master/deployments/docker/conf/logstash/conf.d/80_siem.conf title="special config file" target=_blank rel=noopener>special config file</a> that reads those submitted alarms and push them to the final SIEM alarm index in Elasticsearch.</li></ol><p>The final result of the above processes is that now we can watch for new alarms and updates to an existing one just by monitoring a single Elasticsearch index.</p><p><strong>Installation</strong><br>You can use Docker Compose or the release binaries to install Dsiem. Refer to the <a class=link href=https://github.com/defenxor/dsiem/blob/master/docs/installation.md title="Installation Guide" target=_blank rel=noopener>Installation Guide</a> for details.<br>Alternatively, there&rsquo;s also a Docker Compose or virtual machine-based <a class=link href=https://github.com/defenxor/dsiem/tree/master/demo title="demo environment" target=_blank rel=noopener>demo environment</a> that you can use to evaluate all Dsiem integration from one simple web interface.</p><p><strong>Documentation</strong><br>Currently available docs are located <a class=link href=https://github.com/defenxor/dsiem/blob/master/docs/ title=here target=_blank rel=noopener>here</a>.</p><p><strong><a class=link href=http://locinealy.com/4XNS title="Download Dsiem" target=_blank rel=noopener>Download Dsiem</a></strong></p><p><strong>Regards</strong></p><p><strong>Kang Asu</strong></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 ZYChimne</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>